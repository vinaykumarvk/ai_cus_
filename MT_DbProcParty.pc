/************************************************************************************
 *    COPYRIGHT NOTICE                                                              *
 *                                                                                  *
 *   Copyright 2005 Polaris Software Lab Limited. All rights reserved.              *
 *                                                                                  *
 *   These materials are confidential and proprietary to                            *
 *    Polaris Software Lab Limited and no part of these materials should            *
 *    be reproduced, published, transmitted or distributed in any form or           *
 *    by any means, electronic, mechanical, photocopying, recording or              *
 *    otherwise, or stored in any information storage or retrieval system           *
 *    of any nature nor should the materials be disclosed to third parties          *
 *    or used in any other manner for which this is not authorized, without         *
 *    the prior express written authorization of Polaris Software Lab Limited.      *
 */
/************************************************************************************
 *
 * Module Name         :        Master Maintenance
 *
 * File Name           :        MT_DbProcParty.pc
 *
 * Description         :        This file contains functions for master and
 *                              child tables' records insertion and updation
 *                              in all modes business validations check functions.
 *
 *
 *                      Version Control Block
 *
 * Date        Version     Author               Description
 * ---------   --------  ---------------  ---------------------------------------------
 * 10-10-2005   1.0       S Pradeep       New file to validate Master and child tables
 * 27-01-2006	 1.1		  S Pradeep			Added Some Changes in Base Version.
 *************************************************************************************/

#include "CO_HostStructdef.h"
#include "Intellect_Error.h"

EXEC SQL INCLUDE SQLCA.H;

int MT_ModDBParty(MT_PARTY_STRUCT_H       *p_mt_party_struct_h,
                  INTL_ENV_DATA_STRUCT_H  *p_intl_env_data_struct_h,
                  DEBUG_INFO_STRUCT_H     **l_debug_info_ptr)
{
	/* Variable Decleration */
	MT_PARTY_STRUCT_I *l_mt_party_struct_i;

	struct sqlca sqlca;

	char chr_acc_stamp_compare[APL_DATE_LEN] = APL_NULL_STRING;
	char chr_status_compare[APL_STATUS_LEN] = APL_NULL_STRING;
	char chr_sys_access_stamp[APL_DATE_LEN] = APL_NULL_STRING;
	short p_i_maker = 0; 
	short p_i_makerdt = 0;
	short p_i_checker = 0;
	short p_i_checkerdt = 0;
	short p_i_access_stamp = 0;
	short p_i_access_stamp_compare = 0;
	short p_i_status = 0;
	int int_error_flag = APL_SUCCESS;
	int int_l_rowexists = 0;
	char  *l_key_codes[5];
	char  *l_key_values[5];
	char  chr_l_table_name[50] = APL_NULL_STRING;
	char  *l_link_table_names[5];
	char  chr_l_field_val[40] = APL_NULL_STRING;
	char  p_status[APL_STATUS_LEN] = APL_NULL_STRING;
		/*Added by usman for CSGL API call - start*/
	int l_retval = 0;
	char keyvalue[50]=APL_NULL_STRING;
	short	int_cond_exists 	= 0;
	int int_h_count;
	/*Added by usman for CSGL API call - end*/

	int   int_retval = APL_SUCCESS;
#ifdef APL_THREADS
	APL_SET_CONTEXT
		EXEC SQL CONTEXT USE :my_ctx_local;
#endif

	/* Debug Statements */
	APL_FUNCTION_ENTER(APL_OUT_FILE)

	l_mt_party_struct_i = (MT_PARTY_STRUCT_I *)calloc(1,sizeof(MT_PARTY_STRUCT_I));
	APL_MALLOC_FAIL(l_mt_party_struct_i);

	p_i_maker =0;
	p_i_makerdt =0;
	p_i_checker =0;
	p_i_checkerdt =0;
	p_i_access_stamp =0;
	p_i_access_stamp_compare =0;

	if (!strlen(p_mt_party_struct_h->h_pty_code)) l_mt_party_struct_i->i_pty_code =-1;
	else l_mt_party_struct_i->i_pty_code =0;
	if (!strlen(p_mt_party_struct_h->h_pty_name)) l_mt_party_struct_i->i_pty_name =-1;
	else l_mt_party_struct_i->i_pty_name =0;
	if (!strlen(p_mt_party_struct_h->h_pty_type)) l_mt_party_struct_i->i_pty_type =-1;
	else l_mt_party_struct_i->i_pty_type =0;
	if (!strlen(p_mt_party_struct_h->h_maker)) l_mt_party_struct_i->i_maker =-1;
	else l_mt_party_struct_i->i_maker =0;
	if (!strlen(p_mt_party_struct_h->h_maker_dt)) l_mt_party_struct_i->i_maker_dt =-1;
	else l_mt_party_struct_i->i_maker_dt =0;
	if (!strlen(p_mt_party_struct_h->h_access_stamp)) l_mt_party_struct_i->i_access_stamp =-1;
	else l_mt_party_struct_i->i_access_stamp =0;
	if (!strlen(p_mt_party_struct_h->h_status)) l_mt_party_struct_i->i_status =-1;
	else l_mt_party_struct_i->i_status =0;

	if(CO_RtvSysDtTime(chr_sys_access_stamp,l_debug_info_ptr) !=APL_SUCCESS)
	{
		APL_GOBACK_FAIL
	}

	if (!strcmp(p_intl_env_data_struct_h->h_mode,APL_FUNC_INPUT))
	{
		APL_IF_DEBUG
		{
			CO_ProcMonitor(APL_OUT_FILE, "Entered Input h_mode of Function MT_ModDBParty\n",NULL,p_intl_env_data_struct_h);
		}
       		
		strcpy(p_mt_party_struct_h->h_status,STATUS_UAUTH);
		 
		l_mt_party_struct_i->i_status =0;
		strcpy(p_mt_party_struct_h->h_maker,p_intl_env_data_struct_h->usr);
		 
		l_mt_party_struct_i->i_maker =0;
		strcpy(p_mt_party_struct_h->h_maker_dt,chr_sys_access_stamp);
		 
		l_mt_party_struct_i->i_maker_dt =0;
		strcpy(p_mt_party_struct_h->h_access_stamp,chr_sys_access_stamp);
		 
		l_mt_party_struct_i->i_access_stamp =0;
		 
		strcpy(p_mt_party_struct_h->h_checker,APL_NULL_STRING);
		strcpy(p_mt_party_struct_h->h_checker_dt,APL_NULL_STRING);

		EXEC SQL INSERT INTO MT_PARTY VALUES (:p_mt_party_struct_h:l_mt_party_struct_i);

		IS_ANY_ORA_ERROR_AND_DUPLICATE(ERR_PARTY_EXISTS,APL_NULL_STRING,APL_NULL_STRING,APL_NULL_STRING)
		 
	}
	else
	{
		l_key_codes[0]="PTY_CODE";
		l_key_codes[1]=APL_NULL_STRING;

		l_key_values[0]=p_mt_party_struct_h->h_pty_code;
		l_key_values[1]=APL_NULL_STRING;

		strcpy(chr_l_table_name,"MT_PARTY");

		int_retval = CR_Rtv_MastChldChrVal( l_key_codes,
														l_key_values,
														chr_l_table_name,
														"ACCESS_STAMP",
														chr_l_field_val,
														l_debug_info_ptr);
		if(int_retval != APL_SUCCESS)
			APL_GOBACK_FAIL

		strcpy(chr_acc_stamp_compare,chr_l_field_val);

		int_retval = CR_Rtv_MastChldChrVal( l_key_codes,
														l_key_values,
														chr_l_table_name,
														"STATUS",
														chr_l_field_val,
														l_debug_info_ptr);

		if (int_retval != APL_SUCCESS)
			APL_GOBACK_FAIL

		strcpy(chr_status_compare,chr_l_field_val);
	}
	if (!strcmp(p_intl_env_data_struct_h->h_mode,APL_FUNC_MODIFY))
	{
		

		p_i_checker =0;
		p_i_checkerdt =0;

		strcpy(p_mt_party_struct_h->h_checker,APL_NULL_STRING);
		strcpy(p_mt_party_struct_h->h_checker_dt,APL_NULL_STRING);

		APL_IF_DEBUG
		{
			CO_ProcMonitor(APL_OUT_FILE, "Entered Modify h_mode of Function MT_ModDBParty\n",NULL,p_intl_env_data_struct_h);
		}
		
		
		if(strcmp(p_intl_env_data_struct_h->subprocess, "GFU") == 0)
		{			
		 strcpy(p_mt_party_struct_h->h_access_stamp,chr_acc_stamp_compare);
		}
		if (!strcmp(p_mt_party_struct_h->h_access_stamp,chr_acc_stamp_compare))
		{
			
			strcpy(p_mt_party_struct_h->h_access_stamp,chr_sys_access_stamp);
			l_mt_party_struct_i->i_access_stamp =0;
			strcpy(p_mt_party_struct_h->h_status,STATUS_UAUTH);
			l_mt_party_struct_i->i_status =0;

			EXEC SQL UPDATE MT_PARTY SET
				PTY_NAME =:p_mt_party_struct_h->h_pty_name:l_mt_party_struct_i->i_pty_name,
							PTY_SHORTNM =:p_mt_party_struct_h->h_pty_shortnm:l_mt_party_struct_i->i_pty_shortnm,
							PTY_MAPINID =:p_mt_party_struct_h->h_pty_mapinid:l_mt_party_struct_i->i_pty_mapinid,
							PTY_TYPE =:p_mt_party_struct_h->h_pty_type:l_mt_party_struct_i->i_pty_type,
							PTY_ADD1 =:p_mt_party_struct_h->h_pty_add1:l_mt_party_struct_i->i_pty_add1,
							PTY_ADD2 =:p_mt_party_struct_h->h_pty_add2:l_mt_party_struct_i->i_pty_add2,
							CITY =:p_mt_party_struct_h->h_city:l_mt_party_struct_i->i_city,
							STATE =:p_mt_party_struct_h->h_state:l_mt_party_struct_i->i_state,
							COUNTRY =:p_mt_party_struct_h->h_country:l_mt_party_struct_i->i_country,
							PTY_ADD_PIN =:p_mt_party_struct_h->h_pty_add_pin:l_mt_party_struct_i->i_pty_add_pin,
							PTY_TEL =:p_mt_party_struct_h->h_pty_tel:l_mt_party_struct_i->i_pty_tel,
							PTY_FAX =:p_mt_party_struct_h->h_pty_fax:l_mt_party_struct_i->i_pty_fax,
							PTY_EMAIL =:p_mt_party_struct_h->h_pty_email:l_mt_party_struct_i->i_pty_email,
							PTY_CONTACT1 =:p_mt_party_struct_h->h_pty_contact1:l_mt_party_struct_i->i_pty_contact1,
							PTY_CONTACT2 =:p_mt_party_struct_h->h_pty_contact2:l_mt_party_struct_i->i_pty_contact2,
							PTY_SWF_NAME =:p_mt_party_struct_h->h_pty_swf_name:l_mt_party_struct_i->i_pty_swf_name,
							PTY_SWF_ADD =:p_mt_party_struct_h->h_pty_swf_add:l_mt_party_struct_i->i_pty_swf_add,
                     /*RFN No - HDFCMT_004 - Kouser */
							/**PTY_SEBI_REG_NO =:p_mt_party_struct_h->h_pty_sebi_reg_no:l_mt_party_struct_i->i_pty_sebi_reg_no,**/
							PTY_PAN =:p_mt_party_struct_h->h_pty_pan:l_mt_party_struct_i->i_pty_pan,
							PTY_LC_NAME =:p_mt_party_struct_h->h_pty_lc_name:l_mt_party_struct_i->i_pty_lc_name,
							PTY_LC_ADD =:p_mt_party_struct_h->h_pty_lc_add:l_mt_party_struct_i->i_pty_lc_add,
							PTY_LC_TEL =:p_mt_party_struct_h->h_pty_lc_tel:l_mt_party_struct_i->i_pty_lc_tel,
							PTY_LC_EMAIL =:p_mt_party_struct_h->h_pty_lc_email:l_mt_party_struct_i->i_pty_lc_email,
							PTY_LC_FAX =:p_mt_party_struct_h->h_pty_lc_fax:l_mt_party_struct_i->i_pty_lc_fax,
							MAKER =:p_intl_env_data_struct_h->usr:p_i_maker,
							MAKER_DT =:chr_sys_access_stamp:p_i_makerdt,
							CHECKER =:p_mt_party_struct_h->h_checker:l_mt_party_struct_i->i_checker,
							CHECKER_DT =:p_mt_party_struct_h->h_checker_dt:l_mt_party_struct_i->i_checker_dt,
							ACCESS_STAMP =:chr_sys_access_stamp:p_i_access_stamp,
							PTY_BIC_CODE=:p_mt_party_struct_h->h_pty_bic_code,
							SET_EXCH_CODE=:p_mt_party_struct_h->h_set_exch_code,     /*Added for INTEROPERABILITY - 12174*/
							CSGL_APL=:p_mt_party_struct_h->h_csgl_apl
								WHERE
								PTY_CODE =:p_mt_party_struct_h->h_pty_code;

			/* Status Updation based on Child tables' Status */

			l_key_codes[0]="PTY_CODE";
			l_key_codes[1]=APL_NULL_STRING;

			l_key_values[0]=p_mt_party_struct_h->h_pty_code;
			l_key_values[1]=APL_NULL_STRING;

			strcpy(chr_l_table_name,"MT_PARTY");

			l_link_table_names[0]="MT_PTY_EXCH_MAP";
			l_link_table_names[1]="MT_PTY_DEPO_MAP";
			l_link_table_names[2]="MT_PTY_EXCH_CLN_MAP";
			l_link_table_names[3]=APL_NULL_STRING;

			int_retval = CR_Mod_UpdMastStatus(  l_key_codes,
															l_key_values,
															chr_l_table_name,
															l_link_table_names,
															APL_MASTER_IND,
															p_status,
															chr_sys_access_stamp,
															p_intl_env_data_struct_h,
															l_debug_info_ptr);
			APL_IF_DEBUG
			{
				printf("Returned Status Value = |%s|\n",p_status);
			}

			if (int_retval != APL_SUCCESS)
				APL_GOBACK_FAIL

					APL_GOBACK_SUCCESS

					IS_ANY_ORA_ERROR
		}
		else if(CO_InsertErr(l_debug_info_ptr,
									ERR_ACCESSSTAMP_CHGD,
									APL_NULL_STRING,
									APL_NULL_STRING,
									APL_NULL_STRING,
									__LINE__,
									__FILE__) != APL_SUCCESS)
			APL_GOBACK_FAIL
				int_error_flag = APL_FAILURE;
	}
	else if (!strcmp(p_intl_env_data_struct_h->h_mode,APL_FUNC_AUTHORISE))
	{
		APL_IF_DEBUG
		{
			CO_ProcMonitor(APL_OUT_FILE,"Entered Authorize h_mode of Function MT_DBParty\n",NULL,p_intl_env_data_struct_h);
		}
		if (!strcmp(p_mt_party_struct_h->h_access_stamp,chr_acc_stamp_compare))
		{
			if (strcmp(p_mt_party_struct_h->h_status,STATUS_DEL_UAUTH))
			{
				strcpy(p_mt_party_struct_h->h_access_stamp,chr_sys_access_stamp);
				l_mt_party_struct_i->i_access_stamp =0;
				strcpy(p_mt_party_struct_h->h_checker,p_intl_env_data_struct_h->usr);
				l_mt_party_struct_i->i_checker =0;
				strcpy(p_mt_party_struct_h->h_checker_dt,chr_sys_access_stamp);
				l_mt_party_struct_i->i_checker_dt =0;
				strcpy(p_mt_party_struct_h->h_status,STATUS_AUTH);
				l_mt_party_struct_i->i_status =0;

				EXEC SQL UPDATE MT_PARTY SET
					CHECKER =:p_intl_env_data_struct_h->usr:p_i_checker,
							  CHECKER_DT =:chr_sys_access_stamp:p_i_checkerdt,
							  ACCESS_STAMP =:chr_sys_access_stamp:p_i_access_stamp
								  WHERE PTY_CODE =:p_mt_party_struct_h->h_pty_code;

				/* Status Updation based on Child Tables' status */

				l_key_codes[0]="PTY_CODE";
				l_key_codes[1]=APL_NULL_STRING;

				l_key_values[0]=p_mt_party_struct_h->h_pty_code;
				l_key_values[1]=APL_NULL_STRING;

				strcpy(chr_l_table_name,"MT_PARTY");

				l_link_table_names[0]="MT_PTY_EXCH_MAP";
				l_link_table_names[1]="MT_PTY_DEPO_MAP";
				l_link_table_names[2]="MT_PTY_EXCH_CLN_MAP";
				l_link_table_names[3]=APL_NULL_STRING;

				int_retval = CR_Mod_UpdMastStatus(  l_key_codes,
																l_key_values,
																chr_l_table_name,
																l_link_table_names,
																APL_MASTER_IND,
																p_status,
																chr_sys_access_stamp,
																p_intl_env_data_struct_h,
																l_debug_info_ptr);

				APL_IF_DEBUG
				{
					printf("Returned Status Value = |%s|\n",p_status);
				}


				if (int_retval != APL_SUCCESS)
					APL_GOBACK_FAIL

				printf("p_mt_party_struct_h->h_csgl_apl = |%s|\n",p_mt_party_struct_h->h_csgl_apl);
	       /*Added by usman for CSGL API call - START*/
		   if(!(strcmp(p_mt_party_struct_h->h_csgl_apl,"Y"))){
			CO_Chk_CntryEnabled("API_CONSUMER","MT_PARTY",&int_cond_exists,l_debug_info_ptr);
								
				APL_IF_DEBUG
				{
					printf("API cntry condition = |%d|\n",int_cond_exists);
				}
				
				if(int_cond_exists>0)				
				{
					EXEC SQL SELECT NVL(count(*),0) INTO  :int_h_count 
					from MT_PARTY_CSGL where CP_CODE=:p_mt_party_struct_h->h_pty_code;
					strcpy(keyvalue,"a.PTY_CODE=");
					strcat(keyvalue,p_mt_party_struct_h->h_pty_code);
					printf("int_h_count  = |%d|\n",int_h_count);
					 CO_ProcMonitor(APL_OUT_FILE,"before commit successup\n",NULL,NULL);
					EXEC SQL COMMIT ;
						CO_ProcMonitor(APL_OUT_FILE,"after commit successup\n",NULL,NULL);
					IS_ANY_ORA_ERROR;
				    if(int_h_count==0){
				      	l_retval=callCSGLAPI(p_intl_env_data_struct_h->usr, "MT_PARTY_ADD", keyvalue);
					}
				else{
						l_retval=callCSGLAPI(p_intl_env_data_struct_h->usr, "MT_PARTY_MOD", keyvalue);
				}
					APL_IF_DEBUG
					{
					   if(l_retval == 0)
						{
							CO_ProcMonitor(APL_OUT_FILE, "CSGL_API_call.ksh Executed Successfully for Party\n",NULL,p_intl_env_data_struct_h);
						}
						else
						{
							CO_ProcMonitor(APL_OUT_FILE, "CSGL_API_call.ksh Executed UnSuccessfully for Party\n",NULL,p_intl_env_data_struct_h);
						}
				  }
				
				}
			}
			/*Added by usman for CSGL API call - END*/	
						APL_GOBACK_SUCCESS

						IS_ANY_ORA_ERROR
			}
			else
			{
				EXEC SQL DELETE MT_PARTY
					WHERE PTY_CODE =:p_mt_party_struct_h->h_pty_code;

				IS_ANY_ORA_ERROR
			}
		}
		else if (CO_InsertErr(  l_debug_info_ptr,
										ERR_ACCESSSTAMP_CHGD,
										APL_NULL_STRING,
										APL_NULL_STRING,
										APL_NULL_STRING,
										__LINE__,
										__FILE__) != APL_SUCCESS)
			APL_GOBACK_FAIL
				int_error_flag = APL_FAILURE;
	}
	else if (!strcmp(p_intl_env_data_struct_h->h_mode,APL_FUNC_RESET))
	{
		APL_IF_DEBUG
		{
			CO_ProcMonitor(APL_OUT_FILE,"Entered reset h_mode of MT_ModDBParty\n",NULL,p_intl_env_data_struct_h);
		}
		if (!strcmp(p_mt_party_struct_h->h_access_stamp,chr_acc_stamp_compare))
		{
			if (!strcmp(p_mt_party_struct_h->h_status,STATUS_DEL_UAUTH))
			{
				strcpy(p_mt_party_struct_h->h_access_stamp,chr_sys_access_stamp);
				l_mt_party_struct_i->i_access_stamp =0;
				strcpy(p_mt_party_struct_h->h_checker,p_intl_env_data_struct_h->usr);
				l_mt_party_struct_i->i_checker =0;
				strcpy(p_mt_party_struct_h->h_checker_dt,chr_sys_access_stamp);
				l_mt_party_struct_i->i_checker_dt =0;
				strcpy(p_mt_party_struct_h->h_status,STATUS_AUTH);
				l_mt_party_struct_i->i_status =0;

				EXEC SQL UPDATE MT_PARTY SET
					CHECKER =:p_intl_env_data_struct_h->usr:p_i_checker,
							  CHECKER_DT =:chr_sys_access_stamp:p_i_checkerdt,
							  ACCESS_STAMP =:chr_sys_access_stamp:p_i_access_stamp
								  WHERE
								  PTY_CODE =:p_mt_party_struct_h->h_pty_code;

				/* Status Updation based on child tables' status */

				l_key_codes[0]="PTY_CODE";
				l_key_codes[1]=APL_NULL_STRING;

				l_key_values[0]=p_mt_party_struct_h->h_pty_code;
				l_key_values[1]=APL_NULL_STRING;

				strcpy(chr_l_table_name,"MT_PARTY");

				l_link_table_names[0]="MT_PTY_EXCH_MAP";
				l_link_table_names[1]="MT_PTY_DEPO_MAP";
				l_link_table_names[2]="MT_PTY_EXCH_CLN_MAP";
				l_link_table_names[3]=APL_NULL_STRING;

				int_retval = CR_Mod_UpdMastStatus( 	l_key_codes,
															  	l_key_values,
																chr_l_table_name,
																l_link_table_names,
																APL_MASTER_IND,
																p_status,
																chr_sys_access_stamp,
																p_intl_env_data_struct_h,
																l_debug_info_ptr);

				APL_IF_DEBUG
				{
					printf("Returned Status Value = |%s|\n",p_status);
				}


				if (int_retval != APL_SUCCESS)
					APL_GOBACK_FAIL

						APL_GOBACK_SUCCESS

						IS_ANY_ORA_ERROR
			}
			else
			{
				if (CO_InsertErr( l_debug_info_ptr,
										ERR_CANT_RESET,
										APL_NULL_STRING,
										APL_NULL_STRING,
										APL_NULL_STRING,
										__LINE__,
										__FILE__) != APL_SUCCESS)
					APL_GOBACK_FAIL
						int_error_flag = APL_FAILURE;
			}
		}
		else if (CO_InsertErr(  l_debug_info_ptr,
										ERR_ACCESSSTAMP_CHGD,
										APL_NULL_STRING,
										APL_NULL_STRING,
										APL_NULL_STRING,
										__LINE__,
										__FILE__) != APL_SUCCESS)
			APL_GOBACK_FAIL
				int_error_flag = APL_FAILURE;
	}
	else if (!strcmp(p_intl_env_data_struct_h->h_mode,APL_FUNC_DELETE))
	{
		p_i_checker =-1;
		p_i_checkerdt =-1;

		strcpy(p_mt_party_struct_h->h_checker,APL_NULL_STRING);
		strcpy(p_mt_party_struct_h->h_checker_dt,APL_NULL_STRING);

		APL_IF_DEBUG
		{
			CO_ProcMonitor(APL_OUT_FILE,"Entered delete h_mode of MT_ModDBParty\n",NULL,p_intl_env_data_struct_h);
		}
		if (!strcmp(p_mt_party_struct_h->h_access_stamp,chr_acc_stamp_compare))
		{
			strcpy(p_mt_party_struct_h->h_access_stamp,chr_sys_access_stamp);
			l_mt_party_struct_i->i_access_stamp =0;
			strcpy(p_mt_party_struct_h->h_status,STATUS_DEL_UAUTH);
			l_mt_party_struct_i->i_status =0;

			EXEC SQL UPDATE MT_PARTY SET
				MAKER =:p_intl_env_data_struct_h->usr:p_i_maker,
						MAKER_DT =:chr_sys_access_stamp:p_i_makerdt,
						CHECKER =:p_mt_party_struct_h->h_checker:l_mt_party_struct_i->i_checker,
						CHECKER_DT =:p_mt_party_struct_h->h_checker_dt:l_mt_party_struct_i->i_checker_dt,
						ACCESS_STAMP =:p_mt_party_struct_h->h_access_stamp:p_i_access_stamp,
						STATUS =:p_mt_party_struct_h->h_status:l_mt_party_struct_i->i_status
							WHERE PTY_CODE =:p_mt_party_struct_h->h_pty_code;

			IS_ANY_ORA_ERROR
		}
		else if (CO_InsertErr(  l_debug_info_ptr,
										ERR_ACCESSSTAMP_CHGD,
										APL_NULL_STRING,
										APL_NULL_STRING,
										APL_NULL_STRING,
										__LINE__,
										__FILE__) != APL_SUCCESS)
		{
				int_error_flag = APL_FAILURE;
		}
	}
	if (int_error_flag == APL_FAILURE)
	{
		APL_GOBACK_FAIL
	}
	APL_GOBACK_SUCCESS

	RETURN_SUCCESS:
	{
		//AIX - Warnings Removal	
			APL_FREE(l_mt_party_struct_i)
		APL_FUNCTION_RET_SUCCESS(APL_OUT_FILE)
		
	}
	RETURN_FAILURE:
	{

			APL_FREE(l_mt_party_struct_i)
		APL_FUNCTION_RET_FAILURE(APL_OUT_FILE)
		
	}
}


int MT_ModDBPtyExchMap(	MT_PTY_EXCH_MAP_STRUCT_H	*p_mt_pty_exch_map_struct_h,
								INTL_ENV_DATA_STRUCT_H		*p_intl_env_data_struct_h,
								DEBUG_INFO_STRUCT_H			**l_debug_info_ptr)
{
	/* Variable Decleration */
	MT_PTY_EXCH_MAP_STRUCT_I	*l_mt_pty_exch_map_struct_i;

	struct sqlca sqlca;

	char chr_acc_stamp_compare[APL_DATE_LEN] = APL_NULL_STRING;
	char chr_status_compare[APL_STATUS_LEN] = APL_NULL_STRING;
	char chr_sys_access_stamp[APL_DATE_LEN] = APL_NULL_STRING;
	short p_i_maker, p_i_makerdt, p_i_checker, p_i_checkerdt, p_i_access_stamp;
	short p_i_access_stamp_compare;
	short p_i_status = 0;
	int int_error_flag = APL_SUCCESS;
	int int_l_rowexists = 0;
	char  *l_key_codes[5];
	char  *l_key_values[5];
	char  chr_l_table_name[50] = APL_NULL_STRING;
	char  *l_link_table_names[5];
	char  chr_l_field_val[40] = APL_NULL_STRING;
	char  p_status[APL_STATUS_LEN];

	int   int_retval = APL_SUCCESS;
#ifdef APL_THREADS
	APL_SET_CONTEXT
		EXEC SQL CONTEXT USE :my_ctx_local;
#endif

	/* Debug Statements */
	APL_FUNCTION_ENTER(APL_OUT_FILE)

	l_mt_pty_exch_map_struct_i = (MT_PTY_EXCH_MAP_STRUCT_I *)calloc(1,sizeof(MT_PTY_EXCH_MAP_STRUCT_I));
	APL_MALLOC_FAIL(l_mt_pty_exch_map_struct_i);

	p_i_maker =0;
	p_i_makerdt =0;
	p_i_checker =0;
	p_i_checkerdt =0;
	p_i_access_stamp =0;
	p_i_access_stamp_compare =0;

	if (!strlen(p_mt_pty_exch_map_struct_h->h_pty_code))	l_mt_pty_exch_map_struct_i->i_pty_code = -1;
	l_mt_pty_exch_map_struct_i->i_pty_code = 0;
	if (!strlen(p_mt_pty_exch_map_struct_h->h_exch_code))	l_mt_pty_exch_map_struct_i->i_exch_code = -1;
	l_mt_pty_exch_map_struct_i->i_exch_code = 0;
	if (!strlen(p_mt_pty_exch_map_struct_h->h_pty_exch_map_code))	l_mt_pty_exch_map_struct_i->i_pty_exch_map_code = -1;
	l_mt_pty_exch_map_struct_i->i_pty_exch_map_code = 0;
	if (!strlen(p_mt_pty_exch_map_struct_h->h_maker))	l_mt_pty_exch_map_struct_i->i_maker = -1;
	l_mt_pty_exch_map_struct_i->i_maker = 0;
	if (!strlen(p_mt_pty_exch_map_struct_h->h_maker_dt))	l_mt_pty_exch_map_struct_i->i_maker_dt = -1;
	l_mt_pty_exch_map_struct_i->i_maker_dt = 0;
	if (!strlen(p_mt_pty_exch_map_struct_h->h_access_stamp))	l_mt_pty_exch_map_struct_i->i_access_stamp = -1;
	l_mt_pty_exch_map_struct_i->i_access_stamp = 0;
	if (!strlen(p_mt_pty_exch_map_struct_h->h_status))	l_mt_pty_exch_map_struct_i->i_status = -1;
	l_mt_pty_exch_map_struct_i->i_status = 0;

	if(CO_RtvSysDtTime(chr_sys_access_stamp,l_debug_info_ptr) !=APL_SUCCESS)
	{
		APL_GOBACK_FAIL
	}

	if (!strcmp(p_intl_env_data_struct_h->h_mode,APL_FUNC_INPUT))
	{
		APL_IF_DEBUG
		{
			CO_ProcMonitor(APL_OUT_FILE, "Entered Input h_mode of Function MT_ModDBPtyExchMap\n",NULL,p_intl_env_data_struct_h);
		}
		strcpy(p_mt_pty_exch_map_struct_h->h_status,STATUS_UAUTH);
		l_mt_pty_exch_map_struct_i->i_status =0;
		strcpy(p_mt_pty_exch_map_struct_h->h_maker,p_intl_env_data_struct_h->usr);
		l_mt_pty_exch_map_struct_i->i_maker =0;
		strcpy(p_mt_pty_exch_map_struct_h->h_maker_dt,chr_sys_access_stamp);
		l_mt_pty_exch_map_struct_i->i_maker_dt =0;
		strcpy(p_mt_pty_exch_map_struct_h->h_access_stamp,chr_sys_access_stamp);
		l_mt_pty_exch_map_struct_i->i_access_stamp =0;
		strcpy(p_mt_pty_exch_map_struct_h->h_checker,APL_NULL_STRING);
		strcpy(p_mt_pty_exch_map_struct_h->h_checker_dt,APL_NULL_STRING);

		EXEC SQL INSERT INTO MT_PTY_EXCH_MAP VALUES (:p_mt_pty_exch_map_struct_h:l_mt_pty_exch_map_struct_i);

		IS_ANY_ORA_ERROR_AND_DUPLICATE(ERR_PARTY_EXCHMAP_EXISTS,APL_NULL_STRING,APL_NULL_STRING,APL_NULL_STRING)

		/* Status Updation of Master Table */

		l_key_codes[0]="PTY_CODE";
		l_key_codes[1]=APL_NULL_STRING;

		l_key_values[0]=p_mt_pty_exch_map_struct_h->h_pty_code;
		l_key_values[1]=APL_NULL_STRING;

		strcpy(chr_l_table_name,"MT_PARTY");

		l_link_table_names[0]="MT_PTY_EXCH_MAP";
		l_link_table_names[1]="MT_PTY_DEPO_MAP";
		l_link_table_names[2]="MT_PTY_EXCH_CLN_MAP";
		l_link_table_names[3]=APL_NULL_STRING;

		int_retval = CR_Mod_UpdMastStatus(	l_key_codes,
														l_key_values,
														chr_l_table_name,
														l_link_table_names,
														APL_CHILD_IND,
														p_status,
														chr_sys_access_stamp,
														p_intl_env_data_struct_h,
														l_debug_info_ptr);
		APL_IF_DEBUG
		{
			printf("Returned Status Value = |%s|\n",p_status);
		}


		if (int_retval != APL_SUCCESS)
			APL_GOBACK_FAIL

				APL_GOBACK_SUCCESS

				IS_ANY_ORA_ERROR

	}
	else
	{
		l_key_codes[0]="PTY_CODE";
		l_key_codes[1]="EXCH_CODE";
		l_key_codes[2]="PTY_EXCH_MAP_CODE";
		l_key_codes[3]=APL_NULL_STRING;

		l_key_values[0]=p_mt_pty_exch_map_struct_h->h_pty_code;
		l_key_values[1]=p_mt_pty_exch_map_struct_h->h_exch_code;
		l_key_values[2]=p_mt_pty_exch_map_struct_h->h_pty_exch_map_code;
		l_key_values[3]=APL_NULL_STRING;

		strcpy(chr_l_table_name,"MT_PTY_EXCH_MAP");

		int_retval = CR_Rtv_MastChldChrVal(	l_key_codes,
														l_key_values,
														chr_l_table_name,
														"ACCESS_STAMP",
														chr_l_field_val,
														l_debug_info_ptr);
		if(int_retval != APL_SUCCESS)
			APL_GOBACK_FAIL

		strcpy(chr_acc_stamp_compare,chr_l_field_val);

		int_retval = CR_Rtv_MastChldChrVal( l_key_codes,
														l_key_values,
														chr_l_table_name,
														"STATUS",
														chr_l_field_val,
														l_debug_info_ptr);

		if (int_retval != APL_SUCCESS)
			APL_GOBACK_FAIL

		strcpy(chr_status_compare,chr_l_field_val);
	}
	if (!strcmp(p_intl_env_data_struct_h->h_mode,APL_FUNC_MODIFY))
	{
		p_i_checker =0;
		p_i_checkerdt =0;

		strcpy(p_mt_pty_exch_map_struct_h->h_checker,APL_NULL_STRING);
		strcpy(p_mt_pty_exch_map_struct_h->h_checker_dt,APL_NULL_STRING);

		APL_IF_DEBUG
		{
			CO_ProcMonitor(APL_OUT_FILE, "Entered Modify h_mode of Function MT_ModDBPtyExchMap\n",NULL,p_intl_env_data_struct_h);
		}
		if (!strcmp(p_mt_pty_exch_map_struct_h->h_access_stamp,chr_acc_stamp_compare))
		{
			strcpy(p_mt_pty_exch_map_struct_h->h_access_stamp,chr_sys_access_stamp);
			l_mt_pty_exch_map_struct_i->i_access_stamp =0;
			strcpy(p_mt_pty_exch_map_struct_h->h_status,STATUS_UAUTH);
			l_mt_pty_exch_map_struct_i->i_status =0;

			EXEC SQL UPDATE MT_PTY_EXCH_MAP SET 
				PTY_CMBP_ID =:p_mt_pty_exch_map_struct_h->h_pty_cmbp_id:l_mt_pty_exch_map_struct_i->i_pty_cmbp_id,
				PTY_CCCM_ID =:p_mt_pty_exch_map_struct_h->h_pty_cccm_id:l_mt_pty_exch_map_struct_i->i_pty_cccm_id,
				ACCESS_STAMP =:p_mt_pty_exch_map_struct_h->h_access_stamp:l_mt_pty_exch_map_struct_i->i_access_stamp,
				MAKER =:p_intl_env_data_struct_h->usr:p_i_maker,
				MAKER_DT =:chr_sys_access_stamp:p_i_makerdt,
				CHECKER =:p_mt_pty_exch_map_struct_h->h_checker:l_mt_pty_exch_map_struct_i->i_checker,
				CHECKER_DT =:p_mt_pty_exch_map_struct_h->h_checker_dt:l_mt_pty_exch_map_struct_i->i_checker_dt,
				STATUS =:p_mt_pty_exch_map_struct_h->h_status:l_mt_pty_exch_map_struct_i->i_status,             
            /* Kouser - HDFCMT_004 - PTY_SEBI_REG_NO_1,PTY_SEBI_REG_NO_2 Added for Party Master */
							PTY_SEBI_REG_NO_1 =:p_mt_pty_exch_map_struct_h->h_pty_sebi_reg_no1:l_mt_pty_exch_map_struct_i->i_pty_sebi_reg_no1,
							PTY_SEBI_REG_NO_2 =:p_mt_pty_exch_map_struct_h->h_pty_sebi_reg_no2:l_mt_pty_exch_map_struct_i->i_pty_sebi_reg_no2
					WHERE PTY_CODE =:p_mt_pty_exch_map_struct_h->h_pty_code AND
					      EXCH_CODE =:p_mt_pty_exch_map_struct_h->h_exch_code AND
				       	PTY_EXCH_MAP_CODE =:p_mt_pty_exch_map_struct_h->h_pty_exch_map_code;

			/* Status Updation of Master Table */

			l_key_codes[0]="PTY_CODE";
			l_key_codes[1]=APL_NULL_STRING;

			l_key_values[0]=p_mt_pty_exch_map_struct_h->h_pty_code;
			l_key_values[1]=APL_NULL_STRING;

			strcpy(chr_l_table_name,"MT_PARTY");

			l_link_table_names[0]="MT_PTY_EXCH_MAP";
			l_link_table_names[1]="MT_PTY_DEPO_MAP";
			l_link_table_names[2]="MT_PTY_EXCH_CLN_MAP";
			l_link_table_names[3]=APL_NULL_STRING;
			
			int_retval = CR_Mod_UpdMastStatus(  l_key_codes,
					l_key_values,
					chr_l_table_name,
					l_link_table_names,
					APL_CHILD_IND,
					p_status,
					chr_sys_access_stamp,
					p_intl_env_data_struct_h,
					l_debug_info_ptr);
			APL_IF_DEBUG
			{
				printf("Returned Status Value = |%s|\n",p_status);
			}


			if (int_retval != APL_SUCCESS)
				APL_GOBACK_FAIL

					APL_GOBACK_SUCCESS

					IS_ANY_ORA_ERROR
		}
		else if (CO_InsertErr(	l_debug_info_ptr,
										ERR_ACCESSSTAMP_CHGD,
										APL_NULL_STRING,
										APL_NULL_STRING,
										APL_NULL_STRING,
										__LINE__,
										__FILE__) != APL_SUCCESS)
			APL_GOBACK_FAIL
				int_error_flag = APL_FAILURE;
	}

	else if (!strcmp(p_intl_env_data_struct_h->h_mode,APL_FUNC_AUTHORISE))
	{
		APL_IF_DEBUG
		{
			CO_ProcMonitor(APL_OUT_FILE,"Entered Authorize h_mode of Function MT_DBPtyExchMap\n",NULL,p_intl_env_data_struct_h);
		}
		if (!strcmp(p_mt_pty_exch_map_struct_h->h_access_stamp,chr_acc_stamp_compare))
		{
			if (strcmp(p_mt_pty_exch_map_struct_h->h_status,STATUS_DEL_UAUTH))
			{
				strcpy(p_mt_pty_exch_map_struct_h->h_access_stamp,chr_sys_access_stamp);
				l_mt_pty_exch_map_struct_i->i_access_stamp =0;
				strcpy(p_mt_pty_exch_map_struct_h->h_checker,p_intl_env_data_struct_h->usr);
				l_mt_pty_exch_map_struct_i->i_checker =0;
				strcpy(p_mt_pty_exch_map_struct_h->h_checker_dt,chr_sys_access_stamp);
				l_mt_pty_exch_map_struct_i->i_checker_dt =0;
				strcpy(p_mt_pty_exch_map_struct_h->h_status,STATUS_AUTH);
				l_mt_pty_exch_map_struct_i->i_status =0;

				EXEC SQL UPDATE MT_PTY_EXCH_MAP SET
					CHECKER =:p_intl_env_data_struct_h->usr:p_i_checker,
							  CHECKER_DT =:chr_sys_access_stamp:p_i_checkerdt,
							  ACCESS_STAMP =:chr_sys_access_stamp:p_i_access_stamp,
							  STATUS =:p_mt_pty_exch_map_struct_h->h_status:l_mt_pty_exch_map_struct_i->i_status
								  WHERE PTY_CODE =:p_mt_pty_exch_map_struct_h->h_pty_code AND
								  EXCH_CODE =:p_mt_pty_exch_map_struct_h->h_exch_code AND
								  PTY_EXCH_MAP_CODE =:p_mt_pty_exch_map_struct_h->h_pty_exch_map_code;

				/* Status Updation of Master Table */
				l_key_codes[0]="PTY_CODE";
				l_key_codes[1]=APL_NULL_STRING;

				l_key_values[0]=p_mt_pty_exch_map_struct_h->h_pty_code;
				l_key_values[1]=APL_NULL_STRING;

				strcpy(chr_l_table_name,"MT_PARTY");

				l_link_table_names[0]="MT_PTY_EXCH_MAP";
				l_link_table_names[1]="MT_PTY_DEPO_MAP";
				l_link_table_names[2]="MT_PTY_EXCH_CLN_MAP";
				l_link_table_names[3]=APL_NULL_STRING;

				int_retval = CR_Mod_UpdMastStatus(  l_key_codes,
																l_key_values,
																chr_l_table_name,
																l_link_table_names,
																APL_CHILD_IND,
																p_status,
																chr_sys_access_stamp,
																p_intl_env_data_struct_h,
																l_debug_info_ptr);
				APL_IF_DEBUG
				{
					printf("Returned Status Value = |%s|\n",p_status);
				}


				if (int_retval != APL_SUCCESS)
					APL_GOBACK_FAIL

						APL_GOBACK_SUCCESS

						IS_ANY_ORA_ERROR
			}
			else
			{
				EXEC SQL DELETE MT_PTY_EXCH_MAP
					WHERE PTY_CODE =:p_mt_pty_exch_map_struct_h->h_pty_code AND
							EXCH_CODE =:p_mt_pty_exch_map_struct_h->h_exch_code AND
							PTY_EXCH_MAP_CODE =:p_mt_pty_exch_map_struct_h->h_pty_exch_map_code;

				/* Status Updation of Master Table */

				l_key_codes[0]="PTY_CODE";
				l_key_codes[1]=APL_NULL_STRING;

				l_key_values[0]=p_mt_pty_exch_map_struct_h->h_pty_code;
				l_key_values[1]=APL_NULL_STRING;

				strcpy(chr_l_table_name,"MT_PARTY");

				l_link_table_names[0]="MT_PTY_EXCH_MAP";
				l_link_table_names[1]="MT_PTY_DEPO_MAP";
				l_link_table_names[2]="MT_PTY_EXCH_CLN_MAP";
				l_link_table_names[3]=APL_NULL_STRING;

				int_retval = CR_Mod_UpdMastStatus(  l_key_codes,
						l_key_values,
						chr_l_table_name,
						l_link_table_names,
						APL_CHILD_IND,
						p_status,
						chr_sys_access_stamp,
						p_intl_env_data_struct_h,
						l_debug_info_ptr);
				APL_IF_DEBUG
				{
					printf("Returned Status Value = |%s|\n",p_status);
				}

				if (int_retval != APL_SUCCESS)
					APL_GOBACK_FAIL

						APL_GOBACK_SUCCESS

						IS_ANY_ORA_ERROR
			}
		}
		else if (CO_InsertErr(  l_debug_info_ptr,
										ERR_ACCESSSTAMP_CHGD,
										APL_NULL_STRING,
										APL_NULL_STRING,
										APL_NULL_STRING,
										__LINE__,
										__FILE__) != APL_SUCCESS)
				APL_GOBACK_FAIL
					int_error_flag = APL_FAILURE;
	}
	
	else if (!strcmp(p_intl_env_data_struct_h->h_mode,APL_FUNC_RESET))
	{
		APL_IF_DEBUG
		{
			CO_ProcMonitor(APL_OUT_FILE,"Entered reset h_mode of MT_ModDBPtyExchMap\n",NULL,p_intl_env_data_struct_h);
		}
		if (!strcmp(p_mt_pty_exch_map_struct_h->h_access_stamp,chr_acc_stamp_compare))
		{
			if (!strcmp(p_mt_pty_exch_map_struct_h->h_status,STATUS_DEL_UAUTH))
			{
				strcpy(p_mt_pty_exch_map_struct_h->h_access_stamp,chr_sys_access_stamp);
				l_mt_pty_exch_map_struct_i->i_access_stamp =0;
				strcpy(p_mt_pty_exch_map_struct_h->h_checker,p_intl_env_data_struct_h->usr);
				l_mt_pty_exch_map_struct_i->i_checker =0;
				strcpy(p_mt_pty_exch_map_struct_h->h_checker_dt,chr_sys_access_stamp);
				l_mt_pty_exch_map_struct_i->i_checker_dt =0;
				strcpy(p_mt_pty_exch_map_struct_h->h_status,STATUS_AUTH);
				l_mt_pty_exch_map_struct_i->i_status =0;

				EXEC SQL UPDATE MT_PTY_EXCH_MAP SET
					CHECKER =:p_intl_env_data_struct_h->usr:p_i_checker,
							  CHECKER_DT =:chr_sys_access_stamp:p_i_checkerdt,
							  ACCESS_STAMP =:chr_sys_access_stamp:p_i_access_stamp,
							  STATUS =:p_mt_pty_exch_map_struct_h->h_status:l_mt_pty_exch_map_struct_i->i_status
								  WHERE
								  PTY_CODE =:p_mt_pty_exch_map_struct_h->h_pty_code AND
								  EXCH_CODE =:p_mt_pty_exch_map_struct_h->h_exch_code AND
								  PTY_EXCH_MAP_CODE =:p_mt_pty_exch_map_struct_h->h_pty_exch_map_code;
				
				/* Status Updation of Master Table */
				l_key_codes[0]="PTY_CODE";
				l_key_codes[1]=APL_NULL_STRING;

				l_key_values[0]=p_mt_pty_exch_map_struct_h->h_pty_code;
				l_key_values[1]=APL_NULL_STRING;

				strcpy(chr_l_table_name,"MT_PARTY");

				l_link_table_names[0]="MT_PTY_EXCH_MAP";
				l_link_table_names[1]="MT_PTY_DEPO_MAP";
				l_link_table_names[2]="MT_PTY_EXCH_CLN_MAP";
				l_link_table_names[3]=APL_NULL_STRING;
				
				int_retval = CR_Mod_UpdMastStatus(  l_key_codes,
																l_key_values,
																chr_l_table_name,
																l_link_table_names,
																APL_CHILD_IND,
																p_status,
																chr_sys_access_stamp,
																p_intl_env_data_struct_h,
																l_debug_info_ptr);
				APL_IF_DEBUG
				{
					printf("Returned Status Value = |%s|\n",p_status);
				}


				if (int_retval != APL_SUCCESS)
					APL_GOBACK_FAIL

						APL_GOBACK_SUCCESS

						IS_ANY_ORA_ERROR
			}
			else
			{
				if (CO_InsertErr( l_debug_info_ptr,
										ERR_CANT_RESET,
										APL_NULL_STRING,
										APL_NULL_STRING,
										APL_NULL_STRING,
										__LINE__,
										__FILE__) != APL_SUCCESS)
					APL_GOBACK_FAIL
						int_error_flag = APL_FAILURE;
			}
		}
			else if (CO_InsertErr(  l_debug_info_ptr,
											ERR_ACCESSSTAMP_CHGD,
											APL_NULL_STRING,
											APL_NULL_STRING,
											APL_NULL_STRING,
											__LINE__,
											__FILE__) != APL_SUCCESS)
				APL_GOBACK_FAIL
					int_error_flag = APL_FAILURE;
	}
	else if (!strcmp(p_intl_env_data_struct_h->h_mode,APL_FUNC_DELETE))
	{
		p_i_checker =-1;
		p_i_checkerdt =-1;

		strcpy(p_mt_pty_exch_map_struct_h->h_checker,APL_NULL_STRING);
		strcpy(p_mt_pty_exch_map_struct_h->h_checker_dt,APL_NULL_STRING);

		APL_IF_DEBUG
		{
			CO_ProcMonitor(APL_OUT_FILE,"Entered delete h_mode of MT_ModDBPtyExchMap\n",NULL,p_intl_env_data_struct_h);
		}
		if (!strcmp(p_mt_pty_exch_map_struct_h->h_access_stamp,chr_acc_stamp_compare))
		{
			strcpy(p_mt_pty_exch_map_struct_h->h_access_stamp,chr_sys_access_stamp);
			l_mt_pty_exch_map_struct_i->i_access_stamp =0;
			strcpy(p_mt_pty_exch_map_struct_h->h_status,STATUS_DEL_UAUTH);
			l_mt_pty_exch_map_struct_i->i_status =0;

			EXEC SQL UPDATE MT_PTY_EXCH_MAP SET
				MAKER =:p_intl_env_data_struct_h->usr:p_i_maker,
						MAKER_DT =:chr_sys_access_stamp:p_i_makerdt,
						CHECKER =:p_mt_pty_exch_map_struct_h->h_checker:l_mt_pty_exch_map_struct_i->i_checker,
						CHECKER_DT =:p_mt_pty_exch_map_struct_h->h_checker_dt:l_mt_pty_exch_map_struct_i->i_checker_dt,
						ACCESS_STAMP =:p_mt_pty_exch_map_struct_h->h_access_stamp:p_i_access_stamp,
						STATUS =:p_mt_pty_exch_map_struct_h->h_status:l_mt_pty_exch_map_struct_i->i_status
							WHERE PTY_CODE =:p_mt_pty_exch_map_struct_h->h_pty_code AND
							EXCH_CODE =:p_mt_pty_exch_map_struct_h->h_exch_code AND
							PTY_EXCH_MAP_CODE =:p_mt_pty_exch_map_struct_h->h_pty_exch_map_code;

			/* Status Updation of Master Table */
			l_key_codes[0]="PTY_CODE";
			l_key_codes[1]=APL_NULL_STRING;

			l_key_values[0]=p_mt_pty_exch_map_struct_h->h_pty_code;
			l_key_values[1]=APL_NULL_STRING;

			strcpy(chr_l_table_name,"MT_PARTY");

			l_link_table_names[0]="MT_PTY_EXCH_MAP";
			l_link_table_names[1]="MT_PTY_DEPO_MAP";
			l_link_table_names[2]="MT_PTY_EXCH_CLN_MAP";
			l_link_table_names[3]=APL_NULL_STRING;
			
			int_retval = CR_Mod_UpdMastStatus(  l_key_codes,
															l_key_values,
															chr_l_table_name,
															l_link_table_names,
															APL_CHILD_IND,
															p_status,
															chr_sys_access_stamp,
															p_intl_env_data_struct_h,
															l_debug_info_ptr);
			APL_IF_DEBUG
			{
				printf("Returned Status Value = |%s|\n",p_status);
			}


			if (int_retval != APL_SUCCESS)
				APL_GOBACK_FAIL

					APL_GOBACK_SUCCESS


					IS_ANY_ORA_ERROR
		}
		else if (CO_InsertErr(  l_debug_info_ptr,
										ERR_ACCESSSTAMP_CHGD,
										APL_NULL_STRING,
										APL_NULL_STRING,
										APL_NULL_STRING,
										__LINE__,
										__FILE__) != APL_SUCCESS)
			APL_GOBACK_FAIL
				int_error_flag = APL_FAILURE;
	}
	if (int_error_flag == APL_FAILURE)
	{
		APL_GOBACK_FAIL
	}
	APL_GOBACK_SUCCESS

	RETURN_SUCCESS:
	{
		APL_FUNCTION_RET_SUCCESS(APL_OUT_FILE)
			APL_FREE(l_mt_pty_exch_map_struct_i)
				return(APL_SUCCESS);
	}
	RETURN_FAILURE:
	{
		APL_FUNCTION_RET_FAILURE(APL_OUT_FILE)
			APL_FREE(l_mt_pty_exch_map_struct_i)
				return(APL_FAILURE);
	}
}


int MT_ModDBPtyDepoMap( MT_PTY_DEPO_MAP_STRUCT_H   *p_mt_pty_depo_map_struct_h,
								INTL_ENV_DATA_STRUCT_H     *p_intl_env_data_struct_h,
								DEBUG_INFO_STRUCT_H        **l_debug_info_ptr)
{
	/* Variable Decleration */
	MT_PTY_DEPO_MAP_STRUCT_I   *l_mt_pty_depo_map_struct_i;

	struct sqlca sqlca;

	char chr_acc_stamp_compare[APL_DATE_LEN] = APL_NULL_STRING;
	char chr_status_compare[APL_STATUS_LEN] = APL_NULL_STRING;
	char chr_sys_access_stamp[APL_DATE_LEN] = APL_NULL_STRING;
	short p_i_maker, p_i_makerdt, p_i_checker, p_i_checkerdt, p_i_access_stamp;
	short p_i_access_stamp_compare;
	short p_i_status = 0;
	int int_error_flag = APL_SUCCESS;
	int int_l_rowexists = 0;
	char  *l_key_codes[5];
	char  *l_key_values[5];
	char  chr_l_table_name[50] = APL_NULL_STRING;
	char  *l_link_table_names[5];
	char  chr_l_field_val[40] = APL_NULL_STRING;
	char  p_status[APL_STATUS_LEN];

	int   int_retval = APL_SUCCESS;
	/*Added by usman for CSGL API call - start*/
	int l_chr_cgsl=0;
	int l_retval = 0;
	char keyvalue[50]=APL_NULL_STRING;
	short	int_cond_exists 	= 0;
	int int_h_count;
	/*Added by usman for CSGL API call - end*/
#ifdef APL_THREADS
	APL_SET_CONTEXT
		EXEC SQL CONTEXT USE :my_ctx_local;
#endif

	/* Debug Statements */
	APL_FUNCTION_ENTER(APL_OUT_FILE)

	l_mt_pty_depo_map_struct_i = (MT_PTY_DEPO_MAP_STRUCT_I *)calloc(1,sizeof(MT_PTY_DEPO_MAP_STRUCT_I));
	APL_MALLOC_FAIL(l_mt_pty_depo_map_struct_i);

	p_i_maker =0;
	p_i_makerdt =0;
	p_i_checker =0;
	p_i_checkerdt =0;
	p_i_access_stamp =0;
	p_i_access_stamp_compare =0;

	if (!strlen(p_mt_pty_depo_map_struct_h->h_pty_code))	l_mt_pty_depo_map_struct_i->i_pty_code = -1;
	l_mt_pty_depo_map_struct_i->i_pty_code = 0;
	if (!strlen(p_mt_pty_depo_map_struct_h->h_depo_code))	l_mt_pty_depo_map_struct_i->i_depo_code = -1;
	l_mt_pty_depo_map_struct_i->i_depo_code = 0;
	if (!strlen(p_mt_pty_depo_map_struct_h->h_pty_depo_map_client_id)) l_mt_pty_depo_map_struct_i->i_pty_depo_map_client_id = -1;
	l_mt_pty_depo_map_struct_i->i_pty_depo_map_client_id = 0;
	if (!strlen(p_mt_pty_depo_map_struct_h->h_pty_depo_map_dp_id)) l_mt_pty_depo_map_struct_i->i_pty_depo_map_dp_id = -1;
	l_mt_pty_depo_map_struct_i->i_pty_depo_map_dp_id = 0;
	if (!strlen(p_mt_pty_depo_map_struct_h->h_maker))  l_mt_pty_depo_map_struct_i->i_maker = -1;
	l_mt_pty_depo_map_struct_i->i_maker = 0;
	if (!strlen(p_mt_pty_depo_map_struct_h->h_maker_dt))  l_mt_pty_depo_map_struct_i->i_maker_dt = -1;
	l_mt_pty_depo_map_struct_i->i_maker_dt = 0;
	if (!strlen(p_mt_pty_depo_map_struct_h->h_access_stamp)) l_mt_pty_depo_map_struct_i->i_access_stamp = -1;
	l_mt_pty_depo_map_struct_i->i_access_stamp = 0;
	if (!strlen(p_mt_pty_depo_map_struct_h->h_status)) l_mt_pty_depo_map_struct_i->i_status = -1;
	l_mt_pty_depo_map_struct_i->i_status = 0;

	if(CO_RtvSysDtTime(chr_sys_access_stamp,l_debug_info_ptr) !=APL_SUCCESS)
	{
		APL_GOBACK_FAIL
	}

	if (!strcmp(p_intl_env_data_struct_h->h_mode,APL_FUNC_INPUT))
	{
		APL_IF_DEBUG
		{
			CO_ProcMonitor(APL_OUT_FILE, "Entered Input h_mode of Function MT_ModDBPtyDepoMap\n",NULL,p_intl_env_data_struct_h);
		}
		strcpy(p_mt_pty_depo_map_struct_h->h_status,STATUS_UAUTH);
		l_mt_pty_depo_map_struct_i->i_status =0;
		strcpy(p_mt_pty_depo_map_struct_h->h_maker,p_intl_env_data_struct_h->usr);
		l_mt_pty_depo_map_struct_i->i_maker =0;
		strcpy(p_mt_pty_depo_map_struct_h->h_maker_dt,chr_sys_access_stamp);
		l_mt_pty_depo_map_struct_i->i_maker_dt =0;
		strcpy(p_mt_pty_depo_map_struct_h->h_access_stamp,chr_sys_access_stamp);
		l_mt_pty_depo_map_struct_i->i_access_stamp =0;
		strcpy(p_mt_pty_depo_map_struct_h->h_checker,APL_NULL_STRING);
		strcpy(p_mt_pty_depo_map_struct_h->h_checker_dt,APL_NULL_STRING);

		EXEC SQL INSERT INTO MT_PTY_DEPO_MAP VALUES (:p_mt_pty_depo_map_struct_h:l_mt_pty_depo_map_struct_i);

		IS_ANY_ORA_ERROR_AND_DUPLICATE(ERR_PARTY_DEPOMAP_EXISTS,APL_NULL_STRING,APL_NULL_STRING,APL_NULL_STRING)

		/* Status Updation of Master Table */

		l_key_codes[0]="PTY_CODE";
		l_key_codes[1]=APL_NULL_STRING;

		l_key_values[0]=p_mt_pty_depo_map_struct_h->h_pty_code;
		l_key_values[1]=APL_NULL_STRING;

		strcpy(chr_l_table_name,"MT_PARTY");

		l_link_table_names[0]="MT_PTY_EXCH_MAP";
		l_link_table_names[1]="MT_PTY_DEPO_MAP";
		l_link_table_names[2]="MT_PTY_EXCH_CLN_MAP";
		l_link_table_names[3]=APL_NULL_STRING;
		
		int_retval = CR_Mod_UpdMastStatus(  l_key_codes,
														l_key_values,
														chr_l_table_name,
														l_link_table_names,
														APL_CHILD_IND,
														p_status,
														chr_sys_access_stamp,
														p_intl_env_data_struct_h,
														l_debug_info_ptr);
		APL_IF_DEBUG
		{
			printf("Returned Status Value = |%s|\n",p_status);
		}

		if (int_retval != APL_SUCCESS)
			APL_GOBACK_FAIL

				APL_GOBACK_SUCCESS

				IS_ANY_ORA_ERROR

	}

	else
	{
		l_key_codes[0]="PTY_CODE";
		l_key_codes[1]="DEPO_CODE";
		/*l_key_codes[2]="PTY_DEPO_MAP_CLIENT_ID";  -- Rahul */
		l_key_codes[2]="CMBP_ID";
		l_key_codes[3]=APL_NULL_STRING;

		l_key_values[0]=p_mt_pty_depo_map_struct_h->h_pty_code;
		l_key_values[1]=p_mt_pty_depo_map_struct_h->h_depo_code;
		/*l_key_values[2]=p_mt_pty_depo_map_struct_h->h_pty_depo_map_client_id; -- Rahul */
		l_key_values[2]=p_mt_pty_depo_map_struct_h->h_cmbp_id;
		l_key_values[3]=APL_NULL_STRING;

		strcpy(chr_l_table_name,"MT_PTY_DEPO_MAP");

		int_retval = CR_Rtv_MastChldChrVal( l_key_codes,
														l_key_values,
														chr_l_table_name,
														"ACCESS_STAMP",
														chr_l_field_val,
														l_debug_info_ptr);
		if(int_retval != APL_SUCCESS)
			APL_GOBACK_FAIL

		strcpy(chr_acc_stamp_compare,chr_l_field_val);

		int_retval = CR_Rtv_MastChldChrVal( l_key_codes,
														l_key_values,
														chr_l_table_name,
														"STATUS",
														chr_l_field_val,
														l_debug_info_ptr);

		if (int_retval != APL_SUCCESS)
			APL_GOBACK_FAIL

		strcpy(chr_status_compare,chr_l_field_val);
	}
	if (!strcmp(p_intl_env_data_struct_h->h_mode,APL_FUNC_MODIFY))
	{
		p_i_checker =0;
		p_i_checkerdt =0;

		strcpy(p_mt_pty_depo_map_struct_h->h_checker,APL_NULL_STRING);
		strcpy(p_mt_pty_depo_map_struct_h->h_checker_dt,APL_NULL_STRING);

		APL_IF_DEBUG
		{
			CO_ProcMonitor(APL_OUT_FILE, "Entered Modify h_mode of Function MT_ModDBPtyDepoMap\n",NULL,p_intl_env_data_struct_h);
		}
		if (!strcmp(p_mt_pty_depo_map_struct_h->h_access_stamp,chr_acc_stamp_compare))
		{
			strcpy(p_mt_pty_depo_map_struct_h->h_access_stamp,chr_sys_access_stamp);
			l_mt_pty_depo_map_struct_i->i_access_stamp =0;
			strcpy(p_mt_pty_depo_map_struct_h->h_status,STATUS_UAUTH);
			l_mt_pty_depo_map_struct_i->i_status =0;

			EXEC SQL UPDATE MT_PTY_DEPO_MAP SET
          PTY_DEPO_MAP_DP_ID=:p_mt_pty_depo_map_struct_h->h_pty_depo_map_dp_id:l_mt_pty_depo_map_struct_i->i_pty_depo_map_dp_id,
          EXCH_CODE=:p_mt_pty_depo_map_struct_h->h_exch_code:l_mt_pty_depo_map_struct_i->i_exch_code,
          CMBP_ID =:p_mt_pty_depo_map_struct_h->h_cmbp_id:l_mt_pty_depo_map_struct_i->i_cmbp_id,
				ACCESS_STAMP =:p_mt_pty_depo_map_struct_h->h_access_stamp:l_mt_pty_depo_map_struct_i->i_access_stamp,
				MAKER =:p_intl_env_data_struct_h->usr:p_i_maker,
				MAKER_DT =:chr_sys_access_stamp:p_i_makerdt,
				CHECKER =:p_mt_pty_depo_map_struct_h->h_checker:l_mt_pty_depo_map_struct_i->i_checker,
				CHECKER_DT =:p_mt_pty_depo_map_struct_h->h_checker_dt:l_mt_pty_depo_map_struct_i->i_checker_dt,
				STATUS =:p_mt_pty_depo_map_struct_h->h_status:l_mt_pty_depo_map_struct_i->i_status
					WHERE
					PTY_CODE =:p_mt_pty_depo_map_struct_h->h_pty_code AND
					DEPO_CODE =:p_mt_pty_depo_map_struct_h->h_depo_code AND
					CMBP_ID = :p_mt_pty_depo_map_struct_h->h_cmbp_id;
				/*	PTY_DEPO_MAP_CLIENT_ID =:p_mt_pty_depo_map_struct_h->h_pty_depo_map_client_id;  -- Rahul */

			/* Status Updation of Master Table */

			l_key_codes[0]="PTY_CODE";
			l_key_codes[1]=APL_NULL_STRING;

			l_key_values[0]=p_mt_pty_depo_map_struct_h->h_pty_code;
			l_key_values[1]=APL_NULL_STRING;

			strcpy(chr_l_table_name,"MT_PARTY");

			l_link_table_names[0]="MT_PTY_EXCH_MAP";
			l_link_table_names[1]="MT_PTY_DEPO_MAP";
   		l_link_table_names[2]="MT_PTY_EXCH_CLN_MAP";
			l_link_table_names[3]=APL_NULL_STRING;
			
			int_retval = CR_Mod_UpdMastStatus(  l_key_codes,
															l_key_values,
															chr_l_table_name,
															l_link_table_names,
															APL_CHILD_IND,
															p_status,
															chr_sys_access_stamp,
															p_intl_env_data_struct_h,
															l_debug_info_ptr);
			APL_IF_DEBUG
			{
				printf("Returned Status Value = |%s|\n",p_status);
			}

			if (int_retval != APL_SUCCESS)
				APL_GOBACK_FAIL

					APL_GOBACK_SUCCESS

					IS_ANY_ORA_ERROR

		}
		else if (CO_InsertErr(	l_debug_info_ptr,
										ERR_ACCESSSTAMP_CHGD,
										APL_NULL_STRING,
										APL_NULL_STRING,
										APL_NULL_STRING,
										__LINE__,
										__FILE__) != APL_SUCCESS)
			APL_GOBACK_FAIL
				int_error_flag = APL_FAILURE;
	}
	else if (!strcmp(p_intl_env_data_struct_h->h_mode,APL_FUNC_AUTHORISE))
	{
		APL_IF_DEBUG
		{
			CO_ProcMonitor(APL_OUT_FILE,"Entered Authorize h_mode of Function MT_DBPtyDepoMap\n",NULL,p_intl_env_data_struct_h);
		}
		if (!strcmp(p_mt_pty_depo_map_struct_h->h_access_stamp,chr_acc_stamp_compare))
		{
			if (strcmp(p_mt_pty_depo_map_struct_h->h_status,STATUS_DEL_UAUTH))
			{
				strcpy(p_mt_pty_depo_map_struct_h->h_access_stamp,chr_sys_access_stamp);
				l_mt_pty_depo_map_struct_i->i_access_stamp =0;
				strcpy(p_mt_pty_depo_map_struct_h->h_checker,p_intl_env_data_struct_h->usr);
				l_mt_pty_depo_map_struct_i->i_checker =0;
				strcpy(p_mt_pty_depo_map_struct_h->h_checker_dt,chr_sys_access_stamp);
				l_mt_pty_depo_map_struct_i->i_checker_dt =0;
				strcpy(p_mt_pty_depo_map_struct_h->h_status,STATUS_AUTH);
				l_mt_pty_depo_map_struct_i->i_status =0;

				EXEC SQL UPDATE MT_PTY_DEPO_MAP SET
					CHECKER =:p_intl_env_data_struct_h->usr:p_i_checker,
					CHECKER_DT =:chr_sys_access_stamp:p_i_checkerdt,
					ACCESS_STAMP =:chr_sys_access_stamp:p_i_access_stamp,
					STATUS =:p_mt_pty_depo_map_struct_h->h_status:l_mt_pty_depo_map_struct_i->i_status
						WHERE PTY_CODE =:p_mt_pty_depo_map_struct_h->h_pty_code AND
						DEPO_CODE =:p_mt_pty_depo_map_struct_h->h_depo_code AND
						CMBP_ID = :p_mt_pty_depo_map_struct_h->h_cmbp_id;
						/*PTY_DEPO_MAP_CLIENT_ID =:p_mt_pty_depo_map_struct_h->h_pty_depo_map_client_id;  -- Rahul */

				/* Status Updation of Master Table */

				l_key_codes[0]="PTY_CODE";
				l_key_codes[1]=APL_NULL_STRING;

				l_key_values[0]=p_mt_pty_depo_map_struct_h->h_pty_code;
				l_key_values[1]=APL_NULL_STRING;

				strcpy(chr_l_table_name,"MT_PARTY");

				l_link_table_names[0]="MT_PTY_EXCH_MAP";
				l_link_table_names[1]="MT_PTY_DEPO_MAP";
				l_link_table_names[2]="MT_PTY_EXCH_CLN_MAP";
				l_link_table_names[3]=APL_NULL_STRING;
				
				int_retval = CR_Mod_UpdMastStatus(  l_key_codes,
																l_key_values,
																chr_l_table_name,
																l_link_table_names,
																APL_CHILD_IND,
																p_status,
																chr_sys_access_stamp,
																p_intl_env_data_struct_h,
																l_debug_info_ptr);
				APL_IF_DEBUG
				{
					printf("Returned Status Value = |%s|\n",p_status);
				}

				if (int_retval != APL_SUCCESS)
					APL_GOBACK_FAIL

						
				/*Added by usman for CSGL API call - start*/
				printf("p_mt_pty_depo_map_struct_h->h_depo_code = |%s|\n",p_mt_pty_depo_map_struct_h->h_depo_code);
				if(!strcmp(p_mt_pty_depo_map_struct_h->h_depo_code,"CSGL"))
				{
		          CO_Chk_CntryEnabled("API_CONSUMER","MT_PARTY",&int_cond_exists,l_debug_info_ptr);
								
				  APL_IF_DEBUG
				 {
					printf("API cntry condition for MT_PARTY = |%d|\n",int_cond_exists);
				 }
				
				    if(int_cond_exists>0)	
					{
						
						EXEC SQL SELECT NVL(count(*),0) INTO :l_chr_cgsl 
						FROM MT_PARTY  WHERE PTY_CODE=:p_mt_pty_depo_map_struct_h->h_pty_code  AND CSGL_APL='Y';
						
						if(l_chr_cgsl>0){
							strcpy(keyvalue,"a.PTY_CODE=");
							strcat(keyvalue,p_mt_pty_depo_map_struct_h->h_pty_code);
							l_retval=callCSGLAPI(p_intl_env_data_struct_h->usr, "MT_PARTY_MOD", keyvalue);
								APL_IF_DEBUG
								{
									if(l_retval == 0)
									{
										CO_ProcMonitor(APL_OUT_FILE, "CSGL_API_call.ksh Executed Successfully for MT_DBPtyDepoMap\n",NULL,p_intl_env_data_struct_h);
									}
									else
									{
										CO_ProcMonitor(APL_OUT_FILE, "CSGL_API_call.ksh Executed UnSuccessfully for MT_DBPtyDepoMap\n",NULL,p_intl_env_data_struct_h);
									}
							}
						}
					}
				}
					/*Added by usman for CSGL API call - end*/
					
					APL_GOBACK_SUCCESS

					IS_ANY_ORA_ERROR

			}
			else
			{
				EXEC SQL DELETE MT_PTY_DEPO_MAP
					WHERE PTY_CODE =:p_mt_pty_depo_map_struct_h->h_pty_code AND
					DEPO_CODE =:p_mt_pty_depo_map_struct_h->h_depo_code AND
					CMBP_ID = :p_mt_pty_depo_map_struct_h->h_cmbp_id;
					/*PTY_DEPO_MAP_CLIENT_ID =:p_mt_pty_depo_map_struct_h->h_pty_depo_map_client_id; -- Rahul */

				/* Status Updation of Master Table */

				l_key_codes[0]="PTY_CODE";
				l_key_codes[1]=APL_NULL_STRING;

				l_key_values[0]=p_mt_pty_depo_map_struct_h->h_pty_code;
				l_key_values[1]=APL_NULL_STRING;

				strcpy(chr_l_table_name,"MT_PARTY");

				l_link_table_names[0]="MT_PTY_EXCH_MAP";
				l_link_table_names[1]="MT_PTY_DEPO_MAP";
				l_link_table_names[2]="MT_PTY_EXCH_CLN_MAP";
				l_link_table_names[3]=APL_NULL_STRING;

				int_retval = CR_Mod_UpdMastStatus(  l_key_codes,
						l_key_values,
						chr_l_table_name,
						l_link_table_names,
						APL_CHILD_IND,
						p_status,
						chr_sys_access_stamp,
						p_intl_env_data_struct_h,
						l_debug_info_ptr);
				APL_IF_DEBUG
				{
					printf("Returned Status Value = |%s|\n",p_status);
				}

				if (int_retval != APL_SUCCESS)
					APL_GOBACK_FAIL

						APL_GOBACK_SUCCESS

						IS_ANY_ORA_ERROR
			}
		}
		else if (CO_InsertErr(  l_debug_info_ptr,
										ERR_ACCESSSTAMP_CHGD,
										APL_NULL_STRING,
										APL_NULL_STRING,
										APL_NULL_STRING,
										__LINE__,
										__FILE__) != APL_SUCCESS)
			APL_GOBACK_FAIL
			int_error_flag = APL_FAILURE;
	}

	else if (!strcmp(p_intl_env_data_struct_h->h_mode,APL_FUNC_RESET))
	{
		APL_IF_DEBUG
		{
			CO_ProcMonitor(APL_OUT_FILE,"Entered reset h_mode of MT_ModDBPtyDepoMap\n",NULL,p_intl_env_data_struct_h);
		}
		if (!strcmp(p_mt_pty_depo_map_struct_h->h_access_stamp,chr_acc_stamp_compare))
		{
			if (!strcmp(p_mt_pty_depo_map_struct_h->h_status,STATUS_DEL_UAUTH))
			{
				strcpy(p_mt_pty_depo_map_struct_h->h_access_stamp,chr_sys_access_stamp);
				l_mt_pty_depo_map_struct_i->i_access_stamp =0;
				strcpy(p_mt_pty_depo_map_struct_h->h_checker,p_intl_env_data_struct_h->usr);
				l_mt_pty_depo_map_struct_i->i_checker =0;
				strcpy(p_mt_pty_depo_map_struct_h->h_checker_dt,chr_sys_access_stamp);
				l_mt_pty_depo_map_struct_i->i_checker_dt =0;
				strcpy(p_mt_pty_depo_map_struct_h->h_status,STATUS_AUTH);
				l_mt_pty_depo_map_struct_i->i_status =0;

				EXEC SQL UPDATE MT_PTY_DEPO_MAP SET
					CHECKER =:p_intl_env_data_struct_h->usr:p_i_checker,
					CHECKER_DT =:chr_sys_access_stamp:p_i_checkerdt,
					ACCESS_STAMP =:chr_sys_access_stamp:p_i_access_stamp,
					STATUS =:p_mt_pty_depo_map_struct_h->h_status:l_mt_pty_depo_map_struct_i->i_status
						WHERE
						PTY_CODE =:p_mt_pty_depo_map_struct_h->h_pty_code AND
						DEPO_CODE =:p_mt_pty_depo_map_struct_h->h_depo_code AND
						CMBP_ID = :p_mt_pty_depo_map_struct_h->h_cmbp_id;
						/*PTY_DEPO_MAP_CLIENT_ID =:p_mt_pty_depo_map_struct_h->h_pty_depo_map_client_id; -- Rahul */

				/* Status Updation of Master Table */

				l_key_codes[0]="PTY_CODE";
				l_key_codes[1]=APL_NULL_STRING;

				l_key_values[0]=p_mt_pty_depo_map_struct_h->h_pty_code;
				l_key_values[1]=APL_NULL_STRING;

				strcpy(chr_l_table_name,"MT_PARTY");

				l_link_table_names[0]="MT_PTY_EXCH_MAP";
				l_link_table_names[1]="MT_PTY_DEPO_MAP";
				l_link_table_names[2]="MT_PTY_EXCH_CLN_MAP";
				l_link_table_names[3]=APL_NULL_STRING;
				
				int_retval = CR_Mod_UpdMastStatus(  l_key_codes,
																l_key_values,
																chr_l_table_name,
																l_link_table_names,
																APL_CHILD_IND,
																p_status,
																chr_sys_access_stamp,
																p_intl_env_data_struct_h,
																l_debug_info_ptr);
				APL_IF_DEBUG
				{
					printf("Returned Status Value = |%s|\n",p_status);
				}

				if (int_retval != APL_SUCCESS)
					APL_GOBACK_FAIL

						APL_GOBACK_SUCCESS

						IS_ANY_ORA_ERROR
			}
			else 
			{
				if (CO_InsertErr(	l_debug_info_ptr,
										ERR_CANT_RESET,
										APL_NULL_STRING,
										APL_NULL_STRING,
										APL_NULL_STRING,
										__LINE__,
										__FILE__) != APL_SUCCESS)
					APL_GOBACK_FAIL
					int_error_flag = APL_FAILURE;
			}
		}
		else if (CO_InsertErr(  l_debug_info_ptr,
										ERR_ACCESSSTAMP_CHGD,
										APL_NULL_STRING,
										APL_NULL_STRING,
										APL_NULL_STRING,
										__LINE__,
										__FILE__) != APL_SUCCESS)
			APL_GOBACK_FAIL
			int_error_flag = APL_FAILURE;
	}
	else if (!strcmp(p_intl_env_data_struct_h->h_mode,APL_FUNC_DELETE))
	{
		p_i_checker =-1;
		p_i_checkerdt =-1;

		strcpy(p_mt_pty_depo_map_struct_h->h_checker,APL_NULL_STRING);
		strcpy(p_mt_pty_depo_map_struct_h->h_checker_dt,APL_NULL_STRING);

		APL_IF_DEBUG
		{
			CO_ProcMonitor(APL_OUT_FILE,"Entered delete h_mode of MT_ModDBPtyDepoMap\n",NULL,p_intl_env_data_struct_h);
		}
		if (!strcmp(p_mt_pty_depo_map_struct_h->h_access_stamp,chr_acc_stamp_compare))
		{
			strcpy(p_mt_pty_depo_map_struct_h->h_access_stamp,chr_sys_access_stamp);
			l_mt_pty_depo_map_struct_i->i_access_stamp =0;
			strcpy(p_mt_pty_depo_map_struct_h->h_status,STATUS_DEL_UAUTH);
			l_mt_pty_depo_map_struct_i->i_status =0;

			EXEC SQL UPDATE MT_PTY_DEPO_MAP SET
				MAKER =:p_intl_env_data_struct_h->usr:p_i_maker,
				MAKER_DT =:chr_sys_access_stamp:p_i_makerdt,
				CHECKER =:p_mt_pty_depo_map_struct_h->h_checker:l_mt_pty_depo_map_struct_i->i_checker,
				CHECKER_DT =:p_mt_pty_depo_map_struct_h->h_checker_dt:l_mt_pty_depo_map_struct_i->i_checker_dt,
				ACCESS_STAMP =:p_mt_pty_depo_map_struct_h->h_access_stamp:p_i_access_stamp,
				STATUS =:p_mt_pty_depo_map_struct_h->h_status:l_mt_pty_depo_map_struct_i->i_status
					WHERE PTY_CODE =:p_mt_pty_depo_map_struct_h->h_pty_code AND
							DEPO_CODE =:p_mt_pty_depo_map_struct_h->h_depo_code AND
							CMBP_ID = :p_mt_pty_depo_map_struct_h->h_cmbp_id;
							/*PTY_DEPO_MAP_CLIENT_ID =:p_mt_pty_depo_map_struct_h->h_pty_depo_map_client_id; -- Rahul */

			/* Status Updation of Master Table */

			l_key_codes[0]="PTY_CODE";
			l_key_codes[1]=APL_NULL_STRING;

			l_key_values[0]=p_mt_pty_depo_map_struct_h->h_pty_code;
			l_key_values[1]=APL_NULL_STRING;

			strcpy(chr_l_table_name,"MT_PARTY");

			l_link_table_names[0]="MT_PTY_EXCH_MAP";
			l_link_table_names[1]="MT_PTY_DEPO_MAP";
			l_link_table_names[2]="MT_PTY_EXCH_CLN_MAP";
			l_link_table_names[3]=APL_NULL_STRING;
			
			int_retval = CR_Mod_UpdMastStatus(  l_key_codes,
															l_key_values,
															chr_l_table_name,
															l_link_table_names,
															APL_CHILD_IND,
															p_status,
															chr_sys_access_stamp,
															p_intl_env_data_struct_h,
															l_debug_info_ptr);
			APL_IF_DEBUG
			{
				printf("Returned Status Value = |%s|\n",p_status);
			}

			if (int_retval != APL_SUCCESS)
				APL_GOBACK_FAIL

					APL_GOBACK_SUCCESS

					IS_ANY_ORA_ERROR
		}
		else if (CO_InsertErr(  l_debug_info_ptr,
										ERR_ACCESSSTAMP_CHGD,
										APL_NULL_STRING,
										APL_NULL_STRING,
										APL_NULL_STRING,
										__LINE__,
										__FILE__) != APL_SUCCESS)
			APL_GOBACK_FAIL
				int_error_flag = APL_FAILURE;
	}
	if (int_error_flag == APL_FAILURE)
	{
		APL_GOBACK_FAIL
	}
	APL_GOBACK_SUCCESS

	RETURN_SUCCESS:
	{
		APL_FUNCTION_RET_SUCCESS(APL_OUT_FILE)
		APL_FREE(l_mt_pty_depo_map_struct_i)
		return(APL_SUCCESS);
	}
	RETURN_FAILURE:
	{
		APL_FUNCTION_RET_FAILURE(APL_OUT_FILE)
		APL_FREE(l_mt_pty_depo_map_struct_i)
		return(APL_FAILURE);
	}
}


int MT_ModDBPtyExchClnMap(	MT_PTY_EXCH_CLN_MAP_STRUCT_H	*p_mt_pty_exch_cln_map_struct_h,
									INTL_ENV_DATA_STRUCT_H			*p_intl_env_data_struct_h,
									DEBUG_INFO_STRUCT_H				**l_debug_info_ptr)
{
	/* Variable Decleration */
	MT_PTY_EXCH_CLN_MAP_STRUCT_I   *l_mt_pty_exch_cln_map_struct_i;

	struct sqlca sqlca;

	char chr_acc_stamp_compare[APL_DATE_LEN] = APL_NULL_STRING;
	char chr_status_compare[APL_STATUS_LEN] = APL_NULL_STRING;
	char chr_sys_access_stamp[APL_DATE_LEN] = APL_NULL_STRING;
	short p_i_maker, p_i_makerdt, p_i_checker, p_i_checkerdt, p_i_access_stamp;
	short p_i_access_stamp_compare;
	short p_i_status = 0;
	int int_error_flag = APL_SUCCESS;
	int int_l_rowexists = 0;
	char  *l_key_codes[5];
	char  *l_key_values[5];
	char  chr_l_table_name[50] = APL_NULL_STRING;
	char  *l_link_table_names[5];
	char  chr_l_field_val[40] = APL_NULL_STRING;
	char  p_status[APL_STATUS_LEN];

	int   int_retval = APL_SUCCESS;
#ifdef APL_THREADS
	APL_SET_CONTEXT
		EXEC SQL CONTEXT USE :my_ctx_local;
#endif

	/* Debug Statements */
	APL_FUNCTION_ENTER(APL_OUT_FILE)

		l_mt_pty_exch_cln_map_struct_i = (MT_PTY_EXCH_CLN_MAP_STRUCT_I *)calloc(1,sizeof(MT_PTY_EXCH_CLN_MAP_STRUCT_I));
	APL_MALLOC_FAIL(l_mt_pty_exch_cln_map_struct_i);

	p_i_maker =0;
	p_i_makerdt =0;
	p_i_checker =0;
	p_i_checkerdt =0;
	p_i_access_stamp =0;
	p_i_access_stamp_compare =0;

	if (!strlen(p_mt_pty_exch_cln_map_struct_h->h_pty_code))  l_mt_pty_exch_cln_map_struct_i->i_pty_code = -1;
	l_mt_pty_exch_cln_map_struct_i->i_pty_code = 0;
	if (!strlen(p_mt_pty_exch_cln_map_struct_h->h_exch_code)) l_mt_pty_exch_cln_map_struct_i->i_exch_code = -1;
	l_mt_pty_exch_cln_map_struct_i->i_exch_code = 0;
	if (!strlen(p_mt_pty_exch_cln_map_struct_h->h_cln_code))  l_mt_pty_exch_cln_map_struct_i->i_cln_code = -1;
	l_mt_pty_exch_cln_map_struct_i->i_cln_code = 0;
	if (!strlen(p_mt_pty_exch_cln_map_struct_h->h_pty_exch_cln_map_code)) l_mt_pty_exch_cln_map_struct_i->i_pty_exch_cln_map_code = -1;
	l_mt_pty_exch_cln_map_struct_i->i_pty_exch_cln_map_code = 0;
	if (!strlen(p_mt_pty_exch_cln_map_struct_h->h_maker))  l_mt_pty_exch_cln_map_struct_i->i_maker = -1;
	l_mt_pty_exch_cln_map_struct_i->i_maker = 0;
	if (!strlen(p_mt_pty_exch_cln_map_struct_h->h_maker_dt))  l_mt_pty_exch_cln_map_struct_i->i_maker_dt = -1;
	l_mt_pty_exch_cln_map_struct_i->i_maker_dt = 0;
	if (!strlen(p_mt_pty_exch_cln_map_struct_h->h_access_stamp)) l_mt_pty_exch_cln_map_struct_i->i_access_stamp = -1;
	l_mt_pty_exch_cln_map_struct_i->i_access_stamp = 0;
	if (!strlen(p_mt_pty_exch_cln_map_struct_h->h_status)) l_mt_pty_exch_cln_map_struct_i->i_status = -1;
	l_mt_pty_exch_cln_map_struct_i->i_status = 0;

	if(CO_RtvSysDtTime(chr_sys_access_stamp,l_debug_info_ptr) !=APL_SUCCESS)
	{
		APL_GOBACK_FAIL
	}

	if (!strcmp(p_intl_env_data_struct_h->h_mode,APL_FUNC_INPUT))
	{
		APL_IF_DEBUG
		{
			CO_ProcMonitor(APL_OUT_FILE, "Entered Input h_mode of Function MT_ModDBPtyExchClnMap\n",NULL,p_intl_env_data_struct_h);
		}
		strcpy(p_mt_pty_exch_cln_map_struct_h->h_status,STATUS_UAUTH);
		l_mt_pty_exch_cln_map_struct_i->i_status =0;
		strcpy(p_mt_pty_exch_cln_map_struct_h->h_maker,p_intl_env_data_struct_h->usr);
		l_mt_pty_exch_cln_map_struct_i->i_maker =0;
		strcpy(p_mt_pty_exch_cln_map_struct_h->h_maker_dt,chr_sys_access_stamp);
		l_mt_pty_exch_cln_map_struct_i->i_maker_dt =0;
		strcpy(p_mt_pty_exch_cln_map_struct_h->h_access_stamp,chr_sys_access_stamp);
		l_mt_pty_exch_cln_map_struct_i->i_access_stamp =0;
		strcpy(p_mt_pty_exch_cln_map_struct_h->h_checker,APL_NULL_STRING);
		strcpy(p_mt_pty_exch_cln_map_struct_h->h_checker_dt,APL_NULL_STRING);

		EXEC SQL INSERT INTO MT_PTY_EXCH_CLN_MAP VALUES (:p_mt_pty_exch_cln_map_struct_h:l_mt_pty_exch_cln_map_struct_i);

		IS_ANY_ORA_ERROR_AND_DUPLICATE(ERR_PARTY_EXCHCLNMAP_EXISTS,APL_NULL_STRING,APL_NULL_STRING,APL_NULL_STRING)

		/* Status Updation of Master Table */

		l_key_codes[0]="PTY_CODE";
		l_key_codes[1]=APL_NULL_STRING;

		l_key_values[0]=p_mt_pty_exch_cln_map_struct_h->h_pty_code;
		l_key_values[1]=APL_NULL_STRING;

		strcpy(chr_l_table_name,"MT_PARTY");

		l_link_table_names[0]="MT_PTY_EXCH_MAP";
		l_link_table_names[1]="MT_PTY_DEPO_MAP";
		l_link_table_names[2]="MT_PTY_EXCH_CLN_MAP";
		l_link_table_names[3]=APL_NULL_STRING;
		
		int_retval = CR_Mod_UpdMastStatus(  l_key_codes,
														l_key_values,
														chr_l_table_name,
														l_link_table_names,
														APL_CHILD_IND,
														p_status,
														chr_sys_access_stamp,
														p_intl_env_data_struct_h,
														l_debug_info_ptr);
		APL_IF_DEBUG
		{
			printf("Returned Status Value = |%s|\n",p_status);
		}

		if (int_retval != APL_SUCCESS)
			APL_GOBACK_FAIL

				APL_GOBACK_SUCCESS

				IS_ANY_ORA_ERROR
	}
	else
	{
		l_key_codes[0]="PTY_CODE";
		l_key_codes[1]="EXCH_CODE";
		l_key_codes[2]="CLN_CODE";
		l_key_codes[3]="PTY_EXCH_CLN_MAP_CODE";
		l_key_codes[4]=APL_NULL_STRING;

		l_key_values[0]=p_mt_pty_exch_cln_map_struct_h->h_pty_code;
		l_key_values[1]=p_mt_pty_exch_cln_map_struct_h->h_exch_code;
		l_key_values[2]=p_mt_pty_exch_cln_map_struct_h->h_cln_code;
		l_key_values[3]=p_mt_pty_exch_cln_map_struct_h->h_pty_exch_cln_map_code;
		l_key_values[4]=APL_NULL_STRING;

		strcpy(chr_l_table_name,"MT_PTY_EXCH_CLN_MAP");

		int_retval = CR_Rtv_MastChldChrVal( l_key_codes,
														l_key_values,
														chr_l_table_name,
														"ACCESS_STAMP",
														chr_l_field_val,
														l_debug_info_ptr);
		if(int_retval != APL_SUCCESS)
			APL_GOBACK_FAIL

		strcpy(chr_acc_stamp_compare,chr_l_field_val);

		int_retval = CR_Rtv_MastChldChrVal( l_key_codes,
														l_key_values,
														chr_l_table_name,
														"STATUS",
														chr_l_field_val,
														l_debug_info_ptr);

		if (int_retval != APL_SUCCESS)
			APL_GOBACK_FAIL

		strcpy(chr_status_compare,chr_l_field_val);
	}
	if (!strcmp(p_intl_env_data_struct_h->h_mode,APL_FUNC_MODIFY))
	{
		p_i_checker =0;
		p_i_checkerdt =0;

		strcpy(p_mt_pty_exch_cln_map_struct_h->h_checker,APL_NULL_STRING);
		strcpy(p_mt_pty_exch_cln_map_struct_h->h_checker_dt,APL_NULL_STRING);

		APL_IF_DEBUG
		{
			CO_ProcMonitor(APL_OUT_FILE, "Entered Modify h_mode of Function MT_ModDBPtyExchClnMap\n",NULL,p_intl_env_data_struct_h);
		}
		if (!strcmp(p_mt_pty_exch_cln_map_struct_h->h_access_stamp,chr_acc_stamp_compare))
		{
			strcpy(p_mt_pty_exch_cln_map_struct_h->h_access_stamp,chr_sys_access_stamp);
			l_mt_pty_exch_cln_map_struct_i->i_access_stamp =0;
			strcpy(p_mt_pty_exch_cln_map_struct_h->h_status,STATUS_UAUTH);
			l_mt_pty_exch_cln_map_struct_i->i_status =0;

			EXEC SQL UPDATE MT_PTY_EXCH_CLN_MAP SET
				ACCESS_STAMP =:p_mt_pty_exch_cln_map_struct_h->h_access_stamp:l_mt_pty_exch_cln_map_struct_i->i_access_stamp,
				MAKER =:p_intl_env_data_struct_h->usr:p_i_maker,
				MAKER_DT =:chr_sys_access_stamp:p_i_makerdt,
				CHECKER =:p_mt_pty_exch_cln_map_struct_h->h_checker:l_mt_pty_exch_cln_map_struct_i->i_checker,
				CHECKER_DT =:p_mt_pty_exch_cln_map_struct_h->h_checker_dt:l_mt_pty_exch_cln_map_struct_i->i_checker_dt,
				STATUS =:p_mt_pty_exch_cln_map_struct_h->h_status:l_mt_pty_exch_cln_map_struct_i->i_status
					WHERE
					PTY_CODE =:p_mt_pty_exch_cln_map_struct_h->h_pty_code AND
					EXCH_CODE =:p_mt_pty_exch_cln_map_struct_h->h_exch_code AND
					CLN_CODE =:p_mt_pty_exch_cln_map_struct_h->h_cln_code AND
					PTY_EXCH_CLN_MAP_CODE =:p_mt_pty_exch_cln_map_struct_h->h_pty_exch_cln_map_code;

			/* Status Updation of Master Table */

			l_key_codes[0]="PTY_CODE";
			l_key_codes[1]=APL_NULL_STRING;

			l_key_values[0]=p_mt_pty_exch_cln_map_struct_h->h_pty_code;
			l_key_values[1]=APL_NULL_STRING;

			strcpy(chr_l_table_name,"MT_PARTY");

			l_link_table_names[0]="MT_PTY_EXCH_MAP";
			l_link_table_names[1]="MT_PTY_DEPO_MAP";
			l_link_table_names[2]="MT_PTY_EXCH_CLN_MAP";
			l_link_table_names[3]=APL_NULL_STRING;
			
			int_retval = CR_Mod_UpdMastStatus(  l_key_codes,
															l_key_values,
															chr_l_table_name,
															l_link_table_names,
															APL_CHILD_IND,
															p_status,
															chr_sys_access_stamp,
															p_intl_env_data_struct_h,
															l_debug_info_ptr);
			APL_IF_DEBUG
			{
				printf("Returned Status Value = |%s|\n",p_status);
			}

			if (int_retval != APL_SUCCESS)
				APL_GOBACK_FAIL

					APL_GOBACK_SUCCESS

					IS_ANY_ORA_ERROR
		}
		else if (CO_InsertErr(  l_debug_info_ptr,
										ERR_ACCESSSTAMP_CHGD,
										APL_NULL_STRING,
										APL_NULL_STRING,
										APL_NULL_STRING,
										__LINE__,
										__FILE__) != APL_SUCCESS)
			APL_GOBACK_FAIL
				int_error_flag = APL_FAILURE;
	}
	
	else if (!strcmp(p_intl_env_data_struct_h->h_mode,APL_FUNC_AUTHORISE))
	{
		APL_IF_DEBUG
		{
			CO_ProcMonitor(APL_OUT_FILE,"Entered Authorize h_mode of Function MT_DBPtyExchClnMap\n",NULL,p_intl_env_data_struct_h);
		}
		if (!strcmp(p_mt_pty_exch_cln_map_struct_h->h_access_stamp,chr_acc_stamp_compare))
		{
			if (strcmp(p_mt_pty_exch_cln_map_struct_h->h_status,STATUS_DEL_UAUTH))
			{
				strcpy(p_mt_pty_exch_cln_map_struct_h->h_access_stamp,chr_sys_access_stamp);
				l_mt_pty_exch_cln_map_struct_i->i_access_stamp =0;
				strcpy(p_mt_pty_exch_cln_map_struct_h->h_checker,p_intl_env_data_struct_h->usr);
				l_mt_pty_exch_cln_map_struct_i->i_checker =0;
				strcpy(p_mt_pty_exch_cln_map_struct_h->h_checker_dt,chr_sys_access_stamp);
				l_mt_pty_exch_cln_map_struct_i->i_checker_dt =0;
				strcpy(p_mt_pty_exch_cln_map_struct_h->h_status,STATUS_AUTH);
				l_mt_pty_exch_cln_map_struct_i->i_status =0;

				EXEC SQL UPDATE MT_PTY_EXCH_CLN_MAP SET
					CHECKER =:p_intl_env_data_struct_h->usr:p_i_checker,
							  CHECKER_DT =:chr_sys_access_stamp:p_i_checkerdt,
							  ACCESS_STAMP =:chr_sys_access_stamp:p_i_access_stamp,
							  STATUS =:p_mt_pty_exch_cln_map_struct_h->h_status:l_mt_pty_exch_cln_map_struct_i->i_status
								  WHERE PTY_CODE =:p_mt_pty_exch_cln_map_struct_h->h_pty_code AND
								  EXCH_CODE =:p_mt_pty_exch_cln_map_struct_h->h_exch_code AND
								  CLN_CODE =:p_mt_pty_exch_cln_map_struct_h->h_cln_code AND
								  PTY_EXCH_CLN_MAP_CODE =:p_mt_pty_exch_cln_map_struct_h->h_pty_exch_cln_map_code;

				/* Status Updation of Master Table */

				l_key_codes[0]="PTY_CODE";
				l_key_codes[1]=APL_NULL_STRING;

				l_key_values[0]=p_mt_pty_exch_cln_map_struct_h->h_pty_code;
				l_key_values[1]=APL_NULL_STRING;

				strcpy(chr_l_table_name,"MT_PARTY");

				l_link_table_names[0]="MT_PTY_EXCH_MAP";
				l_link_table_names[1]="MT_PTY_DEPO_MAP";
				l_link_table_names[2]="MT_PTY_EXCH_CLN_MAP";
				l_link_table_names[3]=APL_NULL_STRING;
				
				int_retval = CR_Mod_UpdMastStatus(  l_key_codes,
																l_key_values,
																chr_l_table_name,
																l_link_table_names,
																APL_CHILD_IND,
																p_status,
																chr_sys_access_stamp,
																p_intl_env_data_struct_h,
																l_debug_info_ptr);
				APL_IF_DEBUG
				{
					printf("Returned Status Value = |%s|\n",p_status);
				}

				if (int_retval != APL_SUCCESS)
					APL_GOBACK_FAIL

						APL_GOBACK_SUCCESS

						IS_ANY_ORA_ERROR
			}
			else
			{
				EXEC SQL DELETE MT_PTY_EXCH_CLN_MAP
					WHERE PTY_CODE =:p_mt_pty_exch_cln_map_struct_h->h_pty_code AND
					EXCH_CODE =:p_mt_pty_exch_cln_map_struct_h->h_exch_code AND
					CLN_CODE =:p_mt_pty_exch_cln_map_struct_h->h_cln_code AND
					PTY_EXCH_CLN_MAP_CODE =:p_mt_pty_exch_cln_map_struct_h->h_pty_exch_cln_map_code;

				/* Status Updation of Master Table */

				l_key_codes[0]="PTY_CODE";
				l_key_codes[1]=APL_NULL_STRING;

				l_key_values[0]=p_mt_pty_exch_cln_map_struct_h->h_pty_code;
				l_key_values[1]=APL_NULL_STRING;

				strcpy(chr_l_table_name,"MT_PARTY");

				l_link_table_names[0]="MT_PTY_EXCH_MAP";
				l_link_table_names[1]="MT_PTY_DEPO_MAP";
				l_link_table_names[2]="MT_PTY_EXCH_CLN_MAP";
				l_link_table_names[3]=APL_NULL_STRING;

				int_retval = CR_Mod_UpdMastStatus(  l_key_codes,
						l_key_values,
						chr_l_table_name,
						l_link_table_names,
						APL_CHILD_IND,
						p_status,
						chr_sys_access_stamp,
						p_intl_env_data_struct_h,
						l_debug_info_ptr);
				APL_IF_DEBUG
				{
					printf("Returned Status Value = |%s|\n",p_status);
				}

				if (int_retval != APL_SUCCESS)
					APL_GOBACK_FAIL

						APL_GOBACK_SUCCESS

						IS_ANY_ORA_ERROR
			}
		}
		else if (CO_InsertErr(  l_debug_info_ptr,
										ERR_ACCESSSTAMP_CHGD,
										APL_NULL_STRING,
										APL_NULL_STRING,
										APL_NULL_STRING,
										__LINE__,
										__FILE__) != APL_SUCCESS)
			APL_GOBACK_FAIL
				int_error_flag = APL_FAILURE;
	}

	else if (!strcmp(p_intl_env_data_struct_h->h_mode,APL_FUNC_RESET))
	{
		APL_IF_DEBUG
		{
			CO_ProcMonitor(APL_OUT_FILE,"Entered reset h_mode of MT_ModDBPtyExchClnMap\n",NULL,p_intl_env_data_struct_h);
		}
		if (!strcmp(p_mt_pty_exch_cln_map_struct_h->h_access_stamp,chr_acc_stamp_compare))
		{
			if (!strcmp(p_mt_pty_exch_cln_map_struct_h->h_status,STATUS_DEL_UAUTH))
			{
				strcpy(p_mt_pty_exch_cln_map_struct_h->h_access_stamp,chr_sys_access_stamp);
				l_mt_pty_exch_cln_map_struct_i->i_access_stamp =0;
				strcpy(p_mt_pty_exch_cln_map_struct_h->h_checker,p_intl_env_data_struct_h->usr);
				l_mt_pty_exch_cln_map_struct_i->i_checker =0;
				strcpy(p_mt_pty_exch_cln_map_struct_h->h_checker_dt,chr_sys_access_stamp);
				l_mt_pty_exch_cln_map_struct_i->i_checker_dt =0;
				strcpy(p_mt_pty_exch_cln_map_struct_h->h_status,STATUS_AUTH);
				l_mt_pty_exch_cln_map_struct_i->i_status =0;

				EXEC SQL UPDATE MT_PTY_EXCH_CLN_MAP SET
					CHECKER =:p_intl_env_data_struct_h->usr:p_i_checker,
					CHECKER_DT =:chr_sys_access_stamp:p_i_checkerdt,
					ACCESS_STAMP =:chr_sys_access_stamp:p_i_access_stamp,
					STATUS =:p_mt_pty_exch_cln_map_struct_h->h_status:l_mt_pty_exch_cln_map_struct_i->i_status
						WHERE PTY_CODE =:p_mt_pty_exch_cln_map_struct_h->h_pty_code AND
								EXCH_CODE =:p_mt_pty_exch_cln_map_struct_h->h_exch_code AND
								CLN_CODE =:p_mt_pty_exch_cln_map_struct_h->h_cln_code AND
								PTY_EXCH_CLN_MAP_CODE =:p_mt_pty_exch_cln_map_struct_h->h_pty_exch_cln_map_code;

				/* Status Updation of Master Table */

				l_key_codes[0]="PTY_CODE";
				l_key_codes[1]=APL_NULL_STRING;

				l_key_values[0]=p_mt_pty_exch_cln_map_struct_h->h_pty_code;
				l_key_values[1]=APL_NULL_STRING;

				strcpy(chr_l_table_name,"MT_PARTY");

				l_link_table_names[0]="MT_PTY_EXCH_MAP";
				l_link_table_names[1]="MT_PTY_DEPO_MAP";
				l_link_table_names[2]="MT_PTY_EXCH_CLN_MAP";
				l_link_table_names[3]=APL_NULL_STRING;
				
				int_retval = CR_Mod_UpdMastStatus(  l_key_codes,
																l_key_values,
																chr_l_table_name,
																l_link_table_names,
																APL_CHILD_IND,
																p_status,
																chr_sys_access_stamp,
																p_intl_env_data_struct_h,
																l_debug_info_ptr);
				APL_IF_DEBUG
				{
					printf("Returned Status Value = |%s|\n",p_status);
				}

				if (int_retval != APL_SUCCESS)
					APL_GOBACK_FAIL

						APL_GOBACK_SUCCESS

						IS_ANY_ORA_ERROR
			}
			else
			{
				if (CO_InsertErr( l_debug_info_ptr,
										ERR_CANT_RESET,
										APL_NULL_STRING,
										APL_NULL_STRING,
										APL_NULL_STRING,
										__LINE__,
										__FILE__) != APL_SUCCESS)
					APL_GOBACK_FAIL
						int_error_flag = APL_FAILURE;
			}
		}
		else if (CO_InsertErr(  l_debug_info_ptr,
										ERR_ACCESSSTAMP_CHGD,
										APL_NULL_STRING,
										APL_NULL_STRING,
										APL_NULL_STRING,
										__LINE__,
										__FILE__) != APL_SUCCESS)
			APL_GOBACK_FAIL
				int_error_flag = APL_FAILURE;
	}

	else if (!strcmp(p_intl_env_data_struct_h->h_mode,APL_FUNC_DELETE))
	{
		p_i_checker =-1;
		p_i_checkerdt =-1;

		strcpy(p_mt_pty_exch_cln_map_struct_h->h_checker,APL_NULL_STRING);
		strcpy(p_mt_pty_exch_cln_map_struct_h->h_checker_dt,APL_NULL_STRING);

		APL_IF_DEBUG
		{
			CO_ProcMonitor(APL_OUT_FILE,"Entered delete h_mode of MT_ModDBPtyExchiClnMap\n",NULL,p_intl_env_data_struct_h);
		}
		if (!strcmp(p_mt_pty_exch_cln_map_struct_h->h_access_stamp,chr_acc_stamp_compare))
		{
			strcpy(p_mt_pty_exch_cln_map_struct_h->h_access_stamp,chr_sys_access_stamp);
			l_mt_pty_exch_cln_map_struct_i->i_access_stamp =0;
			strcpy(p_mt_pty_exch_cln_map_struct_h->h_status,STATUS_DEL_UAUTH);
			l_mt_pty_exch_cln_map_struct_i->i_status =0;

			EXEC SQL UPDATE MT_PTY_EXCH_CLN_MAP SET
				MAKER =:p_intl_env_data_struct_h->usr:p_i_maker,
				MAKER_DT =:chr_sys_access_stamp:p_i_makerdt,
				CHECKER =:p_mt_pty_exch_cln_map_struct_h->h_checker:l_mt_pty_exch_cln_map_struct_i->i_checker,
				CHECKER_DT =:p_mt_pty_exch_cln_map_struct_h->h_checker_dt:l_mt_pty_exch_cln_map_struct_i->i_checker_dt,
				ACCESS_STAMP =:p_mt_pty_exch_cln_map_struct_h->h_access_stamp:p_i_access_stamp,
				STATUS =:p_mt_pty_exch_cln_map_struct_h->h_status:l_mt_pty_exch_cln_map_struct_i->i_status
					WHERE PTY_CODE =:p_mt_pty_exch_cln_map_struct_h->h_pty_code AND
							EXCH_CODE =:p_mt_pty_exch_cln_map_struct_h->h_exch_code AND
							CLN_CODE =:p_mt_pty_exch_cln_map_struct_h->h_cln_code AND
							PTY_EXCH_CLN_MAP_CODE =:p_mt_pty_exch_cln_map_struct_h->h_pty_exch_cln_map_code;

			/* Status Updation of Master Table */

			l_key_codes[0]="PTY_CODE";
			l_key_codes[1]=APL_NULL_STRING;

			l_key_values[0]=p_mt_pty_exch_cln_map_struct_h->h_pty_code;
			l_key_values[1]=APL_NULL_STRING;

			strcpy(chr_l_table_name,"MT_PARTY");

			l_link_table_names[0]="MT_PTY_EXCH_MAP";
			l_link_table_names[1]="MT_PTY_DEPO_MAP";
			l_link_table_names[2]="MT_PTY_EXCH_CLN_MAP";
			l_link_table_names[3]=APL_NULL_STRING;
			
			int_retval = CR_Mod_UpdMastStatus(  l_key_codes,
															l_key_values,
															chr_l_table_name,
															l_link_table_names,
															APL_CHILD_IND,
															p_status,
															chr_sys_access_stamp,
															p_intl_env_data_struct_h,
															l_debug_info_ptr);
			APL_IF_DEBUG
			{
				printf("Returned Status Value = |%s|\n",p_status);
			}

			if (int_retval != APL_SUCCESS)
				APL_GOBACK_FAIL

					APL_GOBACK_SUCCESS

					//IS_ANY_ORA_ERROR commented for AIX Migration changes
		}
		else if (CO_InsertErr(  l_debug_info_ptr,
										ERR_ACCESSSTAMP_CHGD,
										APL_NULL_STRING,
										APL_NULL_STRING,
										APL_NULL_STRING,
										__LINE__,
										__FILE__) != APL_SUCCESS)
			APL_GOBACK_FAIL
				int_error_flag = APL_FAILURE;
	}
	if (int_error_flag == APL_FAILURE)
	{
		APL_GOBACK_FAIL
	}
	APL_GOBACK_SUCCESS

	RETURN_SUCCESS:
	{
                     //AIX - Warnings Removal
			APL_FREE(l_mt_pty_exch_cln_map_struct_i)
		APL_FUNCTION_RET_SUCCESS(APL_OUT_FILE)

		}
	RETURN_FAILURE:
	{

			APL_FREE(l_mt_pty_exch_cln_map_struct_i)
		APL_FUNCTION_RET_FAILURE(APL_OUT_FILE)

	}
}

