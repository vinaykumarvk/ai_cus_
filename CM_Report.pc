








#include<string.h>
#include "stdio_64.h"
#include "CR_Common.h"
#include "Reports.h"
EXEC SQL INCLUDE SQLCA;
#define L_CODEDESC_LEN 150 
#define L_DIFF_STRING   80
#define CLT_LEN		15
#define FIRSTCLI			15
#define SECONDACC			15
#define THIRDACC			15
#define USERID				15



   int	CO_Rtv_CodeDesc( int     				*p_type_num,
											char							*p_param,
											int					*p_row_count,
				  		  	  				pipe_type  	  	  	  			*p_data,
						  	  				INTL_ENV_DATA_STRUCT_H  		   *p_intl_env_data_struct_h_f,
				  		  					DEBUG_INFO_STRUCT_H  					**l_debug_info_ptr)
 {

  	int	 	 			int_l_cntryflag;
   int 					count = 0;
	int 					int_p_array_count; 
	char					**chr_p_ret_string;
	char 					chr_l_str_brokintacc[CLT_LEN]							= APL_NULL_STRING;
	char           	chr_l_str_firstacc[FIRSTCLI]								= APL_NULL_STRING;
	char 					chr_l_str_secondacc[SECONDACC]								= APL_NULL_STRING;
	char           	chr_l_str_thirdacc[THIRDACC]								= APL_NULL_STRING;
	char					int_l_temp[FIRSTCLI];
	char        		chr_l_str_userid[USERID]										= APL_NULL_STRING;
	char					chr_l_cntry[20]													= APL_NULL_STRING;	
	char           	chr_l_codedesc[L_CODEDESC_LEN] 							= APL_NULL_STRING;
	char           	chr_l_temp_codedesc[L_CODEDESC_LEN - L_DIFF_STRING] = APL_NULL_STRING;
	char           	int_l_dummy[L_CODEDESC_LEN] 								= APL_NULL_STRING;
	int     element_count = 0;
	short             i_codedesc=0;
	short             i_dummy=0;
	short					i_temp=0;
	struct sqlca		sqlca;


   

   EXEC SQL VAR chr_l_str_brokintacc is STRING;
	EXEC SQL VAR chr_l_str_firstacc is STRING;
	EXEC SQL VAR chr_l_str_secondacc is STRING;
	EXEC SQL VAR chr_l_str_thirdacc is STRING;
	EXEC SQL VAR chr_l_str_userid is STRING;
	EXEC SQL VAR chr_l_codedesc is STRING;
	EXEC SQL VAR int_l_dummy is STRING;
	EXEC SQL VAR chr_l_temp_codedesc is STRING;


	#ifdef APL_THREADS
	APL_SET_CONTEXT
	EXEC SQL CONTEXT USE	:my_ctx_local;
	#endif


	*p_row_count            = 0;

	switch ( (*p_type_num) )
	{
		case CLT_ALL_VALID_IND:
		{
		   
			EXEC SQL DECLARE CASE_ACCOUNT_ALL_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(CLN_CODE,CHR(9)),CLN_NAME),CHR(13))  ,DECODE(CLN_CODE,CLN_MASTER,'M','S') AS MASTSUB 
         FROM MT_CLIENT 
         WHERE STATUS = 'AA' 
         ORDER BY CLN_MASTER,MASTSUB,CLN_CODE;

			EXEC SQL	OPEN CASE_ACCOUNT_ALL_CUR;
			IS_ANY_ORA_ERROR
					
	      for(;;)
			{
			 	EXEC SQL FETCH CASE_ACCOUNT_ALL_CUR 
				INTO chr_l_codedesc:i_codedesc;
			  	IS_ANY_ORA_ERROR 
   			if (APL_ZERO_RESULT_SET)
				   break;
				element_count=strlen(chr_l_codedesc);
				count ++ ;
				*p_row_count = count;
			 	
			  	if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)	
					APL_GOBACK_FAIL
			}
			   EXEC SQL CLOSE CASE_ACCOUNT_ALL_CUR;
			   IS_ANY_ORA_ERROR	
			   APL_GOBACK_SUCCESS	

	   }	

		case CLT_BRKR_IND: 
		{	
		   
			EXEC SQL DECLARE CASE_ACCOUNT_B_CUR CURSOR FOR
			SELECT CONCAT(CONCAT(CONCAT(CLN_CODE,CHR(9)),CLN_NAME),CHR(13)),DECODE(CLN_CODE,CLN_MASTER,'M','S') AS MASTSUB
         FROM MT_CLIENT
         WHERE STATUS = 'AA' 
			AND CLN_BRK_ALL IN( 'B' , 'A')
         ORDER BY CLN_MASTER,MASTSUB,CLN_CODE;

			EXEC SQL	OPEN CASE_ACCOUNT_B_CUR;
			IS_ANY_ORA_ERROR
					
	      for(;;)
			{
			 	EXEC SQL FETCH CASE_ACCOUNT_B_CUR 
				INTO chr_l_codedesc:i_codedesc;
			  	IS_ANY_ORA_ERROR 
				if (APL_ZERO_RESULT_SET)
             	break;
				element_count=strlen(chr_l_codedesc);
				count++;
				*p_row_count = count;
			  	if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)	
					APL_GOBACK_FAIL
			}
			   EXEC SQL CLOSE CASE_ACCOUNT_B_CUR;
			   IS_ANY_ORA_ERROR	
			   APL_GOBACK_SUCCESS	
 
		 }
							
		 case CLT_CA_IND:
		 {	
		 	 
         EXEC SQL DECLARE CASE_ACCOUNT_CA_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(CLN_CODE,CHR(9)),CLN_NAME),CHR(13))  ,DECODE(CLN_CODE,CLN_MASTER,'M','S') AS MASTSUB
         FROM MT_CLIENT
         WHERE STATUS = 'AA'
			AND CLN_BRK_ALL IN( 'C' , 'A')
			AND CLN_ORD_CLT = 'A'	
         ORDER BY CLN_MASTER,MASTSUB,CLN_CODE;

         EXEC SQL OPEN CASE_ACCOUNT_CA_CUR;
         IS_ANY_ORA_ERROR
           
         for(;;)
         {
            EXEC SQL FETCH CASE_ACCOUNT_CA_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
              break;
            element_count=strlen(chr_l_codedesc);
				count++;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_ACCOUNT_CA_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS
 
       }
		
		 case CLT_CB_IND:
       { 
           
         EXEC SQL DECLARE CASE_ACCOUNT_CB_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(CLN_CODE,CHR(9)),CLN_NAME),CHR(13))  ,DECODE(CLN_CODE,CLN_MASTER,'M','S') AS MASTSUB  
         FROM MT_CLIENT  
         WHERE STATUS = 'AA'  
			AND CLN_BRK_ALL IN( 'C' , 'A')
			AND CLN_ORD_CLT IN ('B', 'A')
         ORDER BY CLN_MASTER,MASTSUB,CLN_CODE; 

         EXEC SQL OPEN CASE_ACCOUNT_CB_CUR; 
         IS_ANY_ORA_ERROR  
            
         for(;;)  
         {  
            EXEC SQL FETCH CASE_ACCOUNT_CB_CUR 
            INTO chr_l_codedesc:i_codedesc;   
            IS_ANY_ORA_ERROR  
				if (APL_ZERO_RESULT_SET)
            	break;
            element_count=strlen(chr_l_codedesc);   
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE) 
               APL_GOBACK_FAIL  
         }  
            EXEC SQL CLOSE CASE_ACCOUNT_CB_CUR;
            IS_ANY_ORA_ERROR 
            APL_GOBACK_SUCCESS
   
       }
    
		 case CLT_CC_IND:
       {
          
         EXEC SQL DECLARE CASE_ACCOUNT_CC_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(CLN_CODE,CHR(9)),CLN_NAME),CHR(13))  ,DECODE(CLN_CODE,CLN_MASTER,'M','S') AS MASTSUB
         FROM MT_CLIENT
         WHERE STATUS = 'AA' 
			AND CLN_BRK_ALL IN( 'C' , 'A')
			AND CLN_ORD_CLT IN ('C', 'A')
         ORDER BY CLN_MASTER,MASTSUB,CLN_CODE;

         EXEC SQL OPEN CASE_ACCOUNT_CC_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_ACCOUNT_CC_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
            	break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_ACCOUNT_CC_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

       }
		
		 case CLT_CI_IND:
       {
			if (strlen(p_param)!= 0)     
		   	strcpy (chr_l_str_brokintacc,p_param); 
			else strcpy (chr_l_str_brokintacc," ");
          
         EXEC SQL DECLARE CASE_ACCOUNT_CI_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(CLN_CODE,CHR(9)),CLN_NAME),CHR(13)),DECODE(CLN_CODE,CLN_MASTER,'M','S') AS MASTSUB
         FROM MT_CLIENT
         WHERE STATUS = 'AA' 
			AND CLN_BRK_ALL IN( 'C' , 'A')
			AND CLN_ORD_CLT=  'A'
			AND CLN_CODE <> :chr_l_str_brokintacc
         ORDER BY CLN_MASTER,MASTSUB,CLN_CODE;

         EXEC SQL OPEN CASE_ACCOUNT_CI_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_ACCOUNT_CI_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
            	break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_ACCOUNT_CI_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

       }

		 case CLT_CM_IND:
       {
			 if (strlen(p_param) != 0)
			  strcpy (chr_l_str_brokintacc,p_param);
			 else strcpy (chr_l_str_brokintacc," ");
          
         EXEC SQL DECLARE CASE_ACCOUNT_CM_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(a.CLN_CODE,CHR(9)),a.CLN_NAME),CHR(13))  
         FROM MT_CLIENT a
         WHERE 
			( a.CLN_CODE > :chr_l_str_brokintacc OR
					a.CLN_CODE < :chr_l_str_brokintacc )
 			AND STATUS = 'AA' 
			AND CLN_BRK_ALL IN( 'C' , 'A')
			AND CLN_ORD_CLT IN ('C', 'A')
         ORDER BY CLN_MASTER,a.CLN_CODE;

         EXEC SQL OPEN CASE_ACCOUNT_CM_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_ACCOUNT_CM_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
            	break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_ACCOUNT_CM_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

       }

		 case CLT_ALL_MSG_AUTH_IND:
       {
          
         EXEC SQL DECLARE CASE_ACCOUNT_MSGACC_CUR CURSOR FOR
			SELECT CLN_CODE || CHR(9) || CLN_NAME || CHR(13) AS CLT_DESC
			FROM MT_CLIENT
			WHERE CLN_CODE in (SELECT CLIENT FROM MS_MSGSTAT )
			AND STATUS = 'AA'
			ORDER BY CLN_DESC;

         EXEC SQL OPEN CASE_ACCOUNT_MSGACC_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_ACCOUNT_MSGACC_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
            	break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_ACCOUNT_MSGACC_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

       }

		 case CLT_NOT_INTERNAL_BRK_IND:
       {
			 if (strlen(p_param) != 0)  
				 strcpy (chr_l_str_brokintacc,p_param);
			 else strcpy (chr_l_str_brokintacc," ");

          
         EXEC SQL DECLARE CASE_ACCOUNT_BB_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(CLN_CODE,CHR(9)),CLN_NAME),CHR(13)),DECODE(CLN_CODE,CLN_MASTER,'M','S') AS MASTSUB
         FROM MT_CLIENT
         WHERE STATUS = 'AA'  
			AND CLN_CODE<> :chr_l_str_brokintacc
         ORDER BY CLN_MASTER,MASTSUB,CLN_CODE;

         EXEC SQL OPEN CASE_ACCOUNT_BB_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_ACCOUNT_BB_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
            	break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_ACCOUNT_BB_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

       }
       case CLT_CMA_IND: 
	    {
          if (strlen(p_param) != 0)
             strcpy (chr_l_str_brokintacc,p_param);
          else strcpy (chr_l_str_brokintacc," ");
          
          EXEC SQL DECLARE CASE_ACCOUNT_CMA_CUR CURSOR FOR
          SELECT CONCAT(CONCAT(CONCAT(a.CLN_CODE,CHR(9)),a.CLN_NAME),CHR(13))  ,DECODE(a.CLN_CODE,a.CLN_MASTER,'M','S') AS MASTSUB
          FROM MT_CLIENT a
          WHERE a.CLN_CODE IN (SELECT DISTINCT b.CLN_CODE FROM MT_CLIENT b,MT_MSGADDRESS c where b.CLN_CODE=c.CLN_CODE)
          ORDER BY a.CLN_MASTER,MASTSUB,a.CLN_CODE;

          EXEC SQL OPEN CASE_ACCOUNT_CMA_CUR;
          IS_ANY_ORA_ERROR

           for(;;)
         {
            EXEC SQL FETCH CASE_ACCOUNT_CMA_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
            if (APL_ZERO_RESULT_SET)
               break;
            element_count=strlen(chr_l_codedesc);
            count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_ACCOUNT_CMA_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

       }
		
		 case CLH_CLIENT_IND:
		 {
			
         EXEC SQL DECLARE CASE_CLH_ACCOUNT CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(CLN_CLH,CHR(9)),CLN_CODE),CHR(13))   
			FROM MT_CLIENT 
			WHERE STATUS = 'AA' 
			AND CLN_BRK_ALL <> 'B' 
			AND CLN_CLH IS NOT NULL
			ORDER BY CLN_CLH, CLN_CODE;
	
			EXEC SQL OPEN CASE_CLH_ACCOUNT;
			IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_CLH_ACCOUNT
				INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
            if (APL_ZERO_RESULT_SET)
               break;
            element_count=strlen(chr_l_codedesc);
            count ++ ;
            *p_row_count = count;
          
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_CLH_ACCOUNT;
				IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      } 
			

		 case CLT_BL_IND:
       {
			 if (strlen(p_param) != 0) 
				 strcpy (chr_l_str_brokintacc,p_param);
			 else strcpy (chr_l_str_brokintacc," ");

          
         EXEC SQL DECLARE CASE_ACCOUNT_BL_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(MT_CLIENT.CLN_CODE,CHR(9)),MT_CLIENT.CLN_NAME),CHR(13))  ,DECODE(MT_CLIENT.CLN_CODE,MT_CLIENT.CLN_MASTER,'M','S') AS MASTSUB
         FROM MT_CLIENT,IV_CLIENTSETUP
         WHERE STATUS = 'AA' 
			AND MT_CLIENT.CLN_CODE=IV_CLIENTSETUP.CLIENT
			AND IV_CLIENTSETUP.STAT_IND = 'A'
			AND MT_CLIENT.CLN_CODE <> :chr_l_str_brokintacc
         ORDER BY CLN_MASTER,MASTSUB,MT_CLIENT.CLN_CODE;

         EXEC SQL OPEN CASE_ACCOUNT_BL_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_ACCOUNT_BL_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
            	break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_ACCOUNT_BL_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

       }
		
		 case CLT_B_OTHSERV_IND :
       {
			 if (strlen(p_param) != 0) 
				 strcpy (chr_l_str_brokintacc,p_param);
			 else strcpy (chr_l_str_brokintacc," ");

          
			 
         EXEC SQL DECLARE CASE_ACCOUNT_B_OTH_SRV_CUR CURSOR FOR
         SELECT DISTINCT MT_CLIENT.CLN_CODE || CHR(9)|| MT_CLIENT.CLN_NAME || CHR(13),MT_CLIENT.CLN_CODE 
         FROM MT_CLIENT,IV_CLIENTSETUP,IV_SERV_OTH 
         WHERE STATUS = 'AA'
         AND MT_CLIENT.CLN_CODE = IV_CLIENTSETUP.CLIENT
         AND IV_CLIENTSETUP.STAT_IND = 'A'
			AND MT_CLIENT.CLN_CODE <> :chr_l_str_brokintacc
			AND MT_CLIENT.CLN_CODE = IV_SERV_OTH.CLIENT
         ORDER BY MT_CLIENT.CLN_CODE;


         EXEC SQL OPEN CASE_ACCOUNT_B_OTH_SRV_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_ACCOUNT_B_OTH_SRV_CUR
            INTO chr_l_codedesc:i_codedesc ,int_l_temp:i_temp;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
            	break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_ACCOUNT_B_OTH_SRV_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

       }

		 case CLT_ALL_NOTCLOSED_IND:
       {
          
         EXEC SQL DECLARE CASE_ACCOUNT_NC_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(CLN_CODE,CHR(9)),CLN_NAME),CHR(13))  ,DECODE(CLN_CODE,CLN_MASTER,'M','S') AS MASTSUB
         FROM MT_CLIENT
         WHERE STATUS NOT IN ('CA','CU') 
         ORDER BY CLN_MASTER,MASTSUB,CLN_CODE;

         EXEC SQL OPEN CASE_ACCOUNT_NC_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_ACCOUNT_NC_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
            	break;
            element_count=strlen(chr_l_codedesc);
				 count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_ACCOUNT_NC_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

       }

		 case CLT_AU_BRK_ONLY_IND:
       {
          
         EXEC SQL DECLARE CASE_ACCOUNT_CUBK_ONLY_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(CLN_CODE,CHR(9)),CLN_NAME),CHR(13))  ,DECODE(CLN_CODE,CLN_MASTER,'M','S') AS MASTSUB
         FROM MT_CLIENT
         WHERE STATUS = 'AA' AND CLN_BRK_ALL IN( 'C' , 'A') 
         ORDER BY CLN_MASTER,MASTSUB,CLN_CODE;

         EXEC SQL OPEN CASE_ACCOUNT_CUBK_ONLY_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_ACCOUNT_CUBK_ONLY_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
            	break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_ACCOUNT_CUBK_ONLY_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

       }

		 case CLT_ENT_IND:
		 

       {
          
         EXEC SQL DECLARE CASE_ACCOUNT_ENT_ACC_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(CLN_CODE,CHR(9)),CLN_NAME),CHR(13))  ,DECODE(CLN_CODE,CLN_MASTER,'M','S') AS MASTSUB
         FROM MT_CLIENT
         WHERE STATUS <> 'CA'  AND CLN_BRK_ALL IN('C','A')
         ORDER BY CLN_MASTER,MASTSUB,CLN_CODE;

         EXEC SQL OPEN CASE_ACCOUNT_ENT_ACC_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_ACCOUNT_ENT_ACC_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
            	break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_ACCOUNT_ENT_ACC_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

       }

		 case CLT_CCI_IND:
		 
       {
			 if (strlen(p_param) != 0) 
				 strcpy (chr_l_str_brokintacc,p_param);
			 else strcpy (chr_l_str_brokintacc," ");

          
         EXEC SQL DECLARE CASE_ACCOUNT_CCI_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(CLN_CODE,CHR(9)),CLN_NAME),CHR(13))  ,DECODE(CLN_CODE,CLN_MASTER,'M','S') AS MASTSUB
         FROM MT_CLIENT
         WHERE STATUS = 'AA' AND CLN_BRK_ALL IN( 'C' , 'A') AND CLN_ORD_CLT IN ('C', 'A')
			AND CLN_CODE <> :chr_l_str_brokintacc
         ORDER BY CLN_MASTER,MASTSUB,CLN_CODE;

         EXEC SQL OPEN CASE_ACCOUNT_CCI_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_ACCOUNT_CCI_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
            	break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_ACCOUNT_CCI_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

       }

		 case CLT_ALL_IMAST_AUTH_IND:
       {
			 
			 if (strlen(p_param) != 0)   
			 {
				CO_SplitStr(p_param, ':' ,&int_p_array_count,&chr_p_ret_string);
				strcpy(chr_l_str_firstacc,chr_p_ret_string[0]);
				strcpy(chr_l_str_secondacc,chr_p_ret_string[1]);
				strcpy(chr_l_str_thirdacc,chr_p_ret_string[2]);  	
			 }
			 else
          {
				strcpy(chr_l_str_firstacc, l_mt_core_sys_params_struct_h.custody_clt_cd);
            strcpy(chr_l_str_secondacc,l_mt_core_sys_params_struct_h.brokerage_cd );
            strcpy(chr_l_str_thirdacc, l_mt_core_sys_params_struct_h.vtb_clt_code);

           }

		     if (strlen(chr_l_str_firstacc) != 0)	 
			  {	
				 if (strlen(chr_l_str_secondacc) != 0)
				 {
					if (strlen(chr_l_str_thirdacc)!= 0)		
			  		{
			  	   	 
        				 EXEC SQL DECLARE CASE_ACCOUNT_MAST_ACC_1_CUR CURSOR FOR
        				 SELECT CONCAT(CONCAT(CONCAT(CLN_CODE,CHR(9)),CLN_NAME),CHR(13))
        				 FROM MT_CLIENT
        				 WHERE CLN_CODE = CLN_MASTER
        				 AND STATUS = 'AA'
        				 AND CLN_BRK_ALL <> 'B'
		  	   		 AND CLN_CODE <> :chr_l_str_firstacc
        				 AND CLN_CODE <> :chr_l_str_secondacc
						 AND CLN_CODE <> :chr_l_str_thirdacc
						 ORDER BY CLN_CODE;	

        				 EXEC SQL OPEN CASE_ACCOUNT_MAST_ACC_1_CUR;
        				 IS_ANY_ORA_ERROR

        				 for(;;)
						 {
           				 EXEC SQL FETCH CASE_ACCOUNT_MAST_ACC_1_CUR
           				 INTO chr_l_codedesc:i_codedesc;
           				 IS_ANY_ORA_ERROR
							 if (APL_ZERO_RESULT_SET)
           					 break;
           				 element_count=strlen(chr_l_codedesc);
            			 count ++ ;
           				 *p_row_count = count;
           				 if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
              			 APL_GOBACK_FAIL
 	       			 }

           			 EXEC SQL CLOSE CASE_ACCOUNT_MAST_ACC_1_CUR;
            		 IS_ANY_ORA_ERROR
           			 APL_GOBACK_SUCCESS
					 }	

				 	 else    
            	 {
           			 
            		 EXEC SQL DECLARE CASE_ACCOUNT_MAST_ACC_2_CUR CURSOR FOR
            		 SELECT CONCAT(CONCAT(CONCAT(CLN_CODE,CHR(9)),CLN_NAME),CHR(13))
            		 FROM MT_CLIENT
            		 WHERE CLN_CODE = CLN_MASTER
            		 AND STATUS = 'AA'
            		 AND CLN_BRK_ALL <> 'B'
            		 AND CLN_CODE <> :chr_l_str_firstacc
						 AND CLN_CODE <> :chr_l_str_secondacc
						 ORDER BY CLN_CODE;	
				
            		 EXEC SQL OPEN CASE_ACCOUNT_MAST_ACC_2_CUR;
            		 IS_ANY_ORA_ERROR

            		 for(;;)
           			 {
           				 EXEC SQL FETCH CASE_ACCOUNT_MAST_ACC_2_CUR
           				 INTO chr_l_codedesc:i_codedesc;
           				 IS_ANY_ORA_ERROR
							 if (APL_ZERO_RESULT_SET)
           					 break;
           				 element_count=strlen(chr_l_codedesc);
            			 count ++ ;
           				 *p_row_count = count;
           				 if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
              		   	APL_GOBACK_FAIL
          			 }

           			 EXEC SQL CLOSE CASE_ACCOUNT_MAST_ACC_2_CUR;
            		 IS_ANY_ORA_ERROR
           			 APL_GOBACK_SUCCESS
         		 }
				
		    }

	      else			
	 		{
      	   
        		EXEC SQL DECLARE CASE_ACCOUNT_MAST_ACC_3_CUR CURSOR FOR
        		SELECT CONCAT(CONCAT(CONCAT(CLN_CODE,CHR(9)),CLN_NAME),CHR(13))  
        		FROM MT_CLIENT
        		WHERE CLN_CODE = CLN_MASTER
			   AND STATUS = 'AA' 
		  	   AND CLN_BRK_ALL <> 'B'
		  		AND CLN_CODE <> :chr_l_str_firstacc
				ORDER BY CLN_CODE;

        		EXEC SQL OPEN CASE_ACCOUNT_MAST_ACC_3_CUR;
        		IS_ANY_ORA_ERROR

        		for(;;)
        		 {
           		 EXEC SQL FETCH CASE_ACCOUNT_MAST_ACC_3_CUR
           		 INTO chr_l_codedesc:i_codedesc;
           		 IS_ANY_ORA_ERROR
					 if (APL_ZERO_RESULT_SET)
 			          break;
           		 element_count=strlen(chr_l_codedesc);
					 count ++ ;
           		 *p_row_count = count;
           		 if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
                APL_GOBACK_FAIL
        		 }
           	 EXEC SQL CLOSE CASE_ACCOUNT_MAST_ACC_3_CUR;
             IS_ANY_ORA_ERROR
             APL_GOBACK_SUCCESS

			}
		  }
       }
		
		  case CLT_REPL_IND:
       {
          
          if (strlen(p_param) != 0)  
          {
            CO_SplitStr(p_param, ':' ,&int_p_array_count,&chr_p_ret_string);
            strcpy(chr_l_str_firstacc,chr_p_ret_string[0]);
            strcpy(chr_l_str_secondacc,chr_p_ret_string[1]);
            strcpy(chr_l_str_thirdacc,chr_p_ret_string[2]);
          }
          else
          {
				strcpy(chr_l_str_firstacc, l_mt_core_sys_params_struct_h.custody_clt_cd);
            strcpy(chr_l_str_secondacc,l_mt_core_sys_params_struct_h.brokerage_cd );
            strcpy(chr_l_str_thirdacc, l_mt_core_sys_params_struct_h.vtb_clt_code);

           }

           if (strlen(chr_l_str_firstacc) != 0)
           {
             if (strlen(chr_l_str_secondacc) != 0)
             {
               if (strlen(chr_l_str_thirdacc)!= 0)
               {
                   
                   EXEC SQL DECLARE CASE_ACCOUNT_REPLICAT_1_CUR CURSOR FOR
						 SELECT CONCAT(CONCAT(CONCAT(CLN_CODE,CHR(9)),CLN_NAME),CHR(13))
                   FROM MT_CLIENT
                   WHERE STATUS = 'AA'
                   AND CLN_CODE <> :chr_l_str_firstacc
                   AND CLN_CODE <> :chr_l_str_secondacc
                   AND CLN_CODE <> :chr_l_str_thirdacc
                   ORDER BY CLN_CODE;

                   EXEC SQL OPEN CASE_ACCOUNT_REPLICAT_1_CUR;
                   IS_ANY_ORA_ERROR

                   for(;;)
                   {
                      EXEC SQL FETCH CASE_ACCOUNT_REPLICAT_1_CUR
                      INTO chr_l_codedesc:i_codedesc;
                      IS_ANY_ORA_ERROR
                      if (APL_ZERO_RESULT_SET)
                         break;
                      element_count=strlen(chr_l_codedesc);
                      count ++ ;
                      *p_row_count = count;
                      if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
							   APL_GOBACK_FAIL
                   }

                   EXEC SQL CLOSE CASE_ACCOUNT_REPLICAT_1_CUR;
                   IS_ANY_ORA_ERROR
                   APL_GOBACK_SUCCESS
                }

                else 
                {
                   
                   EXEC SQL DECLARE CASE_ACCOUNT_REPLICAT_2_CUR CURSOR FOR
						 SELECT CONCAT(CONCAT(CONCAT(CLN_CODE,CHR(9)),CLN_NAME),CHR(13))
                   FROM MT_CLIENT
                   WHERE STATUS = 'AA'
                   AND CLN_CODE <> :chr_l_str_firstacc
                   AND CLN_CODE <> :chr_l_str_secondacc
                   ORDER BY CLN_CODE;
   
                   EXEC SQL OPEN CASE_ACCOUNT_REPLICAT_2_CUR;
                   IS_ANY_ORA_ERROR

                   for(;;)
                   {
                      EXEC SQL FETCH CASE_ACCOUNT_REPLICAT_2_CUR
                      INTO chr_l_codedesc:i_codedesc;
                      IS_ANY_ORA_ERROR
                      if (APL_ZERO_RESULT_SET)
                         break;
                      element_count=strlen(chr_l_codedesc);
                      count ++ ;
                      *p_row_count = count;
                      if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
                        APL_GOBACK_FAIL
                   }

                   EXEC SQL CLOSE CASE_ACCOUNT_REPLICAT_2_CUR;
                   IS_ANY_ORA_ERROR
                   APL_GOBACK_SUCCESS
                }
   
          }

         else     
         {
            
            EXEC SQL DECLARE CASE_ACCOUNT_REPLICAT_3_CUR CURSOR FOR
				SELECT CONCAT(CONCAT(CONCAT(CLN_CODE,CHR(9)),CLN_NAME),CHR(13))
            FROM MT_CLIENT
            WHERE STATUS = 'AA'
            AND CLN_CODE <> :chr_l_str_firstacc
            ORDER BY CLN_CODE;

            EXEC SQL OPEN CASE_ACCOUNT_REPLICAT_3_CUR;
            IS_ANY_ORA_ERROR

            for(;;)
             {
                EXEC SQL FETCH CASE_ACCOUNT_REPLICAT_3_CUR
                INTO chr_l_codedesc:i_codedesc;
                IS_ANY_ORA_ERROR
                if (APL_ZERO_RESULT_SET)
                   break;
                element_count=strlen(chr_l_codedesc);
                count ++ ;
                *p_row_count = count;
                if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
                APL_GOBACK_FAIL
             }
             EXEC SQL CLOSE CASE_ACCOUNT_REPLICAT_3_CUR;
             IS_ANY_ORA_ERROR
             APL_GOBACK_SUCCESS

         }
        }
       }
   
		 case CLT_BILLABLE_IND:
       {
          
         EXEC SQL DECLARE CASE_ACCOUNT_BILLABLE_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(CLN_CODE,CHR(9)),CLN_NAME),CHR(13))  ,DECODE(CLN_CODE,CLN_MASTER,'M','S') AS MASTSUB
         FROM MT_CLIENT
         WHERE STATUS = 'AA' AND CLN_BRK_ALL IN( 'C' , 'A') AND CLN_BILLABLEIND = 'Y'; 

         EXEC SQL OPEN CASE_ACCOUNT_BILLABLE_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_ACCOUNT_BILLABLE_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
           		 break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_ACCOUNT_BILLABLE_CUR;
             IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

       }

		 case CLT_ALL_IND:
       {
          
         EXEC SQL DECLARE CASE_ACCOUNT_INQ_ALL_ACC_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(CLN_CODE,CHR(9)),CLN_NAME),CHR(13))  ,DECODE(CLN_CODE,CLN_MASTER,'M','S') AS MASTSUB
         FROM MT_CLIENT
         ORDER BY CLN_MASTER,MASTSUB,CLN_CODE;

         EXEC SQL OPEN CASE_ACCOUNT_INQ_ALL_ACC_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_ACCOUNT_INQ_ALL_ACC_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
           		 break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_ACCOUNT_INQ_ALL_ACC_CUR;
             IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

       }

		 case CLT_ALL_MAST_IND: 
		 
       {
          
         EXEC SQL DECLARE CASE_ACCOUNT_INQ_MST_ACC_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(CLN_CODE,CHR(9)),CLN_NAME),CHR(13))  
         FROM MT_CLIENT
         WHERE CLN_CODE = CLN_MASTER
         ORDER BY CLN_CODE;

         EXEC SQL OPEN CASE_ACCOUNT_INQ_MST_ACC_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_ACCOUNT_INQ_MST_ACC_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
           		 break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_ACCOUNT_INQ_MST_ACC_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

       }

		 case CLT_ALL_MAST_NOTBRK_CC_IND:
		 

       {
          
         EXEC SQL DECLARE CASE_ACCOUNT_INQ_MST_ACC_CC_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(CLN_CODE,CHR(9)),CLN_NAME),CHR(13))  
         FROM MT_CLIENT
         WHERE CLN_CODE = CLN_MASTER AND CLN_BRK_ALL IN( 'C' , 'A') AND CLN_ORD_CLT IN ('C', 'A')
         ORDER BY CLN_CODE;

         EXEC SQL OPEN CASE_ACCOUNT_INQ_MST_ACC_CC_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_ACCOUNT_INQ_MST_ACC_CC_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
           		 break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_ACCOUNT_INQ_MST_ACC_CC_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

       }

		 case CLT_ALL_NOTBRKR_IND:
		 
       {
          
			

         EXEC SQL DECLARE CASE_ACCOUNT_INQ_TRD_ACC_CC_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(CLN_CODE,CHR(9)),CLN_NAME),CHR(13))  ,DECODE(CLN_CODE,CLN_MASTER,'M','S') AS MASTSUB
         FROM MT_CLIENT
         WHERE  CLN_BRK_ALL IN( 'C' , 'A')
         ORDER BY CLN_MASTER,MASTSUB,CLN_CODE;

         EXEC SQL OPEN CASE_ACCOUNT_INQ_TRD_ACC_CC_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_ACCOUNT_INQ_TRD_ACC_CC_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
           		 break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_ACCOUNT_INQ_TRD_ACC_CC_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

       }

		 case CLT_ALL_NOTCUSD_IND:
		 
       {
          
         EXEC SQL DECLARE CASE_ACCOUNT_INQ_TRD_ACC_B_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(CLN_CODE,CHR(9)),CLN_NAME),CHR(13))  ,DECODE(CLN_CODE,CLN_MASTER,'M','S') AS MASTSUB
         FROM MT_CLIENT
         WHERE  CLN_BRK_ALL IN( 'B' , 'A')
         ORDER BY CLN_MASTER,MASTSUB,CLN_CODE;

         EXEC SQL OPEN CASE_ACCOUNT_INQ_TRD_ACC_B_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_ACCOUNT_INQ_TRD_ACC_B_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
           		 break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_ACCOUNT_INQ_TRD_ACC_B_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

       }

		 case CLT_ALL_MAST_AUTH_IND:
       {
          
         EXEC SQL DECLARE CASE_ACCOUNT_MSTACC_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(CLN_CODE,CHR(9)),CLN_NAME),CHR(13))  
         FROM MT_CLIENT
         WHERE STATUS = 'AA' AND CLN_CODE = CLN_MASTER 
         ORDER BY CLN_CODE;

         EXEC SQL OPEN CASE_ACCOUNT_MSTACC_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_ACCOUNT_MSTACC_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
            	break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_ACCOUNT_MSTACC_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

       }

		 case CLT_ALL_MAST_NOTBRK_IND:
       {
          
         EXEC SQL DECLARE CASE_ACCOUNT_MSTACC_BRK_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(CLN_CODE,CHR(9)),CLN_NAME),CHR(13))  
         FROM MT_CLIENT
         WHERE CLN_CODE = CLN_MASTER AND MT_CLIENT.CLN_BRK_ALL <> 'B' 
         ORDER BY CLN_CODE;

         EXEC SQL OPEN CASE_ACCOUNT_MSTACC_BRK_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_ACCOUNT_MSTACC_BRK_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				 if (APL_ZERO_RESULT_SET)
           		 break;
            element_count=strlen(chr_l_codedesc);
            (*p_row_count)+=1;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_ACCOUNT_MSTACC_BRK_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

       }

      case NPNB:
      {
         
         EXEC SQL DECLARE CASE_NPNB_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(CLN_CODE,CHR(9)),CLN_NAME),CHR(13))  
        ,DECODE(CLN_CODE,CLN_MASTER,'M','S'
         ) AS MASTSUB
         FROM MT_CLIENT A
         WHERE CLN_CLAS = '2' AND CLN_BRK_ALL IN ('A', 'C') AND 
	      STATUS = 'AA' AND NOT EXISTS (Select 1 from DL_RUCLIENT B where A.CLN_CODE = B.CLIENT)
         ORDER BY CLN_MASTER,MASTSUB,CLN_CODE;

         EXEC SQL OPEN CASE_NPNB_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_NPNB_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
            if (APL_ZERO_RESULT_SET)
               break;
            element_count=strlen(chr_l_codedesc);
            count ++ ;
            *p_row_count = count;
          
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_NPNB_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      }

      case CLT_CUSTD_IND:
      {
         
         EXEC SQL DECLARE CASE_ACC_GRP_CSTD_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(CLN_CODE,CHR(9)),CLN_NAME),CHR(13))
         FROM MT_CLIENT 
	      WHERE STATUS = 'AA' AND CLN_GROUP = 'CSTD'
         ORDER BY CLN_CODE;

         EXEC SQL OPEN CASE_ACC_GRP_CSTD_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_ACC_GRP_CSTD_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
            if (APL_ZERO_RESULT_SET)
               break;
            element_count=strlen(chr_l_codedesc);
            count ++ ;
            *p_row_count = count;
          
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_ACC_GRP_CSTD_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      }


		 case INSTRUMENT_REDEN_TYPE:
      {
         
         EXEC SQL DECLARE CASE_INSTRUMENT_REDEN_TYPE_CUR CURSOR FOR
			SELECT INSTR_CODE || CHR(9) || REPLACE(REPLACE(INSTR_NAME,CHR(13),' '),CHR(10),' ') ||CHR(13) AS INSTR_NAME FROM MT_INSTRUMENT
 		   WHERE INSTR_TYPE IN ('FMT') 
			ORDER BY INSTR_CODE;

         EXEC SQL OPEN CASE_INSTRUMENT_REDEN_TYPE_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_INSTRUMENT_REDEN_TYPE_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
           		 break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_INSTRUMENT_REDEN_TYPE_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      };


		 case INSTRUMENT_REDEN_TYPE_AUTH:
      {
         
         EXEC SQL DECLARE CASE_INSTRUMENT_REDEN_TYPE_AUTH_CUR CURSOR FOR
			SELECT INSTR_CODE || CHR(9) || REPLACE(REPLACE(INSTR_NAME,CHR(13),' '),CHR(10),' ') ||CHR(13) AS INSTR_NAME FROM MT_INSTRUMENT
 		   WHERE INSTR_TYPE IN ('FMT') AND STATUS = 'AA' 
			ORDER BY INSTR_CODE;

         EXEC SQL OPEN CASE_INSTRUMENT_REDEN_TYPE_AUTH_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_INSTRUMENT_REDEN_TYPE_AUTH_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
           		 break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_INSTRUMENT_REDEN_TYPE_AUTH_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      };

		 case INSTRUMENT_REDEN:
      {
         
         EXEC SQL DECLARE CASE_INSTRUMENT_REDEN_CUR CURSOR FOR
			SELECT INSTR_CODE || CHR(9) || REPLACE(REPLACE(INSTR_NAME,CHR(13),' '),CHR(10),' ') ||CHR(13) AS INSTR_NAME FROM MT_INSTRUMENT
 		   WHERE INSTR_CODE IN ( SELECT INSTR_CODE FROM PRO_EURO_TEMP WHERE PROC_AREA='REDEN') AND INSTR_TYPE IN ('FMT') 
			ORDER BY INSTR_CODE;

         EXEC SQL OPEN CASE_INSTRUMENT_REDEN_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_INSTRUMENT_REDEN_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
           		 break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_INSTRUMENT_REDEN_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      };

		 case INSTRUMENT_INSTRU_ALL:
      {
         
         EXEC SQL DECLARE CASE_INSTRUMENT_INSTR_ALL_CUR CURSOR FOR
			SELECT INSTR_CODE || CHR(9) || REPLACE(REPLACE(INSTR_NAME,CHR(13),' '),CHR(10),' ') ||CHR(13) AS INSTR_NAME FROM MT_INSTRUMENT
 		   WHERE STATUS = 'AA' 
			ORDER BY INSTR_CODE;

         EXEC SQL OPEN CASE_INSTRUMENT_INSTR_ALL_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_INSTRUMENT_INSTR_ALL_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
           		 break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_INSTRUMENT_INSTR_ALL_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      };

		 case INSTRUMENT_RSW:
      {
         
         EXEC SQL DECLARE CASE_INSTRUMENT_RSW_CUR CURSOR FOR
         SELECT INSTR_CODE || CHR(9) || REPLACE(REPLACE(INSTR_NAME,CHR(13),' '),CHR(10),' ') ||CHR(13) AS INSTR_NAME FROM MT_INSTRUMENT
         WHERE (INSTR_TYPE IN('RTS','SHS','WTS')AND  STATUS = 'AA') 
			ORDER BY INSTR_CODE;

         EXEC SQL OPEN CASE_INSTRUMENT_RSW_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_INSTRUMENT_RSW_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
           		 break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_INSTRUMENT_RSW_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      };

		case INSTRUMENT_RSW_DEAL:
      {
         
         EXEC SQL DECLARE CASE_INSTRUMENT_RSW_TRD_CUR CURSOR FOR
         SELECT INSTR_CODE || CHR(9) || REPLACE(REPLACE(INSTR_NAME,CHR(13),' '),CHR(10),' ') ||CHR(13) AS INSTR_NAME FROM MT_INSTRUMENT
         WHERE (INSTR_TYPE IN('RTS','SHS','WTS') AND CLASSCD <> 'NTRD' AND  STATUS = 'AA')
         ORDER BY INSTR_CODE;

         EXEC SQL OPEN CASE_INSTRUMENT_RSW_TRD_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_INSTRUMENT_RSW_TRD_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
            if (APL_ZERO_RESULT_SET)
                break;
            element_count=strlen(chr_l_codedesc);
            count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_INSTRUMENT_RSW_TRD_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      };

		 case INSTRUMENT_CHILD:
      {
         
         EXEC SQL DECLARE CASE_INSTRUMENT_CHILD_CUR CURSOR FOR
         SELECT INSTR_CODE || CHR(9) || REPLACE(REPLACE(INSTR_NAME,CHR(13),' '),CHR(10),' ') ||CHR(13) AS INSTR_NAME FROM MT_INSTRUMENT
         WHERE (INSTR_PARENT IS NOT NULL AND MOTHER_SEC_IND = 'N' AND  STATUS = 'AA')
			ORDER BY INSTR_CODE;

         EXEC SQL OPEN CASE_INSTRUMENT_CHILD_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_INSTRUMENT_CHILD_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
           		 break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_INSTRUMENT_CHILD_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      };

		 case INSTRUMENT_PARENT:
      {
         
         EXEC SQL DECLARE CASE_INSTRUMENT_PARENT_CUR CURSOR FOR
         SELECT INSTR_CODE || CHR(9) || REPLACE(REPLACE(INSTR_NAME,CHR(13),' '),CHR(10),' ') ||CHR(13) AS INSTR_NAME FROM MT_INSTRUMENT
         WHERE STATUS = 'AA'AND MOTHER_SEC_IND = 'Y' 
			ORDER BY INSTR_CODE;

         EXEC SQL OPEN CASE_INSTRUMENT_PARENT_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_INSTRUMENT_PARENT_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
           		 break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_INSTRUMENT_PARENT_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      };

		 case INSTRUMENT_SCC:
      {
			 if (strlen(p_param)!= 0)
         	strcpy (chr_l_str_userid,p_param);
			 else strcpy(chr_l_str_userid," ");

         
         EXEC SQL DECLARE CASE_INSTRUMENT_SCC_CUR CURSOR FOR
			SELECT INSTR_CODE || CHR(9) || REPLACE(REPLACE(INSTR_NAME,CHR(13),' '),CHR(10),' ') ||CHR(13) AS INSTR_NAME FROM MT_INSTRUMENT
         WHERE STATUS = 'AA' AND CHNG_CD IS NOT NULL AND CHG_MKR <> :chr_l_str_userid 
			ORDER BY INSTR_CODE;

         EXEC SQL OPEN CASE_INSTRUMENT_SCC_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_INSTRUMENT_SCC_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
           		 break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_INSTRUMENT_SCC_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      };

		 case INSTRUMENT_REG:
      {
         
         EXEC SQL DECLARE CASE_INSTRUMENT_REG_CUR CURSOR FOR
			SELECT INSTR_CODE || CHR(9) || REPLACE(REPLACE(INSTR_NAME,CHR(13),' '),CHR(10),' ') ||CHR(13) AS INSTR_NAME FROM MT_INSTRUMENT
         WHERE STATUS = 'AA' AND REG_BR_IND = 'RG'
			ORDER BY INSTR_CODE;

         EXEC SQL OPEN CASE_INSTRUMENT_REG_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_INSTRUMENT_REG_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				 if (APL_ZERO_RESULT_SET)
           		 break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_INSTRUMENT_REG_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      };

		 case INSTRUMENT_FROM_INSTRU_CONV_INP:
      {
         
         EXEC SQL DECLARE CASE_INSTRUMENT_FROM_INSTR_CONV_INP_CUR CURSOR FOR
			SELECT INSTR_CODE || CHR(9) || REPLACE(REPLACE(INSTR_NAME,CHR(13),' '),CHR(10),' ') ||CHR(13) AS INSTR_NAME FROM MT_INSTRUMENT
         WHERE NEW_MAKER IS NULL AND STATUS IN('AA','FA' )
			ORDER BY INSTR_CODE;

         EXEC SQL OPEN CASE_INSTRUMENT_FROM_INSTR_CONV_INP_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_INSTRUMENT_FROM_INSTR_CONV_INP_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
           		 break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_INSTRUMENT_FROM_INSTR_CONV_INP_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      };

		 case INSTRUMENT_TO_INSTRU_CONV_INP:
      {
         
         EXEC SQL DECLARE CASE_INSTRUMENT_TO_INSTR_CONV_INP_CUR CURSOR FOR
			SELECT INSTR_CODE || CHR(9) || REPLACE(REPLACE(INSTR_NAME,CHR(13),' '),CHR(10),' ') ||CHR(13) AS INSTR_NAME FROM MT_INSTRUMENT
         WHERE STATUS IN ('AA' , 'FA ') 
			ORDER BY INSTR_CODE;

         EXEC SQL OPEN CASE_INSTRUMENT_TO_INSTR_CONV_INP_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_INSTRUMENT_TO_INSTR_CONV_INP_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
           		 break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_INSTRUMENT_TO_INSTR_CONV_INP_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      };

		case INSTRUMENT_FROM_INSTRU_CONV_INPTRD:
      {
         
         EXEC SQL DECLARE CASE_INSTRUMENT_FROM_INSTR_CONV_INPTRD_CUR CURSOR FOR
         SELECT INSTR_CODE || CHR(9) || REPLACE(REPLACE(INSTR_NAME,CHR(13),' '),CHR(10),' ') ||CHR(13) AS INSTR_NAME FROM MT_INSTRUMENT
         WHERE NEW_MAKER IS NULL AND CLASSCD <> 'NTRD' AND STATUS IN('AA','FA' )
         ORDER BY INSTR_CODE;

         EXEC SQL OPEN CASE_INSTRUMENT_FROM_INSTR_CONV_INPTRD_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_INSTRUMENT_FROM_INSTR_CONV_INPTRD_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
            if (APL_ZERO_RESULT_SET)
                break;
            element_count=strlen(chr_l_codedesc);
            count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_INSTRUMENT_FROM_INSTR_CONV_INPTRD_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      };

		 case INSTRUMENT_INSTRUCONAUT:
      {
			 if (strlen(p_param)!= 0)
         	strcpy (chr_l_str_userid,p_param);
			 else strcpy (chr_l_str_userid," ");

         
         EXEC SQL DECLARE CASE_INSTRUMENT_INSTRCONAUT_CUR CURSOR FOR
         SELECT INSTR_CODE || CHR(9) || REPLACE(REPLACE(INSTR_NAME,CHR(13),' '),CHR(10),' ') ||CHR(13) AS INSTR_NAME FROM MT_INSTRUMENT
         WHERE NEW_MAKER IS NOT NULL AND NEW_ATHR IS NULL
			AND NEW_MAKER <> :chr_l_str_userid 
			ORDER BY INSTR_CODE;

         EXEC SQL OPEN CASE_INSTRUMENT_INSTRCONAUT_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_INSTRUMENT_INSTRCONAUT_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
           		 break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_INSTRUMENT_INSTRCONAUT_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      };

		 case INSTRUMENT_AU:
      {
         
         EXEC SQL DECLARE CASE_INSTRUMENT_AU_CUR CURSOR FOR
			SELECT INSTR_CODE || CHR(9) || REPLACE(REPLACE(INSTR_NAME,CHR(13),' '),CHR(10),' ') ||CHR(13) AS INSTR_NAME FROM MT_INSTRUMENT
         WHERE STATUS IN( 'AA', 'UU') 
			ORDER BY INSTR_CODE;

         EXEC SQL OPEN CASE_INSTRUMENT_AU_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_INSTRUMENT_AU_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
           		 break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_INSTRUMENT_AU_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      };
	
			
		 case INSTRUMENT_AINQ:
      {
         
         EXEC SQL DECLARE CASE_INSTRUMENT_AINQ_CUR CURSOR FOR
         SELECT INSTR_CODE || CHR(9) || REPLACE(REPLACE(INSTR_NAME,CHR(13),' '),CHR(10),' ') ||CHR(13) AS INSTR_NAME FROM MT_INSTRUMENT
         WHERE STATUS IN( 'AA', 'UU', 'FA')
         ORDER BY INSTR_CODE;

         EXEC SQL OPEN CASE_INSTRUMENT_AINQ_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_INSTRUMENT_AINQ_CUR
            INTO chr_l_codedesc:i_codedesc;
				IS_ANY_ORA_ERROR
            if (APL_ZERO_RESULT_SET)
                break;
            element_count=strlen(chr_l_codedesc);
            count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_INSTRUMENT_AINQ_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      };


		 case INSTRUMENT_INQ_ALL_INSTRU:
		 
      {
         
         EXEC SQL DECLARE CASE_INSTRUMENT_INQ_ALL_INSTR_CUR CURSOR FOR
			SELECT INSTR_CODE || CHR(9) || REPLACE(REPLACE(INSTR_NAME,CHR(13),' '),CHR(10),' ') ||CHR(13) AS INSTR_NAME FROM MT_INSTRUMENT
         ORDER BY INSTR_CODE;

         EXEC SQL OPEN CASE_INSTRUMENT_INQ_ALL_INSTR_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_INSTRUMENT_INQ_ALL_INSTR_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
           		 break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_INSTRUMENT_INQ_ALL_INSTR_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      };

		 case INSTRUMENT_ENT_INSTR: 
      {
         
         EXEC SQL DECLARE CASE_INSTRUMENT_ENT_INSTR_CUR CURSOR FOR
			SELECT DISTINCT a.instr_code,a.INSTR_CODE || CHR(9) || REPLACE(REPLACE(b.INSTR_NAME,CHR(13),' '),CHR(10),' ') ||CHR(13) AS INSTR_NAME 
			FROM CAEVENT a, MT_INSTRUMENT b 
			WHERE a.INSTR_CODE = b.INSTR_CODE
         AND b.STATUS IN( 'AA' ,'UU ')
         ORDER BY a.INSTR_CODE;

         EXEC SQL OPEN CASE_INSTRUMENT_ENT_INSTR_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_INSTRUMENT_ENT_INSTR_CUR
            INTO int_l_dummy:i_dummy,chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
           		 break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)

               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_INSTRUMENT_ENT_INSTR_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      };
		
		 case INSTRUMENT_INSTRU_ALL_DEAL:
      {
         
         EXEC SQL DECLARE CASE_INSTRUMENT_INSTR_ALL_TRD_CUR CURSOR FOR
			SELECT INSTR_CODE || CHR(9) || REPLACE(REPLACE(INSTR_NAME,CHR(13),' '),CHR(10),' ') ||CHR(13) AS INSTR_NAME FROM MT_INSTRUMENT
         WHERE CLASSCD <> 'NTRD' AND STATUS = 'AA'
         ORDER BY INSTR_CODE;

         EXEC SQL OPEN CASE_INSTRUMENT_INSTR_ALL_TRD_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_INSTRUMENT_INSTR_ALL_TRD_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
            if (APL_ZERO_RESULT_SET)
                break;
            element_count=strlen(chr_l_codedesc);
            count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_INSTRUMENT_INSTR_ALL_TRD_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      };
	
		case INSTRUMENT_ISSUER: 
		{
         
         EXEC SQL DECLARE CASE_INSTRUMENT_ISSUER_CUR CURSOR FOR
         SELECT CMP_CODE || CHR(9) || INSTR_CODE || CHR(13) FROM MT_INSTRUMENT
			WHERE STATUS = 'AA'
			AND CMP_CODE IS NOT NULL 
         ORDER BY CMP_CODE, INSTR_CODE;
			
			EXEC SQL OPEN CASE_INSTRUMENT_ISSUER_CUR;
			IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_INSTRUMENT_ISSUER_CUR
			   INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
            if (APL_ZERO_RESULT_SET)
                break;
            element_count=strlen(chr_l_codedesc);
            count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_INSTRUMENT_ISSUER_CUR;
				IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      };	

		 case LOCATION_NULL:
		 
      {
         
         EXEC SQL DECLARE CASE_LOCATION_NULL_CUR CURSOR FOR
			SELECT CONCAT(CONCAT(CONCAT(LOCATION_CD,CHR(9)),LOCATION_DESC),CHR(13)) 
			FROM MT_LOCATION 
			ORDER BY LOCATION_CD;

         EXEC SQL OPEN CASE_LOCATION_NULL_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_LOCATION_NULL_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
           		 break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_LOCATION_NULL_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      };

 		case LOCATION_ELSE:
      {
         
        	 EXEC SQL DECLARE CASE_LOCATION_ELSE_CUR CURSOR FOR
		    SELECT CONCAT(CONCAT(CONCAT(LOCATION_CD,CHR(9)),LOCATION_DESC),CHR(13))
          FROM MT_LOCATION
          WHERE STATUS = 'AA'
          ORDER BY LOCATION_CD;

        	 EXEC SQL OPEN CASE_LOCATION_ELSE_CUR;
        	 IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_LOCATION_ELSE_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
           		 break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_LOCATION_ELSE_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      };

		 case CCYNULL_IND:
      {
         
         EXEC SQL DECLARE CASE_CURRENCY_NULL_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(CURRENCY_CD,CHR(9)),CURRENCY_DESC),CHR(13))  
         FROM DL_CURRENCY
         ORDER BY CURRENCY_CD;

         EXEC SQL OPEN CASE_CURRENCY_NULL_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_CURRENCY_NULL_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
           		 break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_CURRENCY_NULL_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      };

		 case CCYELSE_IND:
		 {
         APL_GOBACK_FAIL

	    };

		 case FAILCODES_NULL:
      {
         
			

         EXEC SQL DECLARE CASE_FAILCODES_NULL_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(FAILREASON_CD,CHR(9)),FAILREASON_DET),CHR(9)),STATUS_QUAL_IND),CHR(9)),STATUS),CHR(9)),REASON_QL),CHR(9)),REASON_CD),CHR(9)),SUB_FAIL_CD),CHR(13)) 
         FROM PRO_FAILCODES 
			WHERE SUPPORT_IND = 'Y'
         ORDER BY FAILREASON_CD,SUB_FAIL_CD; 

			

         EXEC SQL OPEN CASE_FAILCODES_NULL_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_FAILCODES_NULL_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
           		 break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_FAILCODES_NULL_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      };

		 case FAILCODES_ELSE:
      {
         APL_GOBACK_FAIL

       };

		case STAT_COUNTRY: 
		{
	      if (strlen(p_param) != 0)
  		 	  strcpy (chr_l_cntry,p_param);
         else strcpy (chr_l_cntry," ");
		
     		EXEC SQL DECLARE CNTRY_DEP_CUR CURSOR FOR
			SELECT CONCAT(CONCAT(CONCAT(MAP_VAL,chr(9)),MAP_DESC),CHR(13))
    	   FROM PRO_SGENSTAT
			WHERE NATION_CODE = (SELECT NATION_CODE FROM MT_COMMON_SYS_PARAMS) and MAP_TYPE = :chr_l_cntry
			ORDER BY MAP_VAL;

     	   EXEC SQL OPEN CNTRY_DEP_CUR;
         IS_ANY_ORA_ERROR

			for(;;)
			{
   	      EXEC SQL FETCH CNTRY_DEP_CUR
      	   INTO chr_l_codedesc:i_codedesc;
         	IS_ANY_ORA_ERROR
				if ((sqlca.sqlcode == 1403) && (count >0))
        		  break;
        	   element_count=strlen(chr_l_codedesc);

			
			 

				if (count ==0)    
				{
					if ( element_count == 0 ) 
					{
						EXEC SQL DECLARE CNTRY_DEP_1_CUR CURSOR FOR
		     		 	SELECT CONCAT(CONCAT(CONCAT(MAP_VAL,chr(9)),MAP_DESC),CHR(13))
     					FROM PRO_SGENSTAT
     					WHERE NATION_CODE = 'XX' and MAP_TYPE = :chr_l_cntry
    		 	  		ORDER BY MAP_VAL;

 		    		   EXEC SQL OPEN CNTRY_DEP_1_CUR;
   		  			IS_ANY_ORA_ERROR
						for(;;)
						{
							EXEC SQL FETCH CNTRY_DEP_1_CUR
 	     	      		INTO chr_l_codedesc:i_codedesc;
    	     	   		IS_ANY_ORA_ERROR
             			if (APL_ZERO_RESULT_SET)
        	      			break;
        	  				element_count=strlen(chr_l_codedesc);
							count ++ ;
 		     				*p_row_count = count;
           				if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
	         				APL_GOBACK_FAIL
				 		}
						EXEC SQL CLOSE CNTRY_DEP_1_CUR;
 	           	   IS_ANY_ORA_ERROR
   	            APL_GOBACK_SUCCESS
					}
				}
			count++; 
         *p_row_count = count;
         if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
            APL_GOBACK_FAIL
		}
             EXEC SQL CLOSE CNTRY_DEP_CUR;
             IS_ANY_ORA_ERROR
             APL_GOBACK_SUCCESS

    };

	case STAT_ELSE:
	{
	  if (strlen(p_param) != 0)
        strcpy (chr_l_cntry,p_param);
     else strcpy (chr_l_cntry," ");

	  if (!strcmp( chr_l_cntry, "CSCODES"))
	  {
			
         EXEC SQL DECLARE CASE_STAT_ALL_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(CODE_TYP,CHR(9)),MAP_DESC),CHR(13))
         FROM CSCODE
         ORDER BY CODE_TYP;

         EXEC SQL OPEN CASE_STAT_ALL_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_STAT_ALL_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
            if (APL_ZERO_RESULT_SET)
               break;
            element_count=strlen(chr_l_codedesc);
            count ++ ;
            *p_row_count = count;
          
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_STAT_ALL_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS
		}
		
		else
		{
		  
     	  EXEC SQL DECLARE DEFAULT_CUR CURSOR FOR
	     SELECT CONCAT(CONCAT(CONCAT(MAP_VAL,chr(9)),MAP_DESC),CHR(13))
        FROM PRO_SGENSTAT
	     WHERE MAP_TYPE = :chr_l_cntry	
        ORDER BY MAP_VAL;
   
     	  EXEC SQL OPEN DEFAULT_CUR;
     	  IS_ANY_ORA_ERROR
   
        for(;;)
        {
            EXEC SQL FETCH DEFAULT_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
				if (APL_ZERO_RESULT_SET)
           		 break;
            element_count=strlen(chr_l_codedesc);
				count ++ ;
            *p_row_count = count;
				if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL

         }
			EXEC SQL CLOSE DEFAULT_CUR;
         IS_ANY_ORA_ERROR
         APL_GOBACK_SUCCESS
	 	 }

     }
		break;

	case RUCLIENT_ALL_IND: 
      {
         
         EXEC SQL DECLARE CASE_CRUACC_ALL_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(CLIENT,CHR(9)),CLIENT_NAME),CHR(13))
         FROM DL_RUCLIENT
         ORDER BY CLIENT;

         EXEC SQL OPEN CASE_CRUACC_ALL_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_CRUACC_ALL_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
            if (APL_ZERO_RESULT_SET)
               break;
            element_count=strlen(chr_l_codedesc);
            count ++ ;
            *p_row_count = count;
          
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_CRUACC_ALL_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      }
		break;

    case RULOC_ALL_IND: 
      {
         
         EXEC SQL DECLARE CASE_CRULOC_ALL_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(LOC,CHR(9)),LOC_NAME),CHR(13))
         FROM DL_RULOCATION
         ORDER BY LOC;

         EXEC SQL OPEN CASE_CRULOC_ALL_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_CRULOC_ALL_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
            if (APL_ZERO_RESULT_SET)
               break;
            element_count=strlen(chr_l_codedesc);
            count ++ ;
            *p_row_count = count;
          
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_CRULOC_ALL_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      }
		break;

	case RUPROD_ALL_IND: 
      {
         
         EXEC SQL DECLARE CASE_CRUPROD_ALL_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(PR_CODE,CHR(9)),PR_DET),CHR(13))
         FROM DL_RUPRODUCT
         ORDER BY PR_CODE;

         EXEC SQL OPEN CASE_CRUPROD_ALL_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_CRUPROD_ALL_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
            if (APL_ZERO_RESULT_SET)
               break;
            element_count=strlen(chr_l_codedesc);
            count ++ ;
            *p_row_count = count;
          
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_CRUPROD_ALL_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      }
		break;

case RUSRN_ALL_IND: 
      {
         
         EXEC SQL DECLARE CASE_CRUSRN_ALL_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(STAT_REG_NO,CHR(9)),INSTR_CODE),CHR(13))
         FROM DL_RUSRN
         ORDER BY STAT_REG_NO;

         EXEC SQL OPEN CASE_CRUSRN_ALL_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_CRUSRN_ALL_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
            if (APL_ZERO_RESULT_SET)
               break;
            element_count=strlen(chr_l_codedesc);
            count ++ ;
            *p_row_count = count;
          
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_CRUSRN_ALL_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      }
		break;

case RUINSTR_ALL_IND: 
      {
         
         EXEC SQL DECLARE CASE_CRUINSTR_ALL_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(INSTR_CODE,CHR(9)),INSTR_NAME),CHR(13))
         FROM DL_RUINSTRUMENT
         ORDER BY INSTR_CODE;

         EXEC SQL OPEN CASE_CRUINSTR_ALL_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_CRUINSTR_ALL_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
            if (APL_ZERO_RESULT_SET)
               break;
            element_count=strlen(chr_l_codedesc);
            count ++ ;
            *p_row_count = count;
          
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_CRUINSTR_ALL_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      }
		break;

case RUCLIENT_UAUTH_IND: 
      {
         
         EXEC SQL DECLARE CASE_CRUUNAUTH_ACC_CUR CURSOR FOR 
         SELECT CONCAT(CONCAT(CONCAT(CLIENT,CHR(9)),CLIENT_NAME),CHR(13)) 
         FROM DL_RUCLIENT 
	 WHERE RU_CLIENT_STAT = 'UU' 
         ORDER BY CLIENT;

         EXEC SQL OPEN CASE_CRUUNAUTH_ACC_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_CRUUNAUTH_ACC_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
            if (APL_ZERO_RESULT_SET)
               break;
            element_count=strlen(chr_l_codedesc);
            count ++ ;
            *p_row_count = count;
          
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_CRUUNAUTH_ACC_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      }
		break;

case RULOC_UAUTH_IND: 
      {
         
         EXEC SQL DECLARE CASE_CRUUNAUTH_LOC_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(LOC,CHR(9)),LOC_NAME),CHR(13))
         FROM DL_RULOCATION
	 WHERE RU_LOC_STAT = 'UU'
         ORDER BY LOC;

         EXEC SQL OPEN CASE_CRUUNAUTH_LOC_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_CRUUNAUTH_LOC_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
            if (APL_ZERO_RESULT_SET)
               break;
            element_count=strlen(chr_l_codedesc);
            count ++ ;
            *p_row_count = count;
          
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_CRUUNAUTH_LOC_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      }
		break;


case RUPROD_UAUTH_IND: 
      {
         
         EXEC SQL DECLARE CASE_CRUUNAUTH_PROD_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(PR_CODE,CHR(9)),PR_DET),CHR(13))
         FROM DL_RUPRODUCT
	 WHERE STATUS = 'UU' 
         ORDER BY PR_CODE;

         EXEC SQL OPEN CASE_CRUUNAUTH_PROD_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_CRUUNAUTH_PROD_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
            if (APL_ZERO_RESULT_SET)
               break;
            element_count=strlen(chr_l_codedesc);
            count ++ ;
            *p_row_count = count;
          
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_CRUUNAUTH_PROD_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      }
		break;

case RUSRN_UAUTH_IND: 
      {
         
         EXEC SQL DECLARE CASE_CRUUNAUTH_SRN_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(STAT_REG_NO,CHR(9)),INSTR_CODE),CHR(13))
         FROM DL_RUSRN
	 WHERE SRN_STAT = 'UU' 
         ORDER BY STAT_REG_NO;

         EXEC SQL OPEN CASE_CRUUNAUTH_SRN_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_CRUUNAUTH_SRN_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
            if (APL_ZERO_RESULT_SET)
               break;
            element_count=strlen(chr_l_codedesc);
            count ++ ;
            *p_row_count = count;
          
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_CRUUNAUTH_SRN_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      }
		break;

case RUINSTR_UAUTH_IND: 
      {
         
         EXEC SQL DECLARE CASE_CRUUNAUTH_INSTR_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(INSTR_CODE,CHR(9)),INSTR_NAME),CHR(13))
         FROM DL_RUINSTRUMENT
	 WHERE RU_STATUS = 'UU'
         ORDER BY INSTR_CODE;

         EXEC SQL OPEN CASE_CRUUNAUTH_INSTR_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_CRUUNAUTH_INSTR_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
            if (APL_ZERO_RESULT_SET)
               break;
            element_count=strlen(chr_l_codedesc);
            count ++ ;
            *p_row_count = count;
          
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_CRUUNAUTH_INSTR_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS
      }
		break;

	case RUCLIENT_AUTH_IND: 
      {
         
         EXEC SQL DECLARE CASE_CRUAUTH_ACC_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(CLIENT,CHR(9)),CLIENT_NAME),CHR(13))
         FROM DL_RUCLIENT
	 WHERE RU_CLIENT_STAT = 'AA' 
         ORDER BY CLIENT;

         EXEC SQL OPEN CASE_CRUAUTH_ACC_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_CRUAUTH_ACC_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
            if (APL_ZERO_RESULT_SET)
               break;
            element_count=strlen(chr_l_codedesc);
            count ++ ;
            *p_row_count = count;
          
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_CRUAUTH_ACC_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      }
		break;

case RULOC_IND: 
      {
         
         EXEC SQL DECLARE CASE_CRUAUTH_LOC_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(LOC,CHR(9)),LOC_NAME),CHR(13))
         FROM DL_RULOCATION
	 WHERE RU_LOC_STAT = 'AA'
         ORDER BY LOC; 

         EXEC SQL OPEN CASE_CRUAUTH_LOC_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_CRUAUTH_LOC_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
            if (APL_ZERO_RESULT_SET)
               break;
            element_count=strlen(chr_l_codedesc);
            count ++ ;
            *p_row_count = count;
          
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_CRUAUTH_LOC_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      }
		break;


case RUPROD_AUTH_IND: 
      {
         
         EXEC SQL DECLARE CASE_CRUAUTH_PROD_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(PR_CODE,CHR(9)),PR_DET),CHR(13))
         FROM DL_RUPRODUCT
	 WHERE STATUS = 'AA'
         ORDER BY PR_CODE;

         EXEC SQL OPEN CASE_CRUAUTH_PROD_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_CRUAUTH_PROD_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
            if (APL_ZERO_RESULT_SET)
               break;
            element_count=strlen(chr_l_codedesc);
            count ++ ;
            *p_row_count = count;
          
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_CRUAUTH_PROD_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      }
		break;

case RUSRN_AUTHL_IND: 
      {
         
         EXEC SQL DECLARE CASE_CRUAUTH_SRN_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(STAT_REG_NO,CHR(9)),INSTR_CODE),CHR(13))
         FROM DL_RUSRN
	 WHERE SRN_STAT = 'AA' 
         ORDER BY STAT_REG_NO;

         EXEC SQL OPEN CASE_CRUAUTH_SRN_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_CRUAUTH_SRN_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
            if (APL_ZERO_RESULT_SET)
               break;
            element_count=strlen(chr_l_codedesc);
            count ++ ;
            *p_row_count = count;
          
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_CRUAUTH_SRN_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      }
		break;


case RUINSTR_AUTH_IND: 
      {
         
         EXEC SQL DECLARE CASE_CRUAUTH_INSTR_CUR CURSOR FOR
         SELECT CONCAT(CONCAT(CONCAT(INSTR_CODE,CHR(9)),INSTR_NAME),CHR(13))
         FROM DL_RUINSTRUMENT
	 WHERE RU_STATUS = 'AA'
         ORDER BY INSTR_CODE;

         EXEC SQL OPEN CASE_CRUAUTH_INSTR_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_CRUAUTH_INSTR_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
            if (APL_ZERO_RESULT_SET)
               break;
            element_count=strlen(chr_l_codedesc);
            count ++ ;
            *p_row_count = count;
          
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_CRUAUTH_INSTR_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      }
		break;

case RUSRN_DIST_IND: 
      {
         
         EXEC SQL DECLARE CASE_CRUSRN_DIST_CUR CURSOR FOR
         SELECT DISTINCT STAT_REG_NO || CHR(9) || STAT_REG_NO || CHR(13) , STAT_REG_NO
         FROM DL_RUSRN
         ORDER BY STAT_REG_NO;

         EXEC SQL OPEN CASE_CRUSRN_DIST_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_CRUSRN_DIST_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
            if (APL_ZERO_RESULT_SET)
               break;
            element_count=strlen(chr_l_codedesc);
            count ++ ;
            *p_row_count = count;
          
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_CRUSRN_DIST_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      }
		break;
case LOC_NOTIN_RULOC: 
		{
			
			EXEC SQL DECLARE CASE_CRULOCNINP CURSOR FOR
			SELECT CONCAT(CONCAT(CONCAT(LOCATION_CD,CHR(9)),LOCATION_DESC),CHR(13)) from MT_LOCATION A 
			where STATUS = 'AA' and not exists (select 1 from DL_RULOCATION B 
			where A.location_cd = B.LOC) order by location_cd;

			EXEC SQL OPEN CASE_CRULOCNINP;
			IS_ANY_ORA_ERROR

			for(;;)
			{
            EXEC SQL FETCH CASE_CRULOCNINP 
				INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
            if (APL_ZERO_RESULT_SET)
               break;
            element_count=strlen(chr_l_codedesc);
            count ++ ;
            *p_row_count = count;
          
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_CRULOCNINP;
				IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      }
      break;
case SEC_NOTIN_RUINSTR: 
		{
         
         EXEC SQL DECLARE CASE_CRUINSTRINP CURSOR FOR
			SELECT INSTR_CODE || CHR(9) || REPLACE(REPLACE(INSTR_NAME,CHR(13),' '),CHR(10),' ') ||CHR(13) AS INSTR_NAME FROM
			MT_INSTRUMENT A WHERE STATUS = 'AA' and not exists (select 1 from DL_RUINSTRUMENT B 
			where A.INSTR_CODE = B.INSTR_CODE ) 
			ORDER BY A.INSTR_CODE;

			 EXEC SQL OPEN CASE_CRUINSTRINP;
			 IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_CRUINSTRINP
				INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
            if (APL_ZERO_RESULT_SET)
               break;
            element_count=strlen(chr_l_codedesc);
            count ++ ;
            *p_row_count = count;
          
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_CRUINSTRINP;
				IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

      }
		break;
  
   case EURO_MESSAGE: 
      {
         
         EXEC SQL DECLARE CASE_EURO_MESSAGE_CUR CURSOR FOR
         SELECT DISTINCT MT_CLIENT.CLN_CODE || CHR(9)|| MT_CLIENT.CLN_NAME || CHR(13), MT_CLIENT.CLN_CODE 
         FROM MT_CLIENT , MT_MSGADDRESS 
         WHERE MT_CLIENT.CLN_CODE=MT_MSGADDRESS.CLN_CODE 
			AND MT_CLIENT.STATUS = 'AA'
         AND MT_CLIENT.CLN_BRK_ALL IN( 'B' , 'A')
			AND MT_MSGADDRESS.MSG_IDENT_NO='35'
         ORDER BY MT_CLIENT.CLN_CODE;

         EXEC SQL OPEN CASE_EURO_MESSAGE_CUR;
         IS_ANY_ORA_ERROR

         for(;;)
         {
            EXEC SQL FETCH CASE_EURO_MESSAGE_CUR
            INTO chr_l_codedesc:i_codedesc;
            IS_ANY_ORA_ERROR
            if (APL_ZERO_RESULT_SET)
               break;
            element_count=strlen(chr_l_codedesc);
            count++;
            *p_row_count = count;
            if (CO_Put_DescriptionInDCE(p_data,chr_l_codedesc,element_count)==APL_FAILURE)
               APL_GOBACK_FAIL
         }
            EXEC SQL CLOSE CASE_EURO_MESSAGE_CUR;
            IS_ANY_ORA_ERROR
            APL_GOBACK_SUCCESS

       }
	break;		 




	}

  APL_GOBACK_SUCCESS
  RETURN_SUCCESS:
  {
		CO_InsertMsg(*l_debug_info_ptr);
		strcpy(chr_l_codedesc,APL_NULL_STRING);
		p_data->push(p_data->state,chr_l_codedesc,0);
		return(APL_SUCCESS);
	}
	RETURN_FAILURE:
	{
		CO_InsertMsg(*l_debug_info_ptr);
		strcpy(chr_l_codedesc,APL_NULL_STRING);
		p_data->push(p_data->state,chr_l_codedesc,0);
		return(APL_FAILURE);
	}
}



    int	CO_Put_DescriptionInDCE(pipe_type *p_data,char *chr_l_codedesc,int element_count)
   { 	
		char              chr_l_temp_codedesc[L_CODEDESC_LEN - L_DIFF_STRING] = APL_NULL_STRING;
  		int			i;

		while(element_count != 0)
 		{
			if ( element_count > 80 )
			p_data->push(p_data->state,chr_l_codedesc,80);
			else
			{
		   	p_data->push(p_data->state,chr_l_codedesc,element_count);
		   	break;
			}
			for(i=80;chr_l_codedesc[i]!='\0';i++)
         {
         chr_l_temp_codedesc[i - L_DIFF_STRING]=chr_l_codedesc[i];
         }
         strcpy(chr_l_codedesc,chr_l_temp_codedesc);
         element_count=strlen(chr_l_codedesc);
         chr_l_temp_codedesc[0] = APL_NULL_STRING ;
      }
         return(APL_SUCCESS);

	}
