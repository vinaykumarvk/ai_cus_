




#include "stdio_64.h"
#include <string.h>
#include <stdlib.h>

#include "IV_Control_A.h"

EXEC SQL INCLUDE SQLCA;



int IV_Mod_IVACCLock(IV_CLIENT_STRUCT *p_iv_client_struct, int *int_p_retstat, 
		  DEBUG_INFO_STRUCT_H **l_debug_info_ptr)
{
	

	EXEC SQL BEGIN DECLARE SECTION;

		IV_CLIENT_STRUCT l_ivclient_struct;

		EXEC SQL VAR l_ivclient_struct.comm_a IS STRING;
		EXEC SQL VAR l_ivclient_struct.payacc_a IS STRING;
		EXEC SQL VAR l_ivclient_struct.tax_acc IS STRING;
		EXEC SQL VAR l_ivclient_struct.comm_b IS STRING;
		EXEC SQL VAR l_ivclient_struct.comm_c IS STRING;
		EXEC SQL VAR l_ivclient_struct.comm_d IS STRING;
		EXEC SQL VAR l_ivclient_struct.comm_e IS STRING;
		EXEC SQL VAR l_ivclient_struct.comm_f IS STRING;
		EXEC SQL VAR l_ivclient_struct.comm_g IS STRING;
		EXEC SQL VAR l_ivclient_struct.comm_h IS STRING;
		EXEC SQL VAR l_ivclient_struct.comm_i IS STRING;
		EXEC SQL VAR l_ivclient_struct.payacc_b IS STRING;
		EXEC SQL VAR l_ivclient_struct.maker IS STRING;
		EXEC SQL VAR l_ivclient_struct.maker_dt IS STRING;
		EXEC SQL VAR l_ivclient_struct.checker IS STRING;
		EXEC SQL VAR l_ivclient_struct.checker_dt IS STRING;
		EXEC SQL VAR l_ivclient_struct.access_stamp IS STRING;

		I_IV_CLIENT_STRUCT l_i_iv_client_struct = {0, 0, 0, 0, 0, 0, 0, 0, 
					  0, 0, 0, 0, 0, 0, 0, 0, 0};
		struct sqlca sqlca;

	EXEC SQL END DECLARE SECTION;

	#ifdef APL_THREADS
		APL_SET_CONTEXT
		EXEC SQL CONTEXT USE :my_ctx_local;
	#endif

	memset(l_ivclient_struct.comm_a, APL_NULL_CHAR, APL_CLIENT_LENGTH);
	memset(l_ivclient_struct.payacc_a, APL_NULL_CHAR, APL_CLIENT_LENGTH);
	memset(l_ivclient_struct.tax_acc, APL_NULL_CHAR, APL_CLIENT_LENGTH);
	memset(l_ivclient_struct.comm_b, APL_NULL_CHAR, APL_CLIENT_LENGTH);
	memset(l_ivclient_struct.comm_c, APL_NULL_CHAR, APL_CLIENT_LENGTH);
	memset(l_ivclient_struct.comm_d, APL_NULL_CHAR, APL_CLIENT_LENGTH);
	memset(l_ivclient_struct.comm_e, APL_NULL_CHAR, APL_CLIENT_LENGTH);
	memset(l_ivclient_struct.comm_f, APL_NULL_CHAR, APL_CLIENT_LENGTH);
	memset(l_ivclient_struct.comm_g, APL_NULL_CHAR, APL_CLIENT_LENGTH);
	memset(l_ivclient_struct.comm_h, APL_NULL_CHAR, APL_CLIENT_LENGTH);
	memset(l_ivclient_struct.comm_i, APL_NULL_CHAR, APL_CLIENT_LENGTH);
	memset(l_ivclient_struct.payacc_b, APL_NULL_CHAR, APL_CLIENT_LENGTH);
	memset(l_ivclient_struct.maker, APL_NULL_CHAR, APL_USERID_LEN);
	memset(l_ivclient_struct.maker_dt, APL_NULL_CHAR, APL_DATE_LEN);
	memset(l_ivclient_struct.checker, APL_NULL_CHAR, APL_USERID_LEN);
	memset(l_ivclient_struct.checker_dt, APL_NULL_CHAR, APL_DATE_LEN);
	memset(l_ivclient_struct.access_stamp, APL_NULL_CHAR, APL_DATE_LEN);

	EXEC SQL SELECT COMM_A, PAYACC_A, MAKER, MAKER_DT, ACCESS_STAMP, 
			CHECKER, CHECKER_DT, COMM_B, COMM_C, COMM_D, 
			COMM_E, COMM_F, COMM_G, COMM_H, COMM_I, 
			TAX_ACC, PAYACC_B
		 INTO :l_ivclient_struct INDICATOR :l_i_iv_client_struct
		 FROM IV_CLIENT
		 FOR UPDATE OF ACCESS_STAMP;

	if ( sqlca.sqlcode < 0 )
	{
		char chr_l_buffer[KEY_LENGTH];

		memset(chr_l_buffer, APL_NULL_CHAR, KEY_LENGTH);

		ltoa_r(sqlca.sqlcode, chr_l_buffer, KEY_LENGTH - 1);

		*int_p_retstat = IV_CRITCAL_ERROR_IND;

		CO_InsertErr(l_debug_info_ptr, DB_ERR_NO, chr_l_buffer, 
			       APL_NULL_STRING, APL_NULL_STRING, 
			       __LINE__, __FILE__);

		APL_GOBACK_FAIL
	}
	else if ( sqlca.sqlcode == 1403 )
	{
		*int_p_retstat = IV_NO_DATA_FOUND_ERR;

		APL_GOBACK_FAIL
	}

	if ( strcmp(l_ivclient_struct.access_stamp, p_iv_client_struct->access_stamp) )
	{
		*int_p_retstat = IV_CRITCAL_ERROR_IND;

		CO_InsertErr(l_debug_info_ptr, ERR_ACCESSSTAMP_CHGD, 
			       APL_NULL_STRING, APL_NULL_STRING, 
			       APL_NULL_STRING, __LINE__, __FILE__);

		APL_GOBACK_FAIL
	}

	if ( l_i_iv_client_struct.i_comm_b == -1 )
	{
		*int_p_retstat = IV_COLUMN_NULL_ERR;

		strcpy(l_ivclient_struct.comm_b, " ");
	}

	if ( l_i_iv_client_struct.i_comm_c == -1 )
	{
		*int_p_retstat = IV_COLUMN_NULL_ERR;

		strcpy(l_ivclient_struct.comm_c, " ");
	}

	if ( l_i_iv_client_struct.i_comm_d == -1 )
	{
		*int_p_retstat = IV_COLUMN_NULL_ERR;

		strcpy(l_ivclient_struct.comm_d, " ");
	}

	if ( l_i_iv_client_struct.i_comm_e == -1 )
	{
		*int_p_retstat = IV_COLUMN_NULL_ERR;

		strcpy(l_ivclient_struct.comm_e, " ");
	}

	if ( l_i_iv_client_struct.i_comm_f == -1 )
	{
		*int_p_retstat = IV_COLUMN_NULL_ERR;

		strcpy(l_ivclient_struct.comm_f, " ");
	}

	if ( l_i_iv_client_struct.i_comm_g == -1 )
	{
		*int_p_retstat = IV_COLUMN_NULL_ERR;

		strcpy(l_ivclient_struct.comm_g, " ");
	}

	if ( l_i_iv_client_struct.i_comm_h == -1 )
	{
		*int_p_retstat = IV_COLUMN_NULL_ERR;

		strcpy(l_ivclient_struct.comm_h, " ");
	}

	if ( l_i_iv_client_struct.i_comm_i == -1 )
	{
		*int_p_retstat = IV_COLUMN_NULL_ERR;

		strcpy(l_ivclient_struct.comm_i, " ");
	}

	if ( l_i_iv_client_struct.i_ac_pymt2 == -1 )
	{
		*int_p_retstat = IV_COLUMN_NULL_ERR;

		strcpy(l_ivclient_struct.payacc_b, " ");
	}

	if ( l_i_iv_client_struct.i_checker == -1 )
	{
		*int_p_retstat = IV_COLUMN_NULL_ERR;

		strcpy(l_ivclient_struct.checker, " ");
	}

	if ( l_i_iv_client_struct.i_checker_dt == -1 )
	{
		*int_p_retstat = IV_COLUMN_NULL_ERR;

		strcpy(l_ivclient_struct.checker_dt, " ");
	}

	*p_iv_client_struct = l_ivclient_struct;

	if ( *int_p_retstat == IV_COLUMN_NULL_ERR )
	{
		APL_GOBACK_FAIL
	}

	*int_p_retstat = IV_SUCCESS;

	APL_GOBACK_SUCCESS

	RETURN_SUCCESS:

		APL_IF_DEBUG
		{
			CO_ProcMonitor(APL_OUT_FILE, "Exiting successfully out of \
IV_Mod_IVACCLock().\n", (DEBUG_INFO_STRUCT_H **)NULL, (INTL_ENV_DATA_STRUCT_H *)NULL);
		}

		return APL_SUCCESS;

	RETURN_FAILURE:

		APL_IF_DEBUG
		{
			CO_ProcMonitor(APL_OUT_FILE, "Exiting unsuccessfully out of\
IV_Mod_IVACCLock().\n", (DEBUG_INFO_STRUCT_H **)NULL, (INTL_ENV_DATA_STRUCT_H *)NULL);
		}

		return APL_FAILURE;
}



int IV_Mod_IVACCNew(const IV_CLIENT_STRUCT *p_iv_client_struct, 
		 const INTL_ENV_DATA_STRUCT_H *p_intl_envdatastruct_h, 
		 int *int_p_retstat, DEBUG_INFO_STRUCT_H **l_debug_info_ptr)
{
	

	extern int CO_RtvSysDtTime(char *chr_l_sys_date_time, 
					DEBUG_INFO_STRUCT_H **l_debug_info_ptr);

	

	char *chr_l_last = (char *)NULL;
	char chr_l_sys_date_time[APL_DATE_LEN], chr_l_sys_date[APL_DATE_LEN];
	
	EXEC SQL BEGIN DECLARE SECTION;

		IV_CLIENT_STRUCT l_ivclient_struct;

		EXEC SQL VAR l_ivclient_struct.comm_a IS STRING;
		EXEC SQL VAR l_ivclient_struct.payacc_a IS STRING;
		EXEC SQL VAR l_ivclient_struct.tax_acc IS STRING;
		EXEC SQL VAR l_ivclient_struct.comm_b IS STRING;
		EXEC SQL VAR l_ivclient_struct.comm_c IS STRING;
		EXEC SQL VAR l_ivclient_struct.comm_d IS STRING;
		EXEC SQL VAR l_ivclient_struct.comm_e IS STRING;
		EXEC SQL VAR l_ivclient_struct.comm_f IS STRING;
		EXEC SQL VAR l_ivclient_struct.comm_g IS STRING;
		EXEC SQL VAR l_ivclient_struct.comm_h IS STRING;
		EXEC SQL VAR l_ivclient_struct.comm_i IS STRING;
		EXEC SQL VAR l_ivclient_struct.payacc_b IS STRING;
		EXEC SQL VAR l_ivclient_struct.maker IS STRING;
		EXEC SQL VAR l_ivclient_struct.maker_dt IS STRING;
		EXEC SQL VAR l_ivclient_struct.checker IS STRING;
		EXEC SQL VAR l_ivclient_struct.checker_dt IS STRING;
		EXEC SQL VAR l_ivclient_struct.access_stamp IS STRING;

		I_IV_CLIENT_STRUCT l_i_iv_client_struct = {0, 0, 0, 0, 0, 0, 0, 0, 
					  0, 0, 0, 0, 0, 0, 0, 0, 0};
		struct sqlca sqlca;

	EXEC SQL END DECLARE SECTION;

	#ifdef APL_THREADS
		APL_SET_CONTEXT
		EXEC SQL CONTEXT USE :my_ctx_local;
	#endif

	memset(chr_l_sys_date, APL_NULL_CHAR, APL_DATE_LEN);
	memset(chr_l_sys_date_time, APL_NULL_CHAR, APL_DATE_LEN);

	if (APL_FAILURE == CO_RtvSysDtTime(chr_l_sys_date_time, l_debug_info_ptr))
	{
		APL_GOBACK_FAIL
	}

	strcpy(chr_l_sys_date, chr_l_sys_date_time);
	strcpy(chr_l_sys_date, strtok_r(chr_l_sys_date, " ", &chr_l_last));
	strcat(chr_l_sys_date, APL_NULL_TIME);

	memset(l_ivclient_struct.comm_a, APL_NULL_CHAR, APL_CLIENT_LENGTH);
	memset(l_ivclient_struct.payacc_a, APL_NULL_CHAR, APL_CLIENT_LENGTH);
	memset(l_ivclient_struct.tax_acc, APL_NULL_CHAR, APL_CLIENT_LENGTH);
	memset(l_ivclient_struct.comm_b, APL_NULL_CHAR, APL_CLIENT_LENGTH);
	memset(l_ivclient_struct.comm_c, APL_NULL_CHAR, APL_CLIENT_LENGTH);
	memset(l_ivclient_struct.comm_d, APL_NULL_CHAR, APL_CLIENT_LENGTH);
	memset(l_ivclient_struct.comm_e, APL_NULL_CHAR, APL_CLIENT_LENGTH);
	memset(l_ivclient_struct.comm_f, APL_NULL_CHAR, APL_CLIENT_LENGTH);
	memset(l_ivclient_struct.comm_g, APL_NULL_CHAR, APL_CLIENT_LENGTH);
	memset(l_ivclient_struct.comm_h, APL_NULL_CHAR, APL_CLIENT_LENGTH);
	memset(l_ivclient_struct.comm_i, APL_NULL_CHAR, APL_CLIENT_LENGTH);
	memset(l_ivclient_struct.payacc_b, APL_NULL_CHAR, APL_CLIENT_LENGTH);
	memset(l_ivclient_struct.maker, APL_NULL_CHAR, APL_USERID_LEN);
	memset(l_ivclient_struct.maker_dt, APL_NULL_CHAR, APL_DATE_LEN);
	memset(l_ivclient_struct.checker, APL_NULL_CHAR, APL_USERID_LEN);
	memset(l_ivclient_struct.checker_dt, APL_NULL_CHAR, APL_DATE_LEN);
	memset(l_ivclient_struct.access_stamp, APL_NULL_CHAR, APL_DATE_LEN);

	strcpy(l_ivclient_struct.comm_a, p_iv_client_struct->comm_a);
	strcpy(l_ivclient_struct.payacc_a, p_iv_client_struct->payacc_a);
	strcpy(l_ivclient_struct.tax_acc, p_iv_client_struct->tax_acc);
	strcpy(l_ivclient_struct.maker, p_intl_envdatastruct_h->usr);
	strcpy(l_ivclient_struct.maker_dt, chr_l_sys_date);
	strcpy(l_ivclient_struct.access_stamp, chr_l_sys_date_time);

	l_i_iv_client_struct.i_checker = -1;
	l_i_iv_client_struct.i_checker_dt = -1;

	if ( !strlen(p_iv_client_struct->comm_b) )
	{
		l_i_iv_client_struct.i_comm_b = -1;
	}
	else
	{
		strcpy(l_ivclient_struct.comm_b, p_iv_client_struct->comm_b);
	}

	if ( !strlen(p_iv_client_struct->comm_c) )
	{
		l_i_iv_client_struct.i_comm_c = -1;
	}
	else
	{
		strcpy(l_ivclient_struct.comm_c, p_iv_client_struct->comm_c);
	}

	if ( !strlen(p_iv_client_struct->comm_d) )
	{
		l_i_iv_client_struct.i_comm_d = -1;
	}
	else
	{
		strcpy(l_ivclient_struct.comm_d, p_iv_client_struct->comm_d);
	}

	if ( !strlen(p_iv_client_struct->comm_e) )
	{
		l_i_iv_client_struct.i_comm_e = -1;
	}
	else
	{
		strcpy(l_ivclient_struct.comm_e, p_iv_client_struct->comm_e);
	}

	if ( !strlen(p_iv_client_struct->comm_f) )
	{
		l_i_iv_client_struct.i_comm_f = -1;
	}
	else
	{
		strcpy(l_ivclient_struct.comm_f, p_iv_client_struct->comm_f);
	}

	if ( !strlen(p_iv_client_struct->comm_g) )
	{
		l_i_iv_client_struct.i_comm_g = -1;
	}
	else
	{
		strcpy(l_ivclient_struct.comm_g, p_iv_client_struct->comm_g);
	}

	if ( !strlen(p_iv_client_struct->comm_h) )
	{
		l_i_iv_client_struct.i_comm_h = -1;
	}
	else
	{
		strcpy(l_ivclient_struct.comm_h, p_iv_client_struct->comm_h);
	}

	if ( !strlen(p_iv_client_struct->comm_i) )
	{
		l_i_iv_client_struct.i_comm_i = -1;
	}
	else
	{
		strcpy(l_ivclient_struct.comm_i, p_iv_client_struct->comm_i);
	}

	if ( !strlen(p_iv_client_struct->payacc_b) )
	{
		l_i_iv_client_struct.i_ac_pymt2 = -1;
	}
	else
	{
		strcpy(l_ivclient_struct.payacc_b, p_iv_client_struct->payacc_b);
	}

	EXEC SQL INSERT INTO IV_CLIENT
		 VALUES (:l_ivclient_struct INDICATOR :l_i_iv_client_struct);

	if ( sqlca.sqlcode < 0 )
	{
		char chr_l_buffer[KEY_LENGTH];

		memset(chr_l_buffer, APL_NULL_CHAR, KEY_LENGTH);

		ltoa_r(sqlca.sqlcode, chr_l_buffer, KEY_LENGTH - 1);

		*int_p_retstat = IV_CRITCAL_ERROR_IND;

		CO_InsertErr(l_debug_info_ptr, DB_ERR_NO, chr_l_buffer, 
			       APL_NULL_STRING, APL_NULL_STRING, 
			       __LINE__, __FILE__);

		APL_GOBACK_FAIL
	}

	*int_p_retstat = IV_SUCCESS;

	APL_GOBACK_SUCCESS

	RETURN_SUCCESS:

		APL_IF_DEBUG
		{
			CO_ProcMonitor(APL_OUT_FILE, "Exiting successfully out of \
IV_Mod_IVACCNew().\n", (DEBUG_INFO_STRUCT_H **)NULL, (INTL_ENV_DATA_STRUCT_H *)NULL);
		}

		return APL_SUCCESS;

	RETURN_FAILURE:

		APL_IF_DEBUG
		{
			CO_ProcMonitor(APL_OUT_FILE, "Exiting unsuccessfully out of\
IV_Mod_IVACCNew().\n", (DEBUG_INFO_STRUCT_H **)NULL, (INTL_ENV_DATA_STRUCT_H *)NULL);
		}

		return APL_FAILURE;
}



int IV_Mod_IVACCChg(const IV_CLIENT_STRUCT *p_iv_client_struct, 
		 const INTL_ENV_DATA_STRUCT_H *p_intl_envdatastruct_h, 
		 int *int_p_retstat, DEBUG_INFO_STRUCT_H **l_debug_info_ptr)
{
	

	extern int CO_RtvSysDtTime(char *chr_l_sys_date_time, 
					DEBUG_INFO_STRUCT_H **l_debug_info_ptr);

	

	char *chr_l_last = (char *)NULL;

	EXEC SQL BEGIN DECLARE SECTION;

		char h_sys_dt[APL_DATE_LEN], chr_h_sys_date_time[APL_DATE_LEN];
		IV_CLIENT_STRUCT l_ivclient_struct;

		EXEC SQL VAR l_ivclient_struct.comm_a IS STRING;
		EXEC SQL VAR l_ivclient_struct.payacc_a IS STRING;
		EXEC SQL VAR l_ivclient_struct.tax_acc IS STRING;
		EXEC SQL VAR l_ivclient_struct.comm_b IS STRING;
		EXEC SQL VAR l_ivclient_struct.comm_c IS STRING;
		EXEC SQL VAR l_ivclient_struct.comm_d IS STRING;
		EXEC SQL VAR l_ivclient_struct.comm_e IS STRING;
		EXEC SQL VAR l_ivclient_struct.comm_f IS STRING;
		EXEC SQL VAR l_ivclient_struct.comm_g IS STRING;
		EXEC SQL VAR l_ivclient_struct.comm_h IS STRING;
		EXEC SQL VAR l_ivclient_struct.comm_i IS STRING;
		EXEC SQL VAR l_ivclient_struct.payacc_b IS STRING;
		EXEC SQL VAR l_ivclient_struct.maker IS STRING;
		EXEC SQL VAR l_ivclient_struct.maker_dt IS STRING;
		EXEC SQL VAR l_ivclient_struct.checker IS STRING;
		EXEC SQL VAR l_ivclient_struct.checker_dt IS STRING;
		EXEC SQL VAR l_ivclient_struct.access_stamp IS STRING;

		I_IV_CLIENT_STRUCT l_i_iv_client_struct = {0, 0, 0, 0, 0, 0, 0, 0, 
					  0, 0, 0, 0, 0, 0, 0, 0, 0};
		struct sqlca sqlca;

	EXEC SQL END DECLARE SECTION;

	#ifdef APL_THREADS
		APL_SET_CONTEXT
		EXEC SQL CONTEXT USE :my_ctx_local;
	#endif

	memset(h_sys_dt, APL_NULL_CHAR, APL_DATE_LEN);
	memset(chr_h_sys_date_time, APL_NULL_CHAR, APL_DATE_LEN);

	if (APL_FAILURE == CO_RtvSysDtTime(chr_h_sys_date_time, l_debug_info_ptr))
	{
		APL_GOBACK_FAIL
	}

	strcpy(h_sys_dt, chr_h_sys_date_time);
	strcpy(h_sys_dt, strtok_r(h_sys_dt, " ", &chr_l_last));
	strcat(h_sys_dt, APL_NULL_TIME);

	if ( !strcmp(p_intl_envdatastruct_h->h_mode, APL_FUNC_AUTHORISE) )
	{
		EXEC SQL UPDATE IV_CLIENT
			 SET CHECKER = :p_intl_envdatastruct_h->usr, 
			     CHECKER_DT = :h_sys_dt, 
			     ACCESS_STAMP = :chr_h_sys_date_time
			 WHERE (ACCESS_STAMP = :p_iv_client_struct->access_stamp);
	}
	else if ( !strcmp(p_intl_envdatastruct_h->h_mode, APL_FUNC_MODIFY) )
	{
		memset(l_ivclient_struct.comm_a, APL_NULL_CHAR, APL_CLIENT_LENGTH);
		memset(l_ivclient_struct.payacc_a, APL_NULL_CHAR, APL_CLIENT_LENGTH);
		memset(l_ivclient_struct.tax_acc, APL_NULL_CHAR, APL_CLIENT_LENGTH);
		memset(l_ivclient_struct.comm_b, APL_NULL_CHAR, APL_CLIENT_LENGTH);
		memset(l_ivclient_struct.comm_c, APL_NULL_CHAR, APL_CLIENT_LENGTH);
		memset(l_ivclient_struct.comm_d, APL_NULL_CHAR, APL_CLIENT_LENGTH);
		memset(l_ivclient_struct.comm_e, APL_NULL_CHAR, APL_CLIENT_LENGTH);
		memset(l_ivclient_struct.comm_f, APL_NULL_CHAR, APL_CLIENT_LENGTH);
		memset(l_ivclient_struct.comm_g, APL_NULL_CHAR, APL_CLIENT_LENGTH);
		memset(l_ivclient_struct.comm_h, APL_NULL_CHAR, APL_CLIENT_LENGTH);
		memset(l_ivclient_struct.comm_i, APL_NULL_CHAR, APL_CLIENT_LENGTH);
		memset(l_ivclient_struct.payacc_b, APL_NULL_CHAR, APL_CLIENT_LENGTH);
		memset(l_ivclient_struct.maker, APL_NULL_CHAR, APL_USERID_LEN);
		memset(l_ivclient_struct.maker_dt, APL_NULL_CHAR, APL_DATE_LEN);
		memset(l_ivclient_struct.checker, APL_NULL_CHAR, APL_USERID_LEN);
		memset(l_ivclient_struct.checker_dt, APL_NULL_CHAR, APL_DATE_LEN);
		memset(l_ivclient_struct.access_stamp, APL_NULL_CHAR, APL_DATE_LEN);

		strcpy(l_ivclient_struct.comm_a, p_iv_client_struct->comm_a);
		strcpy(l_ivclient_struct.payacc_a, p_iv_client_struct->payacc_a);
		strcpy(l_ivclient_struct.tax_acc, p_iv_client_struct->tax_acc);
		strcpy(l_ivclient_struct.maker, p_intl_envdatastruct_h->usr);
		strcpy(l_ivclient_struct.maker_dt, h_sys_dt);
		strcpy(l_ivclient_struct.access_stamp, chr_h_sys_date_time);

		l_i_iv_client_struct.i_checker = -1;
		l_i_iv_client_struct.i_checker_dt = -1;

		if ( !strlen(p_iv_client_struct->comm_b) )
		{
			l_i_iv_client_struct.i_comm_b = -1;
		}
		else
		{
			strcpy(l_ivclient_struct.comm_b, p_iv_client_struct->comm_b);
		}

		if ( !strlen(p_iv_client_struct->comm_c) )
		{
			l_i_iv_client_struct.i_comm_c = -1;
		}
		else
		{
			strcpy(l_ivclient_struct.comm_c, p_iv_client_struct->comm_c);
		}

		if ( !strlen(p_iv_client_struct->comm_d) )
		{
			l_i_iv_client_struct.i_comm_d = -1;
		}
		else
		{
			strcpy(l_ivclient_struct.comm_d, p_iv_client_struct->comm_d);
		}

		if ( !strlen(p_iv_client_struct->comm_e) )
		{
			l_i_iv_client_struct.i_comm_e = -1;
		}
		else
		{
			strcpy(l_ivclient_struct.comm_e, p_iv_client_struct->comm_e);
		}

		if ( !strlen(p_iv_client_struct->comm_f) )
		{
			l_i_iv_client_struct.i_comm_f = -1;
		}
		else
		{
			strcpy(l_ivclient_struct.comm_f, p_iv_client_struct->comm_f);
		}

		if ( !strlen(p_iv_client_struct->comm_g) )
		{
			l_i_iv_client_struct.i_comm_g = -1;
		}
		else
		{
			strcpy(l_ivclient_struct.comm_g, p_iv_client_struct->comm_g);
		}

		if ( !strlen(p_iv_client_struct->comm_h) )
		{
			l_i_iv_client_struct.i_comm_h = -1;
		}
		else
		{
			strcpy(l_ivclient_struct.comm_h, p_iv_client_struct->comm_h);
		}

		if ( !strlen(p_iv_client_struct->comm_i) )
		{
			l_i_iv_client_struct.i_comm_i = -1;
		}
		else
		{
			strcpy(l_ivclient_struct.comm_i, p_iv_client_struct->comm_i);
		}

		if ( !strlen(p_iv_client_struct->payacc_b) )
		{
			l_i_iv_client_struct.i_ac_pymt2 = -1;
		}
		else
		{
			strcpy(l_ivclient_struct.payacc_b, p_iv_client_struct->payacc_b);
		}

		EXEC SQL UPDATE IV_CLIENT
			 SET COMM_A = :l_ivclient_struct.comm_a 
					INDICATOR :l_i_iv_client_struct.i_comm_a, 
			     COMM_B = :l_ivclient_struct.comm_b 
					INDICATOR :l_i_iv_client_struct.i_comm_b, 
			     COMM_C = :l_ivclient_struct.comm_c 
					INDICATOR :l_i_iv_client_struct.i_comm_c, 
			     COMM_D = :l_ivclient_struct.comm_d 
					INDICATOR :l_i_iv_client_struct.i_comm_d, 
			     COMM_E = :l_ivclient_struct.comm_e 
					INDICATOR :l_i_iv_client_struct.i_comm_e, 
			     COMM_F = :l_ivclient_struct.comm_f 
					INDICATOR :l_i_iv_client_struct.i_comm_f, 
			     COMM_G = :l_ivclient_struct.comm_g 
					INDICATOR :l_i_iv_client_struct.i_comm_g, 
			     COMM_H = :l_ivclient_struct.comm_h 
					INDICATOR :l_i_iv_client_struct.i_comm_h, 
			     COMM_I = :l_ivclient_struct.comm_i 
					INDICATOR :l_i_iv_client_struct.i_comm_i, 
			     PAYACC_A = :l_ivclient_struct.payacc_a 
					INDICATOR :l_i_iv_client_struct.i_ac_pymt1, 
			     PAYACC_B = :l_ivclient_struct.payacc_b 
					INDICATOR :l_i_iv_client_struct.i_ac_pymt2, 
			     TAX_ACC = :l_ivclient_struct.tax_acc 
					INDICATOR :l_i_iv_client_struct.i_tax_acc, 
			     MAKER = :l_ivclient_struct.maker 
					INDICATOR :l_i_iv_client_struct.i_maker, 
			     MAKER_DT = :l_ivclient_struct.maker_dt 
					INDICATOR :l_i_iv_client_struct.i_maker_dt, 
			     CHECKER = :l_ivclient_struct.checker 
					INDICATOR :l_i_iv_client_struct.i_checker, 
			     CHECKER_DT = :l_ivclient_struct.checker_dt 
					INDICATOR :l_i_iv_client_struct.i_checker_dt, 
			     ACCESS_STAMP = :l_ivclient_struct.access_stamp 
					INDICATOR :l_i_iv_client_struct.i_access_stamp
		 WHERE (ACCESS_STAMP = :p_iv_client_struct->access_stamp);
	}

	if ( sqlca.sqlcode < 0 )
	{
		char chr_l_buffer[KEY_LENGTH];

		memset(chr_l_buffer, APL_NULL_CHAR, KEY_LENGTH);

		ltoa_r(sqlca.sqlcode, chr_l_buffer, KEY_LENGTH - 1);

		*int_p_retstat = IV_CRITCAL_ERROR_IND;

		CO_InsertErr(l_debug_info_ptr, DB_ERR_NO, chr_l_buffer, 
			       APL_NULL_STRING, APL_NULL_STRING, 
			       __LINE__, __FILE__);

		APL_GOBACK_FAIL
	}
	else if ( sqlca.sqlcode == 1403 )
	{
		*int_p_retstat = IV_NO_DATA_FOUND_ERR;

		APL_GOBACK_FAIL
	}

	*int_p_retstat = IV_SUCCESS;

	APL_GOBACK_SUCCESS

	RETURN_SUCCESS:

		APL_IF_DEBUG
		{
			CO_ProcMonitor(APL_OUT_FILE, "Exiting successfully out of \
IV_Mod_IVACCChg().\n", (DEBUG_INFO_STRUCT_H **)NULL, (INTL_ENV_DATA_STRUCT_H *)NULL);
		}

		return APL_SUCCESS;

	RETURN_FAILURE:

		APL_IF_DEBUG
		{
			CO_ProcMonitor(APL_OUT_FILE, "Exiting unsuccessfully out of\
IV_Mod_IVACCChg().\n", (DEBUG_INFO_STRUCT_H **)NULL, (INTL_ENV_DATA_STRUCT_H *)NULL);
		}

		return APL_FAILURE;
}

/******************************Vedavati HDFCIV_002***************************************/

int IV_Mod_IVCLIENTGLLock(IV_CLIENTGL_STRUCT_H *p_iv_clientgl_struct_h, 
                                  int *int_p_retstat,DEBUG_INFO_STRUCT_H **l_debug_info_ptr)
{
	

	EXEC SQL BEGIN DECLARE SECTION;

		IV_CLIENTGL_STRUCT_H	l_ivclientgl_struct;
	IV_CLIENTGL_STRUCT_I	l_i_iv_clientgl_struct_i = { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 };  /* Bageshri -- HDFC Log 97 */ /* TAXACCOUNT added by chitrlekha for tax deduction KB_9306 */
	
	
	EXEC SQL VAR l_ivclientgl_struct.h_routac_a IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_routac_b IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_custsus IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_nseclh IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_bseclh IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_mcsclh IS STRING; /* KB_5878 MCS charuta */
	EXEC SQL VAR l_ivclientgl_struct.h_nsesetac IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_bsesetac IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_mcssetac IS STRING;  /* KB_5878 MCS charuta */
	EXEC SQL VAR l_ivclientgl_struct.h_rtgssetac IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_fortrt IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_cmsrt IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_nsrsetac IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_brok_pay IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_stt_pay IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_tds_pay IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_tds_rec IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_maker IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_maker_dt IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_checker IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_checker_dt  IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_access_stamp IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_payacc IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_payacc1 IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_casus IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_toleracc IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_recacc IS STRING;  /* Bageshri -- HDFC Log 97 */
	EXEC SQL VAR l_ivclientgl_struct.h_taxacc IS STRING; /* TAXACCOUNT added by chitrlekha for tax deduction KB_9306 */
		struct sqlca sqlca;

	EXEC SQL END DECLARE SECTION;

	#ifdef APL_THREADS
		APL_SET_CONTEXT
		EXEC SQL CONTEXT USE :my_ctx_local;
	#endif

        /* Bageshri -- HDFC Log 97 */
	memset(l_ivclientgl_struct.h_routac_a, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_routac_b, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_custsus, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_nseclh, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_bseclh, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_mcsclh, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL); /* KB_5878 MCS charuta */
	memset(l_ivclientgl_struct.h_nsesetac, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_bsesetac, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_mcssetac, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);  /* KB_5878 MCS charuta */
	memset(l_ivclientgl_struct.h_rtgssetac, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_fortrt, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_cmsrt, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_nsrsetac, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_brok_pay, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_stt_pay, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_tds_pay, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_tds_rec, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_maker, APL_NULL_CHAR, APL_USERID_LEN);
	memset(l_ivclientgl_struct.h_maker_dt, APL_NULL_CHAR, APL_DATE_LEN);
	memset(l_ivclientgl_struct.h_checker, APL_NULL_CHAR, APL_USERID_LEN);
	memset(l_ivclientgl_struct.h_checker_dt, APL_NULL_CHAR, APL_DATE_LEN);
	memset(l_ivclientgl_struct.h_access_stamp, APL_NULL_CHAR, APL_DATE_LEN);
	memset(l_ivclientgl_struct.h_payacc, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_payacc1, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_casus, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_toleracc, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_recacc, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_taxacc, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL); /* TAXACCOUNT added by chitrlekha for tax deduction KB_9306 */

        /******************************/
	

	EXEC SQL SELECT ROUTAC_A, ROUTAC_B, CUSTSUS, NSECLH, BSECLH,
			NSESETAC, BSESETAC, RTGSSETAC, FORTRT, CMSRT, 
			NSRSETAC, BROK_PAY, STT_PAY, TDS_PAY, TDS_REC,
			MAKER, MAKER_DT, ACCESS_STAMP, CHECKER, CHECKER_DT,PAYACC,PAY1ACC,CASUS,TOLERACC, RECACC, MCSCLH, MCSSETAC, TAXACCOUNT
		 INTO :l_ivclientgl_struct INDICATOR :l_i_iv_clientgl_struct_i
		  FROM IV_CLIENTGL
		 FOR UPDATE OF ACCESS_STAMP;

	printf("sqlca.sqlcode is %d\n",sqlca.sqlcode);
  //  Alert("sqlcode:%d:message:%s",sqlca.sqlcode,sqlca.sqlerrm.sqlerrmc);
	if ( sqlca.sqlcode < 0 )
	{
		char chr_l_buffer[KEY_LENGTH];

		memset(chr_l_buffer, APL_NULL_CHAR, KEY_LENGTH);

		ltoa_r(sqlca.sqlcode, chr_l_buffer, KEY_LENGTH - 1);

		*int_p_retstat = IV_CRITCAL_ERROR_IND;

		CO_InsertErr(l_debug_info_ptr, DB_ERR_NO, chr_l_buffer, 
			       APL_NULL_STRING, APL_NULL_STRING, 
			       __LINE__, __FILE__);

		APL_GOBACK_FAIL
	}
	else if ( sqlca.sqlcode == 1403 )
	{
		*int_p_retstat = IV_NO_DATA_FOUND_ERR;

		APL_GOBACK_FAIL
	}

	if ( strcmp(l_ivclientgl_struct.h_access_stamp, p_iv_clientgl_struct_h->h_access_stamp) )
	{
		*int_p_retstat = IV_CRITCAL_ERROR_IND;

		CO_InsertErr(l_debug_info_ptr, ERR_ACCESSSTAMP_CHGD, 
			       APL_NULL_STRING, APL_NULL_STRING, 
			       APL_NULL_STRING, __LINE__, __FILE__);

		APL_GOBACK_FAIL
	}

	if (l_i_iv_clientgl_struct_i.i_routac_a == -1)
	{
		strcpy(l_ivclientgl_struct.h_routac_a," ");
		*int_p_retstat == IV_COLUMN_NULL_ERR;
	}
	if (l_i_iv_clientgl_struct_i.i_routac_b == -1)
	{
		strcpy(l_ivclientgl_struct.h_routac_b," ");
		*int_p_retstat == IV_COLUMN_NULL_ERR;
	}
	if (l_i_iv_clientgl_struct_i.i_custsus == -1)
	{
		strcpy(l_ivclientgl_struct.h_custsus," ");
		*int_p_retstat = IV_COLUMN_NULL_ERR;
	}
	if (l_i_iv_clientgl_struct_i.i_nseclh == -1)
	{
		strcpy(l_ivclientgl_struct.h_nseclh," ");
		*int_p_retstat = IV_COLUMN_NULL_ERR;
	}
	if (l_i_iv_clientgl_struct_i.i_bseclh == -1)
	{
		strcpy(l_ivclientgl_struct.h_bseclh," ");
		*int_p_retstat = IV_COLUMN_NULL_ERR;
	}
	if (l_i_iv_clientgl_struct_i.i_mcsclh == -1)  /* KB_5878 MCS charuta */
	{
		strcpy(l_ivclientgl_struct.h_mcsclh," ");
		*int_p_retstat = IV_COLUMN_NULL_ERR;
	}
	if (l_i_iv_clientgl_struct_i.i_nsesetac == -1)
	{
		strcpy(l_ivclientgl_struct.h_nsesetac," ");
		*int_p_retstat = IV_COLUMN_NULL_ERR;
	}
	if (l_i_iv_clientgl_struct_i.i_bsesetac == -1)
	{
		strcpy(l_ivclientgl_struct.h_bsesetac," ");
		*int_p_retstat = IV_COLUMN_NULL_ERR;
	}
	if (l_i_iv_clientgl_struct_i.i_mcssetac == -1) /* KB_5878 MCS charuta */
	{
		strcpy(l_ivclientgl_struct.h_mcssetac," ");
		*int_p_retstat = IV_COLUMN_NULL_ERR;
	}
	if (l_i_iv_clientgl_struct_i.i_rtgssetac == -1)
	{
		strcpy(l_ivclientgl_struct.h_rtgssetac," ");
		*int_p_retstat = IV_COLUMN_NULL_ERR;
	}
	if (l_i_iv_clientgl_struct_i.i_fortrt == -1)
	{
		strcpy(l_ivclientgl_struct.h_fortrt," ");
		*int_p_retstat = IV_COLUMN_NULL_ERR;
	}
	if (l_i_iv_clientgl_struct_i.i_cmsrt == -1)
	{
		strcpy(l_ivclientgl_struct.h_cmsrt," ");
		*int_p_retstat = IV_COLUMN_NULL_ERR;
	}
	if (l_i_iv_clientgl_struct_i.i_nsrsetac == -1)
	{
		strcpy(l_ivclientgl_struct.h_nsrsetac," ");
		*int_p_retstat = IV_COLUMN_NULL_ERR;
	}
	if (l_i_iv_clientgl_struct_i.i_brok_pay == -1)
	{
		strcpy(l_ivclientgl_struct.h_brok_pay," ");
		*int_p_retstat = IV_COLUMN_NULL_ERR;	
	}
	if (l_i_iv_clientgl_struct_i.i_stt_pay == -1)
	{
		strcpy(l_ivclientgl_struct.h_stt_pay," ");
		*int_p_retstat = IV_COLUMN_NULL_ERR;	
	}
	if (l_i_iv_clientgl_struct_i.i_tds_pay == -1)
	{
		strcpy(l_ivclientgl_struct.h_tds_pay," ");
		*int_p_retstat = IV_COLUMN_NULL_ERR;	
	}
	if (l_i_iv_clientgl_struct_i.i_tds_rec == -1)
	{
		strcpy(l_ivclientgl_struct.h_tds_rec," ");
		*int_p_retstat = IV_COLUMN_NULL_ERR;	
	}
	if (l_i_iv_clientgl_struct_i.i_checker == -1)
	{
		strcpy(l_ivclientgl_struct.h_checker," ");
		*int_p_retstat = IV_COLUMN_NULL_ERR;
	}
	if (l_i_iv_clientgl_struct_i.i_checker_dt == -1)
	{
		strcpy(l_ivclientgl_struct.h_checker_dt," ");
		*int_p_retstat = IV_COLUMN_NULL_ERR;
	}
	if (l_i_iv_clientgl_struct_i.i_maker == -1)
	{
		strcpy(l_ivclientgl_struct.h_maker," ");
		*int_p_retstat = IV_COLUMN_NULL_ERR;
	}
	if (l_i_iv_clientgl_struct_i.i_maker_dt == -1)
	{
		strcpy(l_ivclientgl_struct.h_maker_dt, " ");
		*int_p_retstat = IV_COLUMN_NULL_ERR;
	}
	if (l_i_iv_clientgl_struct_i.i_access_stamp == -1)
	{
		strcpy(l_ivclientgl_struct.h_access_stamp, " ");
		*int_p_retstat = IV_COLUMN_NULL_ERR;
	}
	if (l_i_iv_clientgl_struct_i.i_payacc == -1)
	{
		strcpy(l_ivclientgl_struct.h_payacc," ");
		*int_p_retstat == IV_COLUMN_NULL_ERR;
	}
	if (l_i_iv_clientgl_struct_i.i_payacc1 == -1)
	{
		strcpy(l_ivclientgl_struct.h_payacc1," ");
		*int_p_retstat == IV_COLUMN_NULL_ERR;
	}
	if (l_i_iv_clientgl_struct_i.i_casus == -1)
	{
		strcpy(l_ivclientgl_struct.h_casus," ");
		*int_p_retstat == IV_COLUMN_NULL_ERR;
	}
	if (l_i_iv_clientgl_struct_i.i_toleracc == -1)
	{
		strcpy(l_ivclientgl_struct.h_toleracc," ");
		*int_p_retstat == IV_COLUMN_NULL_ERR;
	}
        /* Bageshri -- HDFC Log 97 */
	if (l_i_iv_clientgl_struct_i.i_recacc == -1)
	{
		strcpy(l_ivclientgl_struct.h_recacc," ");
		*int_p_retstat == IV_COLUMN_NULL_ERR;
	}
       
	 /* TAXACCOUNT added by chitrlekha for tax deduction KB_9306 */
	if (l_i_iv_clientgl_struct_i.i_taxacc == -1)
	{
		strcpy(l_ivclientgl_struct.h_taxacc," ");
		*int_p_retstat == IV_COLUMN_NULL_ERR;
	}
        /***************************/
	


	
*p_iv_clientgl_struct_h = l_ivclientgl_struct;
if (*int_p_retstat == IV_COLUMN_NULL_ERR)
{
	APL_GOBACK_FAIL;
}
*int_p_retstat = IV_SUCCESS;

APL_GOBACK_SUCCESS


	RETURN_SUCCESS:
	
	APL_IF_DEBUG
	{
		CO_ProcMonitor(APL_OUT_FILE,"Exiting out of IV_Mod_IVCLIENTGLLock successfully\n",NULL,NULL);
	}
	
	return APL_SUCCESS;

	RETURN_FAILURE:
	APL_IF_DEBUG
	{
		CO_ProcMonitor(APL_OUT_FILE,"Exiting out of IV_Mod_IVCLIENTGLLock unsuccessfully\n",NULL,NULL);
	}
	
	return APL_FAILURE;


}

/***************************** veda ***************************************/


int IV_Mod_IVCLIENTGLChg(const IV_CLIENTGL_STRUCT_H *p_iv_clientgl_struct_h, 
		 const INTL_ENV_DATA_STRUCT_H *p_intl_envdatastruct_h, 
		 int *int_p_retstat, DEBUG_INFO_STRUCT_H **l_debug_info_ptr)
{
	

	extern int CO_RtvSysDtTime(char *chr_l_sys_date_time, 
					DEBUG_INFO_STRUCT_H **l_debug_info_ptr);

	

	char *chr_l_last = (char *)NULL;
	
	char l_str_prev_pay_acc[25]; //shailesh 25-02-2008 pymt_acc of ivclientsetup should be updated as pymtacct is updated.
	char l_str_prev_pay_acc_1[25];
	short i_l_str_prev_pay_acc = 0;
	short i_l_str_prev_pay_acc_1 = 0;


	EXEC SQL BEGIN DECLARE SECTION;

		char h_sys_dt[APL_DATE_LEN], chr_h_sys_date_time[APL_DATE_LEN];

		IV_CLIENTGL_STRUCT_H	l_ivclientgl_struct;
	IV_CLIENTGL_STRUCT_I	l_i_iv_clientgl_struct_i = { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 };  /* Bageshri -- HDFC Log 97 */
	
	
	EXEC SQL VAR l_ivclientgl_struct.h_routac_a IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_routac_b IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_custsus IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_nseclh IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_bseclh IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_mcsclh IS STRING; /* KB_5878 MCS charuta */
	EXEC SQL VAR l_ivclientgl_struct.h_nsesetac IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_bsesetac IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_mcssetac IS STRING; /* KB_5878 MCS charuta */
	EXEC SQL VAR l_ivclientgl_struct.h_rtgssetac IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_fortrt IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_cmsrt IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_nsrsetac IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_brok_pay IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_stt_pay IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_tds_pay IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_tds_rec IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_maker IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_maker_dt IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_checker IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_checker_dt  IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_access_stamp IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_payacc IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_payacc1 IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_casus IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_toleracc IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_recacc IS STRING;  /* Bageshri -- HDFC Log 97 */
	EXEC SQL VAR l_ivclientgl_struct.h_taxacc IS STRING;  /* TAXACCOUNT added by chitrlekha for tax deduction KB_9306 */

		struct sqlca sqlca;


	EXEC SQL END DECLARE SECTION;

	#ifdef APL_THREADS
		APL_SET_CONTEXT
		EXEC SQL CONTEXT USE :my_ctx_local;
	#endif

	memset(h_sys_dt, APL_NULL_CHAR, APL_DATE_LEN);
	memset(chr_h_sys_date_time, APL_NULL_CHAR, APL_DATE_LEN);

	if (APL_FAILURE == CO_RtvSysDtTime(chr_h_sys_date_time, l_debug_info_ptr))
	{
		APL_GOBACK_FAIL
	}

	strcpy(h_sys_dt, chr_h_sys_date_time);
	strcpy(h_sys_dt, strtok_r(h_sys_dt, " ", &chr_l_last));
	strcat(h_sys_dt, APL_NULL_TIME);

	if ( !strcmp(p_intl_envdatastruct_h->h_mode, APL_FUNC_AUTHORISE) )
	{
		EXEC SQL UPDATE IV_CLIENTGL
			 SET CHECKER = :p_intl_envdatastruct_h->usr, 
			     CHECKER_DT = :h_sys_dt, 
			     ACCESS_STAMP = :chr_h_sys_date_time
			 WHERE (ACCESS_STAMP = :p_iv_clientgl_struct_h->h_access_stamp);
	}
	else if ( !strcmp(p_intl_envdatastruct_h->h_mode, APL_FUNC_MODIFY) )
	{
        /* Bageshri -- HDFC Log 97 */
	memset(l_ivclientgl_struct.h_routac_a, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_routac_b, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_custsus, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_nseclh, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_bseclh, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_nsesetac, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_bsesetac, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_rtgssetac, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_fortrt, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_cmsrt, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_nsrsetac, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_brok_pay, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_stt_pay, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_tds_pay, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_tds_rec, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_maker, APL_NULL_CHAR, APL_USERID_LEN);
	memset(l_ivclientgl_struct.h_maker_dt, APL_NULL_CHAR, APL_DATE_LEN);
	memset(l_ivclientgl_struct.h_checker, APL_NULL_CHAR, APL_USERID_LEN);
	memset(l_ivclientgl_struct.h_checker_dt, APL_NULL_CHAR, APL_DATE_LEN);
	memset(l_ivclientgl_struct.h_access_stamp, APL_NULL_CHAR, APL_DATE_LEN);
	memset(l_ivclientgl_struct.h_payacc, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_payacc1, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_casus, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_toleracc, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_recacc, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	/* KB_5878 MCS charuta */
    memset(l_ivclientgl_struct.h_mcsclh, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_mcssetac, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_taxacc, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL); /* TAXACCOUNT added by chitrlekha for tax deduction KB_9306 */
	
        /***********************************/


//shailesh 25-02-2008
	EXEC SQL SELECT PAYACC,PAY1ACC INTO  :l_str_prev_pay_acc:i_l_str_prev_pay_acc,
			:l_str_prev_pay_acc_1:i_l_str_prev_pay_acc_1 FROM IV_CLIENTGL ;

		
		strcpy(l_ivclientgl_struct.h_maker, p_intl_envdatastruct_h->usr);
		strcpy(l_ivclientgl_struct.h_maker_dt, h_sys_dt);
		strcpy(l_ivclientgl_struct.h_access_stamp, chr_h_sys_date_time);

		l_i_iv_clientgl_struct_i.i_checker = -1;
		l_i_iv_clientgl_struct_i.i_checker_dt = -1;

		if ( !strlen(p_iv_clientgl_struct_h->h_routac_a) )
	{
		l_i_iv_clientgl_struct_i.i_routac_a = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_routac_a, p_iv_clientgl_struct_h->h_routac_a);
	}

	if ( !strlen(p_iv_clientgl_struct_h->h_routac_b) )
	{
		l_i_iv_clientgl_struct_i.i_routac_b = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_routac_b, p_iv_clientgl_struct_h->h_routac_b);
	}

	if ( !strlen(p_iv_clientgl_struct_h->h_custsus) )
	{
		l_i_iv_clientgl_struct_i.i_custsus = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_custsus, p_iv_clientgl_struct_h->h_custsus);
	}

	if ( !strlen(p_iv_clientgl_struct_h->h_nseclh) )
	{
		l_i_iv_clientgl_struct_i.i_nseclh = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_nseclh, p_iv_clientgl_struct_h->h_nseclh);
	}

	if ( !strlen(p_iv_clientgl_struct_h->h_bseclh) )
	{
		l_i_iv_clientgl_struct_i.i_bseclh = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_bseclh, p_iv_clientgl_struct_h->h_bseclh);
	}

	if ( !strlen(p_iv_clientgl_struct_h->h_nsesetac) )
	{
		l_i_iv_clientgl_struct_i.i_nsesetac = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_nsesetac, p_iv_clientgl_struct_h->h_nsesetac);
	}

	if ( !strlen(p_iv_clientgl_struct_h->h_bsesetac) )
	{
		l_i_iv_clientgl_struct_i.i_bsesetac = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_bsesetac, p_iv_clientgl_struct_h->h_bsesetac);
	}

	if ( !strlen(p_iv_clientgl_struct_h->h_rtgssetac) )
	{
		l_i_iv_clientgl_struct_i.i_rtgssetac = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_rtgssetac, p_iv_clientgl_struct_h->h_rtgssetac);
	}

	if ( !strlen(p_iv_clientgl_struct_h->h_fortrt) )
	{
		l_i_iv_clientgl_struct_i.i_fortrt = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_fortrt, p_iv_clientgl_struct_h->h_fortrt);
	}
	if ( !strlen(p_iv_clientgl_struct_h->h_cmsrt) )
	{
		l_i_iv_clientgl_struct_i.i_cmsrt = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_cmsrt, p_iv_clientgl_struct_h->h_cmsrt);
	}
	if ( !strlen(p_iv_clientgl_struct_h->h_nsrsetac) )
	{
		l_i_iv_clientgl_struct_i.i_nsrsetac = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_nsrsetac, p_iv_clientgl_struct_h->h_nsrsetac);
	}
	if ( !strlen(p_iv_clientgl_struct_h->h_brok_pay) )
	{
		l_i_iv_clientgl_struct_i.i_brok_pay = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_brok_pay, p_iv_clientgl_struct_h->h_brok_pay);
	}
	if ( !strlen(p_iv_clientgl_struct_h->h_stt_pay) )
	{
		l_i_iv_clientgl_struct_i.i_stt_pay = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_stt_pay, p_iv_clientgl_struct_h->h_stt_pay);
	}
	if ( !strlen(p_iv_clientgl_struct_h->h_tds_pay) )
	{
		l_i_iv_clientgl_struct_i.i_tds_pay = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_tds_pay, p_iv_clientgl_struct_h->h_tds_pay);
	}
	if ( !strlen(p_iv_clientgl_struct_h->h_tds_rec) )
	{
		l_i_iv_clientgl_struct_i.i_tds_rec = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_tds_rec, p_iv_clientgl_struct_h->h_tds_rec);
	}
	if ( !strlen(p_iv_clientgl_struct_h->h_payacc) )
	{
		l_i_iv_clientgl_struct_i.i_payacc = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_payacc, p_iv_clientgl_struct_h->h_payacc);
	}
	if ( !strlen(p_iv_clientgl_struct_h->h_payacc1) )
	{
		l_i_iv_clientgl_struct_i.i_payacc1 = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_payacc1, p_iv_clientgl_struct_h->h_payacc1);
	}
	if ( !strlen(p_iv_clientgl_struct_h->h_casus) )
	{
		l_i_iv_clientgl_struct_i.i_casus = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_casus, p_iv_clientgl_struct_h->h_casus);
	}
	if ( !strlen(p_iv_clientgl_struct_h->h_toleracc) )
	{
		l_i_iv_clientgl_struct_i.i_toleracc = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_toleracc, p_iv_clientgl_struct_h->h_toleracc);
	}
        /* Bageshri -- HDFC Log 97 */
	if ( !strlen(p_iv_clientgl_struct_h->h_recacc) )
	{
		l_i_iv_clientgl_struct_i.i_recacc = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_recacc, p_iv_clientgl_struct_h->h_recacc);
	}
     /* KB_5878 MCS charuta */
	if ( !strlen(p_iv_clientgl_struct_h->h_mcsclh) )
	{
		l_i_iv_clientgl_struct_i.i_mcsclh = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_mcsclh, p_iv_clientgl_struct_h->h_mcsclh);
	}

	if ( !strlen(p_iv_clientgl_struct_h->h_mcssetac) )
	{
		l_i_iv_clientgl_struct_i.i_mcssetac = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_mcssetac, p_iv_clientgl_struct_h->h_mcssetac);
	}
 /* TAXACCOUNT added by chitrlekha for tax deduction KB_9306 */
	if ( !strlen(p_iv_clientgl_struct_h->h_taxacc) )
	{
		l_i_iv_clientgl_struct_i.i_taxacc = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_taxacc, p_iv_clientgl_struct_h->h_taxacc);
	}

        /***************************/
	


		
		
		
		EXEC SQL UPDATE IV_CLIENTGL
			 SET  ROUTAC_A= :l_ivclientgl_struct.h_routac_a
					INDICATOR :l_i_iv_clientgl_struct_i.i_routac_a, 
			     ROUTAC_B = :l_ivclientgl_struct.h_routac_b 
					INDICATOR :l_i_iv_clientgl_struct_i.i_routac_b, 
			     CUSTSUS = :l_ivclientgl_struct.h_custsus
					INDICATOR :l_i_iv_clientgl_struct_i.i_custsus, 
			     NSECLH = :l_ivclientgl_struct.h_nseclh
					INDICATOR :l_i_iv_clientgl_struct_i.i_nseclh, 
			     BSECLH = :l_ivclientgl_struct.h_bseclh
					INDICATOR :l_i_iv_clientgl_struct_i.i_bseclh, 
			     MCSCLH = :l_ivclientgl_struct.h_mcsclh
					INDICATOR :l_i_iv_clientgl_struct_i.i_mcsclh, 
			     NSESETAC = :l_ivclientgl_struct.h_nsesetac
					INDICATOR :l_i_iv_clientgl_struct_i.i_nsesetac, 
			     BSESETAC = :l_ivclientgl_struct.h_bsesetac
					INDICATOR :l_i_iv_clientgl_struct_i.i_bsesetac, 
			     MCSSETAC = :l_ivclientgl_struct.h_mcssetac
					INDICATOR :l_i_iv_clientgl_struct_i.i_mcssetac, 
			     RTGSSETAC = :l_ivclientgl_struct.h_rtgssetac
					INDICATOR :l_i_iv_clientgl_struct_i.i_rtgssetac, 
			     FORTRT = :l_ivclientgl_struct.h_fortrt
					INDICATOR :l_i_iv_clientgl_struct_i.i_fortrt, 
			     CMSRT = :l_ivclientgl_struct.h_cmsrt
					INDICATOR :l_i_iv_clientgl_struct_i.i_cmsrt, 
			     NSRSETAC = :l_ivclientgl_struct.h_nsrsetac
					INDICATOR :l_i_iv_clientgl_struct_i.i_nsrsetac, 
			     BROK_PAY = :l_ivclientgl_struct.h_brok_pay 
					INDICATOR :l_i_iv_clientgl_struct_i.i_brok_pay, 
				STT_PAY = :l_ivclientgl_struct.h_stt_pay
					INDICATOR :l_i_iv_clientgl_struct_i.i_stt_pay, 
				TDS_PAY = :l_ivclientgl_struct.h_tds_pay 
					INDICATOR :l_i_iv_clientgl_struct_i.i_tds_pay, 
				TDS_REC = :l_ivclientgl_struct.h_tds_rec
					INDICATOR :l_i_iv_clientgl_struct_i.i_tds_rec, 
								
				MAKER = :l_ivclientgl_struct.h_maker 
					INDICATOR :l_i_iv_clientgl_struct_i.i_maker, 
			     MAKER_DT = :l_ivclientgl_struct.h_maker_dt 
					INDICATOR :l_i_iv_clientgl_struct_i.i_maker_dt, 
			     CHECKER = :l_ivclientgl_struct.h_checker 
					INDICATOR :l_i_iv_clientgl_struct_i.i_checker, 
			     CHECKER_DT = :l_ivclientgl_struct.h_checker_dt 
					INDICATOR :l_i_iv_clientgl_struct_i.i_checker_dt, 
			     ACCESS_STAMP = :l_ivclientgl_struct.h_access_stamp 
					INDICATOR :l_i_iv_clientgl_struct_i.i_access_stamp,
			     PAYACC= :l_ivclientgl_struct.h_payacc
					INDICATOR :l_i_iv_clientgl_struct_i.i_payacc,
			     PAY1ACC= :l_ivclientgl_struct.h_payacc1
					INDICATOR :l_i_iv_clientgl_struct_i.i_payacc1,
			     CASUS= :l_ivclientgl_struct.h_casus
					INDICATOR :l_i_iv_clientgl_struct_i.i_casus,
			     TOLERACC= :l_ivclientgl_struct.h_toleracc
					INDICATOR :l_i_iv_clientgl_struct_i.i_toleracc,
			     RECACC= :l_ivclientgl_struct.h_recacc
					INDICATOR :l_i_iv_clientgl_struct_i.i_recacc,  /* Bageshri -- HDFC Log 97 */
			     TAXACCOUNT= :l_ivclientgl_struct.h_taxacc
					INDICATOR :l_i_iv_clientgl_struct_i.i_taxacc  /* TAXACCOUNT added by chitrlekha for tax deduction KB_9306 */
		 WHERE (ACCESS_STAMP = : p_iv_clientgl_struct_h->h_access_stamp);
	}

	if ( sqlca.sqlcode < 0 )
	{
		char chr_l_buffer[KEY_LENGTH];

		memset(chr_l_buffer, APL_NULL_CHAR, KEY_LENGTH);

		ltoa_r(sqlca.sqlcode, chr_l_buffer, KEY_LENGTH - 1);

		*int_p_retstat = IV_CRITCAL_ERROR_IND;

		CO_InsertErr(l_debug_info_ptr, DB_ERR_NO, chr_l_buffer, 
			       APL_NULL_STRING, APL_NULL_STRING, 
			       __LINE__, __FILE__);

		APL_GOBACK_FAIL
	}
	else if ( sqlca.sqlcode == 1403 )
	{
		*int_p_retstat = IV_NO_DATA_FOUND_ERR;

		APL_GOBACK_FAIL
	}

	//shailesh 25-02-2008
	if(sqlca.sqlcode == 0)
	{
		if(i_l_str_prev_pay_acc == 0)
		if(strcmp(l_str_prev_pay_acc,l_ivclientgl_struct.h_payacc))
		{
			EXEC SQL UPDATE IV_CLIENTSETUP SET PYMT_ACC = :l_ivclientgl_struct.h_payacc
					WHERE PYMT_ACC = :l_str_prev_pay_acc;
		}
		if(i_l_str_prev_pay_acc_1 == 0)
		if(strcmp(l_str_prev_pay_acc_1,l_ivclientgl_struct.h_payacc1))
		{
			EXEC SQL UPDATE IV_CLIENTSETUP SET PYMT_ACC = :l_ivclientgl_struct.h_payacc1
					WHERE PYMT_ACC = :l_str_prev_pay_acc_1;
		}

	}


	*int_p_retstat = IV_SUCCESS;

	APL_GOBACK_SUCCESS

	RETURN_SUCCESS:

		APL_IF_DEBUG
		{
			CO_ProcMonitor(APL_OUT_FILE, "Exiting successfully out of \
IV_Mod_IVCLIENTGLChg().\n", (DEBUG_INFO_STRUCT_H **)NULL, (INTL_ENV_DATA_STRUCT_H *)NULL);
		}

		return APL_SUCCESS;

	RETURN_FAILURE:

		APL_IF_DEBUG
		{
			CO_ProcMonitor(APL_OUT_FILE, "Exiting unsuccessfully out of\
IV_Mod_IVCLIENTGLChg().\n", (DEBUG_INFO_STRUCT_H **)NULL, (INTL_ENV_DATA_STRUCT_H *)NULL);
		}

		return APL_FAILURE;
}

/***************************** Vedavati HDFCIV_002 *************************************/

int IV_Mod_IVCLIENTGLNew(const IV_CLIENTGL_STRUCT_H *p_iv_clientgl_struct_h, 
		 const INTL_ENV_DATA_STRUCT_H *p_intl_envdatastruct_h, 
		 int *int_p_retstat, DEBUG_INFO_STRUCT_H **l_debug_info_ptr)
{
	

	extern int CO_RtvSysDtTime(char *chr_l_sys_date_time, 
					DEBUG_INFO_STRUCT_H **l_debug_info_ptr);

	

	char *chr_l_last = (char *)NULL;
	char chr_l_sys_date_time[APL_DATE_LEN], chr_l_sys_date[APL_DATE_LEN];
	
	EXEC SQL BEGIN DECLARE SECTION;

		IV_CLIENTGL_STRUCT_H	l_ivclientgl_struct;
	IV_CLIENTGL_STRUCT_I	l_i_iv_clientgl_struct_i = { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 };  /* Bageshri -- HDFC Log 97 */  /* TAXACCOUNT added by chitrlekha for tax deduction KB_9306 */
	
	
	EXEC SQL VAR l_ivclientgl_struct.h_routac_a IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_routac_b IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_custsus IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_nseclh IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_bseclh IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_nsesetac IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_bsesetac IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_rtgssetac IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_fortrt IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_cmsrt IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_nsrsetac IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_brok_pay IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_stt_pay IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_tds_pay IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_tds_rec IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_maker IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_maker_dt IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_checker IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_checker_dt  IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_access_stamp IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_payacc IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_payacc1 IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_casus IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_toleracc IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_recacc IS STRING;  /* Bageshri -- HDFC Log 97 */
    /* KB_5878 MCS charuta */
	EXEC SQL VAR l_ivclientgl_struct.h_mcsclh IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_mcssetac IS STRING;
	EXEC SQL VAR l_ivclientgl_struct.h_taxacc IS STRING;  /* TAXACCOUNT added by chitrlekha for tax deduction KB_9306 */
	

		struct sqlca sqlca;

	EXEC SQL END DECLARE SECTION;

	#ifdef APL_THREADS
		APL_SET_CONTEXT
		EXEC SQL CONTEXT USE :my_ctx_local;
	#endif

	memset(chr_l_sys_date, APL_NULL_CHAR, APL_DATE_LEN);
	memset(chr_l_sys_date_time, APL_NULL_CHAR, APL_DATE_LEN);

	if (APL_FAILURE == CO_RtvSysDtTime(chr_l_sys_date_time, l_debug_info_ptr))
	{
		APL_GOBACK_FAIL
	}

	strcpy(chr_l_sys_date, chr_l_sys_date_time);
	strcpy(chr_l_sys_date, strtok_r(chr_l_sys_date, " ", &chr_l_last));
	strcat(chr_l_sys_date, APL_NULL_TIME);

        /* Bageshri -- HDFC Log 97 */
	memset(l_ivclientgl_struct.h_routac_a, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_routac_b, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_custsus, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_nseclh, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_bseclh, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_nsesetac, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_bsesetac, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_rtgssetac, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_fortrt, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_cmsrt, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_nsrsetac, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_brok_pay, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_stt_pay, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_tds_pay, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_tds_rec, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);

	memset(l_ivclientgl_struct.h_maker, APL_NULL_CHAR, APL_USERID_LEN);
	memset(l_ivclientgl_struct.h_maker_dt, APL_NULL_CHAR, APL_DATE_LEN);
	memset(l_ivclientgl_struct.h_checker, APL_NULL_CHAR, APL_USERID_LEN);
	memset(l_ivclientgl_struct.h_checker_dt, APL_NULL_CHAR, APL_DATE_LEN);
	memset(l_ivclientgl_struct.h_access_stamp, APL_NULL_CHAR, APL_DATE_LEN);

	memset(l_ivclientgl_struct.h_payacc, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_payacc1, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_casus, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_toleracc, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_recacc, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
    /* KB_5878 MCS charuta */
	memset(l_ivclientgl_struct.h_mcsclh, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_mcssetac, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL);
	memset(l_ivclientgl_struct.h_taxacc, APL_NULL_CHAR, APL_CLIENT_LENGTH_GL); /* TAXACCOUNT added by chitrlekha for tax deduction KB_9306 */
    
        /************************************/	

	
	
	
	strcpy(l_ivclientgl_struct.h_maker, p_intl_envdatastruct_h->usr);
	strcpy(l_ivclientgl_struct.h_maker_dt, chr_l_sys_date);
	strcpy(l_ivclientgl_struct.h_access_stamp, chr_l_sys_date_time);

	l_i_iv_clientgl_struct_i.i_checker = -1;
	l_i_iv_clientgl_struct_i.i_checker_dt = -1;

	if ( !strlen(p_iv_clientgl_struct_h->h_routac_a) )
	{
		l_i_iv_clientgl_struct_i.i_routac_a = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_routac_a, p_iv_clientgl_struct_h->h_routac_a);
	}

	if ( !strlen(p_iv_clientgl_struct_h->h_routac_b) )
	{
		l_i_iv_clientgl_struct_i.i_routac_b = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_routac_b, p_iv_clientgl_struct_h->h_routac_b);
	}

	if ( !strlen(p_iv_clientgl_struct_h->h_custsus) )
	{
		l_i_iv_clientgl_struct_i.i_custsus = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_custsus, p_iv_clientgl_struct_h->h_custsus);
	}

	if ( !strlen(p_iv_clientgl_struct_h->h_nseclh) )
	{
		l_i_iv_clientgl_struct_i.i_nseclh = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_nseclh, p_iv_clientgl_struct_h->h_nseclh);
	}

	if ( !strlen(p_iv_clientgl_struct_h->h_bseclh) )
	{
		l_i_iv_clientgl_struct_i.i_bseclh = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_bseclh, p_iv_clientgl_struct_h->h_bseclh);
	}

	if ( !strlen(p_iv_clientgl_struct_h->h_nsesetac) )
	{
		l_i_iv_clientgl_struct_i.i_nsesetac = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_nsesetac, p_iv_clientgl_struct_h->h_nsesetac);
	}

	if ( !strlen(p_iv_clientgl_struct_h->h_bsesetac) )
	{
		l_i_iv_clientgl_struct_i.i_bsesetac = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_bsesetac, p_iv_clientgl_struct_h->h_bsesetac);
	}

	if ( !strlen(p_iv_clientgl_struct_h->h_rtgssetac) )
	{
		l_i_iv_clientgl_struct_i.i_rtgssetac = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_rtgssetac, p_iv_clientgl_struct_h->h_rtgssetac);
	}

	if ( !strlen(p_iv_clientgl_struct_h->h_fortrt) )
	{
		l_i_iv_clientgl_struct_i.i_fortrt = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_fortrt, p_iv_clientgl_struct_h->h_fortrt);
	}
	if ( !strlen(p_iv_clientgl_struct_h->h_cmsrt) )
	{
		l_i_iv_clientgl_struct_i.i_cmsrt = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_cmsrt, p_iv_clientgl_struct_h->h_cmsrt);
	}
	if ( !strlen(p_iv_clientgl_struct_h->h_nsrsetac) )
	{
		l_i_iv_clientgl_struct_i.i_nsrsetac = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_nsrsetac, p_iv_clientgl_struct_h->h_nsrsetac);
	}
	if ( !strlen(p_iv_clientgl_struct_h->h_brok_pay) )
	{
		l_i_iv_clientgl_struct_i.i_brok_pay = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_brok_pay, p_iv_clientgl_struct_h->h_brok_pay);
	}
	if ( !strlen(p_iv_clientgl_struct_h->h_stt_pay) )
	{
		l_i_iv_clientgl_struct_i.i_stt_pay = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_stt_pay, p_iv_clientgl_struct_h->h_stt_pay);
	}
	if ( !strlen(p_iv_clientgl_struct_h->h_tds_pay) )
	{
		l_i_iv_clientgl_struct_i.i_tds_pay = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_tds_pay, p_iv_clientgl_struct_h->h_tds_pay);
	}
	if ( !strlen(p_iv_clientgl_struct_h->h_tds_rec) )
	{
		l_i_iv_clientgl_struct_i.i_tds_rec = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_tds_rec, p_iv_clientgl_struct_h->h_tds_rec);
	}
	if ( !strlen(p_iv_clientgl_struct_h->h_payacc) )
	{
		l_i_iv_clientgl_struct_i.i_payacc = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_payacc, p_iv_clientgl_struct_h->h_payacc);
	}
	if ( !strlen(p_iv_clientgl_struct_h->h_payacc1) )
	{
		l_i_iv_clientgl_struct_i.i_payacc1 = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_payacc1, p_iv_clientgl_struct_h->h_payacc1);
	}
	if ( !strlen(p_iv_clientgl_struct_h->h_casus) )
	{
		l_i_iv_clientgl_struct_i.i_casus = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_casus, p_iv_clientgl_struct_h->h_casus);
	}
	if ( !strlen(p_iv_clientgl_struct_h->h_toleracc) )
	{
		l_i_iv_clientgl_struct_i.i_toleracc = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_toleracc, p_iv_clientgl_struct_h->h_toleracc);
	}
        /* Bageshri -- HDFC Log 97 */
	if ( !strlen(p_iv_clientgl_struct_h->h_recacc) )
	{
		l_i_iv_clientgl_struct_i.i_recacc = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_recacc, p_iv_clientgl_struct_h->h_recacc);
	}
    /* KB_5878 MCS charuta */
	if ( !strlen(p_iv_clientgl_struct_h->h_mcsclh) )
	{
		l_i_iv_clientgl_struct_i.i_mcsclh = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_mcsclh, p_iv_clientgl_struct_h->h_mcsclh);
	}

	if ( !strlen(p_iv_clientgl_struct_h->h_mcssetac) )
	{
		l_i_iv_clientgl_struct_i.i_mcssetac = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_mcssetac, p_iv_clientgl_struct_h->h_mcssetac);
	}

 /* TAXACCOUNT added by chitrlekha for tax deduction KB_9306 */
	if ( !strlen(p_iv_clientgl_struct_h->h_taxacc) )
	{
		l_i_iv_clientgl_struct_i.i_taxacc = -1;
	}
	else
	{
		strcpy(l_ivclientgl_struct.h_taxacc, p_iv_clientgl_struct_h->h_taxacc);
	}

        /***************************/


	EXEC SQL INSERT INTO IV_CLIENTGL
		 VALUES (:l_ivclientgl_struct INDICATOR :l_i_iv_clientgl_struct_i);

	if ( sqlca.sqlcode < 0 )
	{
		char chr_l_buffer[KEY_LENGTH];

		memset(chr_l_buffer, APL_NULL_CHAR, KEY_LENGTH);

		ltoa_r(sqlca.sqlcode, chr_l_buffer, KEY_LENGTH - 1);

		*int_p_retstat = IV_CRITCAL_ERROR_IND;

		CO_InsertErr(l_debug_info_ptr, DB_ERR_NO, chr_l_buffer, 
			       APL_NULL_STRING, APL_NULL_STRING, 
			       __LINE__, __FILE__);

		APL_GOBACK_FAIL
	}

	*int_p_retstat = IV_SUCCESS;

	APL_GOBACK_SUCCESS

	RETURN_SUCCESS:

		APL_IF_DEBUG
		{
			CO_ProcMonitor(APL_OUT_FILE, "Exiting successfully out of \
IV_Mod_IVCLIENTGLNew().\n", (DEBUG_INFO_STRUCT_H **)NULL, (INTL_ENV_DATA_STRUCT_H *)NULL);
		}

		return APL_SUCCESS;

	RETURN_FAILURE:

		APL_IF_DEBUG
		{
			CO_ProcMonitor(APL_OUT_FILE, "Exiting unsuccessfully out of\
IV_Mod_IVCLIENTGLNew().\n", (DEBUG_INFO_STRUCT_H **)NULL, (INTL_ENV_DATA_STRUCT_H *)NULL);
		}

		return APL_FAILURE;
}
/******************************************************/




